wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250310_085906-eba6p4oj
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run gentle-cosmos-4
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/eba6p4oj
results are saved in:  ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
============================================================Run Summary============================================================
Dataset:
 dataset:Cifar10 | num_classes:10 | partition:noniid-label-distribution | beta:0.3
Server Info:
 strategy:FedNH | num_clients:100 | num_rounds: 200 | participate_ratio:0.1 | drop_ratio:0.0
Clients Info:
 model:tumorModel_cifar10_data | num_epochs:5 | batch_size:64 | optimizer:SGD | inint lr:0.01 | lr scheduler:diminishing | momentum: 0.9 | weight decay: 1e-05
 tumorModel_cifar10_data: size:3.732 MB | num params: 0.933 M
FedUHServer: the following layers will not be updated: ['prototype']
Strategy Related Hyper-parameters:
 server side
  FedNH_smoothing _ 0.9
  FedNH_server_adv_prototype_agg _ False
 client side
  FedNH_return_embedding _ False
  FedNH_head_init _ orthogonal
  FedNH_client_adv_prototype_agg _ False
  FedNH_fix_scaling _ False
Round:1 - Active clients:[80 84 33 81 93 17 36 82 69 65]:
 Training time:26.065 seconds
 server global model correct 1005
 Testing time:46.554 seconds
 avg_test_acc: {'uniform': 0.10050000250339508, 'validclass': 0.10050000250339508, 'labeldist': 0.10050000250339508}
 pfl_avg_test_acc: {'uniform': 0.12918999940156936, 'validclass': 0.2278792068362236, 'labeldist': 0.5679984152317047}
Round:2 - Active clients:[83 30 56 24 16 23  2 27 28 13]:
 Training time:21.292 seconds
 server global model correct 2035
 Testing time:46.589 seconds
 avg_test_acc: {'uniform': 0.20350000262260437, 'validclass': 0.20350000262260437, 'labeldist': 0.20350000262260437}
 pfl_avg_test_acc: {'uniform': 0.15357999950647355, 'validclass': 0.23184623047709466, 'labeldist': 0.5833997935056686}
 Best test accuracy:0.204. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:3 - Active clients:[93 67  6 64 96 83 98 42 25 15]:
 Training time:20.068 seconds
 server global model correct 1672
 Testing time:46.646 seconds
 avg_test_acc: {'uniform': 0.1671999990940094, 'validclass': 0.1671999990940094, 'labeldist': 0.1671999990940094}
 pfl_avg_test_acc: {'uniform': 0.1722500018775463, 'validclass': 0.3372467517852783, 'labeldist': 0.6215823233127594}
Round:4 - Active clients:[20 10 96 16 63 24 53 97 41 47]:
 Training time:23.153 seconds
 server global model correct 2686
 Testing time:47.426 seconds
 avg_test_acc: {'uniform': 0.2685999870300293, 'validclass': 0.2685999870300293, 'labeldist': 0.2686000168323517}
 pfl_avg_test_acc: {'uniform': 0.17456999868154527, 'validclass': 0.278431349247694, 'labeldist': 0.650171548128128}
 Best test accuracy:0.269. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:5 - Active clients:[66 32 46 28 74 23 10 20 17 35]:
 Training time:22.596 seconds
 server global model correct 2736
 Testing time:46.597 seconds
 avg_test_acc: {'uniform': 0.2736000120639801, 'validclass': 0.2736000120639801, 'labeldist': 0.2736000120639801}
 pfl_avg_test_acc: {'uniform': 0.19748999625444413, 'validclass': 0.3059202715754509, 'labeldist': 0.6548289895057678}
 Best test accuracy:0.274. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:6 - Active clients:[17 34  0 45 60 86 20 47 44 81]:
 Training time:24.585 seconds
 server global model correct 2696
 Testing time:46.395 seconds
 avg_test_acc: {'uniform': 0.2696000039577484, 'validclass': 0.2696000039577484, 'labeldist': 0.2696000039577484}
 pfl_avg_test_acc: {'uniform': 0.22485000193119048, 'validclass': 0.32041686326265334, 'labeldist': 0.7201543629169465}
Round:7 - Active clients:[37 26 78 91 49 15 93 71 86 22]:
 Training time:22.442 seconds
 server global model correct 2911
 Testing time:46.911 seconds
 avg_test_acc: {'uniform': 0.29109999537467957, 'validclass': 0.29109999537467957, 'labeldist': 0.29110002517700195}
 pfl_avg_test_acc: {'uniform': 0.24921999871730804, 'validclass': 0.35613944083452226, 'labeldist': 0.6285175621509552}
 Best test accuracy:0.291. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:8 - Active clients:[17 23  1 44 55 99 86 29 62 33]:
 Training time:21.170 seconds
 server global model correct 3423
 Testing time:46.710 seconds
 avg_test_acc: {'uniform': 0.3422999978065491, 'validclass': 0.3422999978065491, 'labeldist': 0.3422999978065491}
 pfl_avg_test_acc: {'uniform': 0.2641500040888786, 'validclass': 0.32991580069065096, 'labeldist': 0.6354720175266266}
 Best test accuracy:0.342. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:9 - Active clients:[75 42 46 68  3 39 23 20 70 73]:
 Training time:23.022 seconds
 server global model correct 1430
 Testing time:46.342 seconds
 avg_test_acc: {'uniform': 0.14300000667572021, 'validclass': 0.14300000667572021, 'labeldist': 0.14299999177455902}
 pfl_avg_test_acc: {'uniform': 0.21400999873876572, 'validclass': 0.28184432461857795, 'labeldist': 0.7396110594272614}
Round:10 - Active clients:[19 14 43 37 66  3 79 41 38 68]:
 Training time:22.352 seconds
 server global model correct 3926
 Testing time:46.281 seconds
 avg_test_acc: {'uniform': 0.39259999990463257, 'validclass': 0.39259999990463257, 'labeldist': 0.39259999990463257}
 pfl_avg_test_acc: {'uniform': 0.22316999658942221, 'validclass': 0.3177373468875885, 'labeldist': 0.6814380168914795}
 Best test accuracy:0.393. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:11 - Active clients:[46 49 22 58 41 98 62 29 30 51]:
 Training time:19.755 seconds
 server global model correct 3806
 Testing time:47.001 seconds
 avg_test_acc: {'uniform': 0.3806000053882599, 'validclass': 0.3806000053882599, 'labeldist': 0.3806000351905823}
 pfl_avg_test_acc: {'uniform': 0.2478199988603592, 'validclass': 0.32751202285289766, 'labeldist': 0.7093631744384765}
Round:12 - Active clients:[17 41 92 14 68 31 89 15 21 60]:
 Training time:26.502 seconds
 server global model correct 3257
 Testing time:46.281 seconds
 avg_test_acc: {'uniform': 0.3257000148296356, 'validclass': 0.3257000148296356, 'labeldist': 0.3257000148296356}
 pfl_avg_test_acc: {'uniform': 0.2550799988210201, 'validclass': 0.3708029747009277, 'labeldist': 0.7163239121437073}
Round:13 - Active clients:[37 62 83 14 43  9 44 31 69 57]:
 Training time:21.804 seconds
 server global model correct 4014
 Testing time:46.849 seconds
 avg_test_acc: {'uniform': 0.40139999985694885, 'validclass': 0.40139999985694885, 'labeldist': 0.40139999985694885}
 pfl_avg_test_acc: {'uniform': 0.2563999958336353, 'validclass': 0.3437578618526459, 'labeldist': 0.6410120189189911}
 Best test accuracy:0.401. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:14 - Active clients:[24 39 35 44 55 70 82 40 91 65]:
 Training time:24.512 seconds
 server global model correct 4315
 Testing time:46.874 seconds
 avg_test_acc: {'uniform': 0.43149998784065247, 'validclass': 0.43149998784065247, 'labeldist': 0.43149998784065247}
 pfl_avg_test_acc: {'uniform': 0.30228999704122544, 'validclass': 0.37148610651493075, 'labeldist': 0.6643910646438599}
 Best test accuracy:0.431. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:15 - Active clients:[84 36 57 51 46 78 93 14 11 59]:
 Training time:24.591 seconds
 server global model correct 3986
 Testing time:46.526 seconds
 avg_test_acc: {'uniform': 0.3986000120639801, 'validclass': 0.3986000120639801, 'labeldist': 0.3985999822616577}
 pfl_avg_test_acc: {'uniform': 0.25737000107765196, 'validclass': 0.39669095277786254, 'labeldist': 0.732274180650711}
Round:16 - Active clients:[ 7 25 71 42 47 29 63 88 50  9]:
 Training time:21.300 seconds
 server global model correct 4482
 Testing time:47.217 seconds
 avg_test_acc: {'uniform': 0.448199987411499, 'validclass': 0.448199987411499, 'labeldist': 0.4482000172138214}
 pfl_avg_test_acc: {'uniform': 0.23930999934673308, 'validclass': 0.4283031731843948, 'labeldist': 0.7280021965503692}
 Best test accuracy:0.448. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:17 - Active clients:[71 28  9  4 73 34 94 92 47 37]:
 Training time:21.195 seconds
 server global model correct 4724
 Testing time:46.535 seconds
 avg_test_acc: {'uniform': 0.4724000096321106, 'validclass': 0.4724000096321106, 'labeldist': 0.4723999798297882}
 pfl_avg_test_acc: {'uniform': 0.2640600010752678, 'validclass': 0.3576392486691475, 'labeldist': 0.6955872416496277}
 Best test accuracy:0.472. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:18 - Active clients:[53 47 43 54 33 48  0 12 44 91]:
 Training time:21.096 seconds
 server global model correct 4482
 Testing time:46.800 seconds
 avg_test_acc: {'uniform': 0.448199987411499, 'validclass': 0.448199987411499, 'labeldist': 0.4482000172138214}
 pfl_avg_test_acc: {'uniform': 0.2873699992895126, 'validclass': 0.4647597253322601, 'labeldist': 0.732082998752594}
Round:19 - Active clients:[85 72 16 18  2 38 90 30 83 61]:
 Training time:20.766 seconds
 server global model correct 4706
 Testing time:46.453 seconds
 avg_test_acc: {'uniform': 0.4706000089645386, 'validclass': 0.4706000089645386, 'labeldist': 0.4706000089645386}
 pfl_avg_test_acc: {'uniform': 0.2822799995541573, 'validclass': 0.44134793877601625, 'labeldist': 0.7571984946727752}
Round:20 - Active clients:[70 74  2 44 56 48 12 36  0 49]:
 Training time:20.578 seconds
 server global model correct 4680
 Testing time:46.429 seconds
 avg_test_acc: {'uniform': 0.46799999475479126, 'validclass': 0.46799999475479126, 'labeldist': 0.46799999475479126}
 pfl_avg_test_acc: {'uniform': 0.2789500027894974, 'validclass': 0.4677665442228317, 'labeldist': 0.7630569398403168}
Round:21 - Active clients:[23 81 85 34 62 46 42 31 93 11]:
 Training time:26.899 seconds
 server global model correct 5104
 Testing time:46.481 seconds
 avg_test_acc: {'uniform': 0.5103999972343445, 'validclass': 0.5103999972343445, 'labeldist': 0.5103999972343445}
 pfl_avg_test_acc: {'uniform': 0.2979100003838539, 'validclass': 0.4424172222614288, 'labeldist': 0.7519605457782745}
 Best test accuracy:0.510. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:22 - Active clients:[ 2 49 82 31 37 12 87 42 99 85]:
 Training time:23.121 seconds
 server global model correct 4268
 Testing time:46.543 seconds
 avg_test_acc: {'uniform': 0.426800012588501, 'validclass': 0.426800012588501, 'labeldist': 0.426800012588501}
 pfl_avg_test_acc: {'uniform': 0.31628000140190127, 'validclass': 0.4393609970808029, 'labeldist': 0.728694635629654}
Round:23 - Active clients:[26 80 82 68 77 37  3 55 20 17]:
 Training time:27.541 seconds
 server global model correct 3866
 Testing time:46.429 seconds
 avg_test_acc: {'uniform': 0.38659998774528503, 'validclass': 0.38659998774528503, 'labeldist': 0.38659998774528503}
 pfl_avg_test_acc: {'uniform': 0.24980999901890755, 'validclass': 0.42640107274055483, 'labeldist': 0.7762540876865387}
Round:24 - Active clients:[26 31 37 86 76 14 88 48 71 67]:
 Training time:32.194 seconds
 server global model correct 4672
 Testing time:46.571 seconds
 avg_test_acc: {'uniform': 0.46720001101493835, 'validclass': 0.46720001101493835, 'labeldist': 0.46720004081726074}
 pfl_avg_test_acc: {'uniform': 0.27082000076770785, 'validclass': 0.5158845216035843, 'labeldist': 0.7680278301239014}
Round:25 - Active clients:[41 29 33 65 74  6 57 89 87 98]:
 Training time:22.345 seconds
 server global model correct 5079
 Testing time:46.404 seconds
 avg_test_acc: {'uniform': 0.5078999996185303, 'validclass': 0.5078999996185303, 'labeldist': 0.5078999996185303}
 pfl_avg_test_acc: {'uniform': 0.31179999709129336, 'validclass': 0.40259960293769836, 'labeldist': 0.7333772540092468}
Round:26 - Active clients:[ 8 69 84 41 25  5 63 95 33 70]:
 Training time:19.858 seconds
 server global model correct 3536
 Testing time:46.612 seconds
 avg_test_acc: {'uniform': 0.35359999537467957, 'validclass': 0.35359999537467957, 'labeldist': 0.3535999655723572}
 pfl_avg_test_acc: {'uniform': 0.30804999768733976, 'validclass': 0.5094779342412948, 'labeldist': 0.738613623380661}
Round:27 - Active clients:[89 68 43 50 40 95 27 85 22 44]:
 Training time:24.034 seconds
 server global model correct 4750
 Testing time:46.756 seconds
 avg_test_acc: {'uniform': 0.4749999940395355, 'validclass': 0.4749999940395355, 'labeldist': 0.4749999940395355}
 pfl_avg_test_acc: {'uniform': 0.30923999920487405, 'validclass': 0.4068641662597656, 'labeldist': 0.7464263737201691}
Round:28 - Active clients:[67 14  0 86 13 18 30 36 52 95]:
 Training time:24.464 seconds
 server global model correct 4687
 Testing time:46.778 seconds
 avg_test_acc: {'uniform': 0.46869999170303345, 'validclass': 0.46869999170303345, 'labeldist': 0.46870002150535583}
 pfl_avg_test_acc: {'uniform': 0.29657999724149703, 'validclass': 0.5454558312892914, 'labeldist': 0.799076247215271}
Round:29 - Active clients:[73  8 10  7 19 71 92 25 38 12]:
 Training time:17.912 seconds
 server global model correct 4828
 Testing time:46.397 seconds
 avg_test_acc: {'uniform': 0.4828000068664551, 'validclass': 0.4828000068664551, 'labeldist': 0.4828000068664551}
 pfl_avg_test_acc: {'uniform': 0.2733400002121925, 'validclass': 0.4453446388244629, 'labeldist': 0.7435290038585662}
Round:30 - Active clients:[20 91 34 52  8 74 21 88 80 89]:
 Training time:27.637 seconds
 server global model correct 5057
 Testing time:46.488 seconds
 avg_test_acc: {'uniform': 0.5056999921798706, 'validclass': 0.5056999921798706, 'labeldist': 0.5056999921798706}
 pfl_avg_test_acc: {'uniform': 0.3237800046801567, 'validclass': 0.4881738930940628, 'labeldist': 0.7542898654937744}
Round:31 - Active clients:[17 33 76  3 56  0 37  8 60 67]:
 Training time:22.873 seconds
 server global model correct 4215
 Testing time:46.436 seconds
 avg_test_acc: {'uniform': 0.42149999737739563, 'validclass': 0.42149999737739563, 'labeldist': 0.42149999737739563}
 pfl_avg_test_acc: {'uniform': 0.28952999860048295, 'validclass': 0.5391847640275955, 'labeldist': 0.7930989801883698}
Round:32 - Active clients:[22 39 85 97 55 33 80 13 27 96]:
 Training time:22.961 seconds
 server global model correct 5618
 Testing time:46.462 seconds
 avg_test_acc: {'uniform': 0.5618000030517578, 'validclass': 0.5618000030517578, 'labeldist': 0.5618000030517578}
 pfl_avg_test_acc: {'uniform': 0.3151700019836426, 'validclass': 0.46028055548667907, 'labeldist': 0.7588320791721344}
 Best test accuracy:0.562. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:33 - Active clients:[56 90 95 82 60 71  6 81  2 70]:
 Training time:23.400 seconds
 server global model correct 5192
 Testing time:47.060 seconds
 avg_test_acc: {'uniform': 0.5192000269889832, 'validclass': 0.5192000269889832, 'labeldist': 0.5192000269889832}
 pfl_avg_test_acc: {'uniform': 0.33753000348806383, 'validclass': 0.4731978178024292, 'labeldist': 0.7814357221126557}
Round:34 - Active clients:[14 74 15  4 32 59 91 10 50 53]:
 Training time:19.085 seconds
 server global model correct 5488
 Testing time:46.694 seconds
 avg_test_acc: {'uniform': 0.548799991607666, 'validclass': 0.548799991607666, 'labeldist': 0.548799991607666}
 pfl_avg_test_acc: {'uniform': 0.35562999844551085, 'validclass': 0.47732341289520264, 'labeldist': 0.7501783013343811}
Round:35 - Active clients:[40 71 98 27 70 31 10 24 51 35]:
 Training time:25.887 seconds
 server global model correct 5393
 Testing time:46.486 seconds
 avg_test_acc: {'uniform': 0.5393000245094299, 'validclass': 0.5393000245094299, 'labeldist': 0.5393000245094299}
 pfl_avg_test_acc: {'uniform': 0.3463100016117096, 'validclass': 0.4641205549240112, 'labeldist': 0.7329193472862243}
Round:36 - Active clients:[59 42  2 27 28 75 58 68 52 74]:
 Training time:22.419 seconds
 server global model correct 4202
 Testing time:46.435 seconds
 avg_test_acc: {'uniform': 0.420199990272522, 'validclass': 0.420199990272522, 'labeldist': 0.420199990272522}
 pfl_avg_test_acc: {'uniform': 0.28559999689459803, 'validclass': 0.40464320927858355, 'labeldist': 0.8122137129306793}
Round:37 - Active clients:[61 49 86 78  5 91 81 82 89 18]:
 Training time:21.620 seconds
 server global model correct 5761
 Testing time:46.653 seconds
 avg_test_acc: {'uniform': 0.5760999917984009, 'validclass': 0.5760999917984009, 'labeldist': 0.5761000514030457}
 pfl_avg_test_acc: {'uniform': 0.34176999926567075, 'validclass': 0.506689441204071, 'labeldist': 0.7876675069332123}
 Best test accuracy:0.576. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:38 - Active clients:[40 73 49 45 64 16 69 17 72 66]:
 Training time:15.026 seconds
 server global model correct 5572
 Testing time:47.036 seconds
 avg_test_acc: {'uniform': 0.557200014591217, 'validclass': 0.557200014591217, 'labeldist': 0.557200014591217}
 pfl_avg_test_acc: {'uniform': 0.3199200019240379, 'validclass': 0.42863074839115145, 'labeldist': 0.7252736568450928}
Round:39 - Active clients:[22 53 84 57 87 58 29 21 85 79]:
 Training time:19.317 seconds
 server global model correct 6231
 Testing time:46.477 seconds
 avg_test_acc: {'uniform': 0.6230999827384949, 'validclass': 0.6230999827384949, 'labeldist': 0.6231000423431396}
 pfl_avg_test_acc: {'uniform': 0.3602200001478195, 'validclass': 0.48179079294204713, 'labeldist': 0.7544977366924286}
 Best test accuracy:0.623. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:40 - Active clients:[79 75 63 15 38 11 40 45 39 62]:
 Training time:22.332 seconds
 server global model correct 5265
 Testing time:46.403 seconds
 avg_test_acc: {'uniform': 0.5264999866485596, 'validclass': 0.5264999866485596, 'labeldist': 0.5264999866485596}
 pfl_avg_test_acc: {'uniform': 0.2986399978399277, 'validclass': 0.4306433334946632, 'labeldist': 0.7730044484138489}
Round:41 - Active clients:[42 94 37  6 79 32 24  0 33 93]:
 Training time:20.267 seconds
 server global model correct 5916
 Testing time:46.367 seconds
 avg_test_acc: {'uniform': 0.5916000008583069, 'validclass': 0.5916000008583069, 'labeldist': 0.5916000008583069}
 pfl_avg_test_acc: {'uniform': 0.3598099946975708, 'validclass': 0.52038654088974, 'labeldist': 0.7619727969169616}
Round:42 - Active clients:[83 53 70 45 44 39 22 80 10  0]:
 Training time:18.670 seconds
 server global model correct 5222
 Testing time:46.662 seconds
 avg_test_acc: {'uniform': 0.5221999883651733, 'validclass': 0.5221999883651733, 'labeldist': 0.5221999883651733}
 pfl_avg_test_acc: {'uniform': 0.3202700033783913, 'validclass': 0.48166805803775786, 'labeldist': 0.7543013274669648}
Round:43 - Active clients:[20  2 15 22 57 91 69 55 11 79]:
 Training time:25.526 seconds
 server global model correct 5539
 Testing time:46.335 seconds
 avg_test_acc: {'uniform': 0.5539000034332275, 'validclass': 0.5539000034332275, 'labeldist': 0.5539000034332275}
 pfl_avg_test_acc: {'uniform': 0.3387599945068359, 'validclass': 0.45453141927719115, 'labeldist': 0.7628478646278382}
Round:44 - Active clients:[42 54 27 93 39 65  7 26 24 60]:
 Training time:25.814 seconds
 server global model correct 4894
 Testing time:46.709 seconds
 avg_test_acc: {'uniform': 0.4893999993801117, 'validclass': 0.4893999993801117, 'labeldist': 0.4893999993801117}
 pfl_avg_test_acc: {'uniform': 0.3476099997758865, 'validclass': 0.5482197195291519, 'labeldist': 0.7596578299999237}
Round:45 - Active clients:[ 0  1 62 76 37 99 78 38  2 84]:
 Training time:22.374 seconds
 server global model correct 6051
 Testing time:46.461 seconds
 avg_test_acc: {'uniform': 0.6050999760627747, 'validclass': 0.6050999760627747, 'labeldist': 0.6050999760627747}
 pfl_avg_test_acc: {'uniform': 0.35684999972581866, 'validclass': 0.4760755985975266, 'labeldist': 0.7430455625057221}
Round:46 - Active clients:[71 33 37 10 44 34 24 98 73 95]:
 Training time:24.220 seconds
 server global model correct 6137
 Testing time:46.375 seconds
 avg_test_acc: {'uniform': 0.6136999726295471, 'validclass': 0.6136999726295471, 'labeldist': 0.6137000322341919}
 pfl_avg_test_acc: {'uniform': 0.3684000000357628, 'validclass': 0.4860531687736511, 'labeldist': 0.7458941042423248}
Round:47 - Active clients:[17 90 94 86 63  5 38 14 40 47]:
 Training time:22.563 seconds
 server global model correct 5458
 Testing time:46.404 seconds
 avg_test_acc: {'uniform': 0.545799970626831, 'validclass': 0.545799970626831, 'labeldist': 0.5458000302314758}
 pfl_avg_test_acc: {'uniform': 0.3451000049710274, 'validclass': 0.5292852371931076, 'labeldist': 0.8022590458393097}
Round:48 - Active clients:[93  5 71  9 11 79 69  8 59 63]:
 Training time:22.982 seconds
 server global model correct 5404
 Testing time:46.448 seconds
 avg_test_acc: {'uniform': 0.5404000282287598, 'validclass': 0.5404000282287598, 'labeldist': 0.5404000282287598}
 pfl_avg_test_acc: {'uniform': 0.34016999900341033, 'validclass': 0.5771904826164246, 'labeldist': 0.7820223033428192}
Round:49 - Active clients:[76 25 28 75 81 47 41 22 29  1]:
 Training time:20.796 seconds
 server global model correct 6209
 Testing time:46.665 seconds
 avg_test_acc: {'uniform': 0.6208999752998352, 'validclass': 0.6208999752998352, 'labeldist': 0.6209000945091248}
 pfl_avg_test_acc: {'uniform': 0.3232499986886978, 'validclass': 0.48707075715065, 'labeldist': 0.8185072004795074}
Round:50 - Active clients:[80 79 25 15 39 40 53 17 57 50]:
 Training time:19.520 seconds
 server global model correct 5613
 Testing time:46.496 seconds
 avg_test_acc: {'uniform': 0.5612999796867371, 'validclass': 0.5612999796867371, 'labeldist': 0.5613000392913818}
 pfl_avg_test_acc: {'uniform': 0.3832900047302246, 'validclass': 0.5746230185031891, 'labeldist': 0.788539856672287}
Round:51 - Active clients:[71 43 11 83 78 19 80  4 79 75]:
 Training time:21.753 seconds
 server global model correct 6254
 Testing time:46.564 seconds
 avg_test_acc: {'uniform': 0.6254000067710876, 'validclass': 0.6254000067710876, 'labeldist': 0.6253999471664429}
 pfl_avg_test_acc: {'uniform': 0.347850002348423, 'validclass': 0.5012330561876297, 'labeldist': 0.7915209949016571}
 Best test accuracy:0.625. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:52 - Active clients:[82  8 44 19  2 73 37 89 67 18]:
 Training time:21.900 seconds
 server global model correct 5035
 Testing time:47.440 seconds
 avg_test_acc: {'uniform': 0.5034999847412109, 'validclass': 0.5034999847412109, 'labeldist': 0.5035000443458557}
 pfl_avg_test_acc: {'uniform': 0.3566400036215782, 'validclass': 0.5939450442790986, 'labeldist': 0.825380140542984}
Round:53 - Active clients:[19 78 64  3 71 32 68 42 55 97]:
 Training time:23.337 seconds
 server global model correct 5093
 Testing time:46.951 seconds
 avg_test_acc: {'uniform': 0.5092999935150146, 'validclass': 0.5092999935150146, 'labeldist': 0.5092999935150146}
 pfl_avg_test_acc: {'uniform': 0.34055000320076945, 'validclass': 0.49754297733306885, 'labeldist': 0.7949246406555176}
Round:54 - Active clients:[36 70 48 94 81 46 38 29 34 22]:
 Training time:19.802 seconds
 server global model correct 6196
 Testing time:46.754 seconds
 avg_test_acc: {'uniform': 0.6195999979972839, 'validclass': 0.6195999979972839, 'labeldist': 0.6196000576019287}
 pfl_avg_test_acc: {'uniform': 0.36474000066518786, 'validclass': 0.4851563900709152, 'labeldist': 0.7992291629314423}
Round:55 - Active clients:[28 92 98 95 84 34 38 76 17 78]:
 Training time:23.271 seconds
 server global model correct 5608
 Testing time:46.883 seconds
 avg_test_acc: {'uniform': 0.5608000159263611, 'validclass': 0.5608000159263611, 'labeldist': 0.5608000755310059}
 pfl_avg_test_acc: {'uniform': 0.352319997549057, 'validclass': 0.5024238079786301, 'labeldist': 0.7852887451648712}
Round:56 - Active clients:[92 79 23 68 52 38 73  9 59 27]:
 Training time:22.466 seconds
 server global model correct 6270
 Testing time:46.515 seconds
 avg_test_acc: {'uniform': 0.6269999742507935, 'validclass': 0.6269999742507935, 'labeldist': 0.6270000338554382}
 pfl_avg_test_acc: {'uniform': 0.37875000238418577, 'validclass': 0.44862195253372195, 'labeldist': 0.7873795807361603}
 Best test accuracy:0.627. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:57 - Active clients:[52 17 41  3  8 98 59 20 67  7]:
 Training time:25.744 seconds
 server global model correct 5528
 Testing time:46.584 seconds
 avg_test_acc: {'uniform': 0.5527999997138977, 'validclass': 0.5527999997138977, 'labeldist': 0.5527999997138977}
 pfl_avg_test_acc: {'uniform': 0.3518400028347969, 'validclass': 0.5163235306739807, 'labeldist': 0.800723272562027}
Round:58 - Active clients:[43 58  8 31 70 45 69 95 50  4]:
 Training time:18.335 seconds
 server global model correct 6657
 Testing time:46.505 seconds
 avg_test_acc: {'uniform': 0.6657000184059143, 'validclass': 0.6657000184059143, 'labeldist': 0.6656999588012695}
 pfl_avg_test_acc: {'uniform': 0.3675700008869171, 'validclass': 0.4753370314836502, 'labeldist': 0.7795528948307038}
 Best test accuracy:0.666. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:59 - Active clients:[38 46 24 87 30 85 16 96 18 99]:
 Training time:18.774 seconds
 server global model correct 5710
 Testing time:46.515 seconds
 avg_test_acc: {'uniform': 0.5709999799728394, 'validclass': 0.5709999799728394, 'labeldist': 0.5709999799728394}
 pfl_avg_test_acc: {'uniform': 0.34828000217676164, 'validclass': 0.5288233324885369, 'labeldist': 0.7913057804107666}
Round:60 - Active clients:[88  4 79 14 55  3 19 28 94 25]:
 Training time:21.297 seconds
 server global model correct 6205
 Testing time:46.515 seconds
 avg_test_acc: {'uniform': 0.6205000281333923, 'validclass': 0.6205000281333923, 'labeldist': 0.6205000281333923}
 pfl_avg_test_acc: {'uniform': 0.3616600036621094, 'validclass': 0.5364138454198837, 'labeldist': 0.7830601692199707}
Round:61 - Active clients:[83  1 55  9 31 28 96 29 86 63]:
 Training time:21.390 seconds
 server global model correct 6426
 Testing time:46.433 seconds
 avg_test_acc: {'uniform': 0.6425999999046326, 'validclass': 0.6425999999046326, 'labeldist': 0.6426000595092773}
 pfl_avg_test_acc: {'uniform': 0.3373100012540817, 'validclass': 0.4885780155658722, 'labeldist': 0.808856862783432}
Round:62 - Active clients:[76 48 62 80 29 99 60 89 39 69]:
 Training time:22.114 seconds
 server global model correct 6159
 Testing time:46.429 seconds
 avg_test_acc: {'uniform': 0.6158999800682068, 'validclass': 0.6158999800682068, 'labeldist': 0.6158999800682068}
 pfl_avg_test_acc: {'uniform': 0.37798999100923536, 'validclass': 0.6058464288711548, 'labeldist': 0.7941403031349182}
Round:63 - Active clients:[64 59 63  2 80 20 18 48 72 51]:
 Training time:28.212 seconds
 server global model correct 4708
 Testing time:46.892 seconds
 avg_test_acc: {'uniform': 0.4708000123500824, 'validclass': 0.4708000123500824, 'labeldist': 0.4708000123500824}
 pfl_avg_test_acc: {'uniform': 0.31861000061035155, 'validclass': 0.6593061923980713, 'labeldist': 0.8701095402240753}
Round:64 - Active clients:[17 22 60 92 23 19 71 94 40 49]:
 Training time:19.455 seconds
 server global model correct 5947
 Testing time:46.466 seconds
 avg_test_acc: {'uniform': 0.5946999788284302, 'validclass': 0.5946999788284302, 'labeldist': 0.594700038433075}
 pfl_avg_test_acc: {'uniform': 0.3879499971866608, 'validclass': 0.4899041295051575, 'labeldist': 0.7493239283561707}
Round:65 - Active clients:[37 81 39 61 76 90 27 86 28 69]:
 Training time:22.381 seconds
 server global model correct 6659
 Testing time:47.079 seconds
 avg_test_acc: {'uniform': 0.6658999919891357, 'validclass': 0.6658999919891357, 'labeldist': 0.6659000515937805}
 pfl_avg_test_acc: {'uniform': 0.3842199966311455, 'validclass': 0.49881245493888854, 'labeldist': 0.8007399559020996}
 Best test accuracy:0.666. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:66 - Active clients:[ 8 93  4  5 52 41  0 73 88 68]:
 Training time:22.198 seconds
 server global model correct 6168
 Testing time:46.549 seconds
 avg_test_acc: {'uniform': 0.6168000102043152, 'validclass': 0.6168000102043152, 'labeldist': 0.61680006980896}
 pfl_avg_test_acc: {'uniform': 0.3280099995434284, 'validclass': 0.5211481779813767, 'labeldist': 0.819894689321518}
Round:67 - Active clients:[17 24 64 93 97 29  3 70 82 11]:
 Training time:22.633 seconds
 server global model correct 6352
 Testing time:46.654 seconds
 avg_test_acc: {'uniform': 0.635200023651123, 'validclass': 0.635200023651123, 'labeldist': 0.635200023651123}
 pfl_avg_test_acc: {'uniform': 0.36767000108957293, 'validclass': 0.511318251490593, 'labeldist': 0.788456404209137}
Round:68 - Active clients:[29 30 16  5 38 71 76 94 99 95]:
 Training time:20.074 seconds
 server global model correct 6440
 Testing time:46.859 seconds
 avg_test_acc: {'uniform': 0.6439999938011169, 'validclass': 0.6439999938011169, 'labeldist': 0.6439999938011169}
 pfl_avg_test_acc: {'uniform': 0.3968899995088577, 'validclass': 0.5434890151023865, 'labeldist': 0.7897410809993743}
Round:69 - Active clients:[72 31 13 83 33  8 26 89 64 97]:
 Training time:23.925 seconds
 server global model correct 6439
 Testing time:47.968 seconds
 avg_test_acc: {'uniform': 0.6438999772071838, 'validclass': 0.6438999772071838, 'labeldist': 0.6439000368118286}
 pfl_avg_test_acc: {'uniform': 0.4084700018167496, 'validclass': 0.5285358756780625, 'labeldist': 0.7724112868309021}
Round:70 - Active clients:[81 43 88 32 50 71 73 55 42  2]:
 Training time:23.168 seconds
 server global model correct 6645
 Testing time:47.703 seconds
 avg_test_acc: {'uniform': 0.6644999980926514, 'validclass': 0.6644999980926514, 'labeldist': 0.6644999980926514}
 pfl_avg_test_acc: {'uniform': 0.36595000326633453, 'validclass': 0.5372564345598221, 'labeldist': 0.8166057288646698}
Round:71 - Active clients:[41 84 98 42 75 25 60 19 52 29]:
 Training time:21.457 seconds
 server global model correct 6218
 Testing time:46.814 seconds
 avg_test_acc: {'uniform': 0.6218000054359436, 'validclass': 0.6218000054359436, 'labeldist': 0.6218000054359436}
 pfl_avg_test_acc: {'uniform': 0.3919200003147125, 'validclass': 0.5733967840671539, 'labeldist': 0.7835832476615906}
Round:72 - Active clients:[76 82 43 16 84 95 78 91 30 22]:
 Training time:22.495 seconds
 server global model correct 6683
 Testing time:46.551 seconds
 avg_test_acc: {'uniform': 0.6682999730110168, 'validclass': 0.6682999730110168, 'labeldist': 0.6683000326156616}
 pfl_avg_test_acc: {'uniform': 0.45121000707149506, 'validclass': 0.578925159573555, 'labeldist': 0.8086288452148438}
 Best test accuracy:0.668. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:73 - Active clients:[49 14 34 70 90 35 68 76 80  9]:
 Training time:26.394 seconds
 server global model correct 6207
 Testing time:47.169 seconds
 avg_test_acc: {'uniform': 0.6207000017166138, 'validclass': 0.6207000017166138, 'labeldist': 0.6207000017166138}
 pfl_avg_test_acc: {'uniform': 0.385410001128912, 'validclass': 0.5366290450096131, 'labeldist': 0.8302338898181916}
Round:74 - Active clients:[85 64 63 80  6 12 43 17  7  8]:
 Training time:20.561 seconds
 server global model correct 6068
 Testing time:46.598 seconds
 avg_test_acc: {'uniform': 0.6068000197410583, 'validclass': 0.6068000197410583, 'labeldist': 0.6067999601364136}
 pfl_avg_test_acc: {'uniform': 0.3362800031900406, 'validclass': 0.5889674663543701, 'labeldist': 0.8389212489128113}
Round:75 - Active clients:[36  7  6 45 56 54 22 37 53 68]:
 Training time:21.090 seconds
 server global model correct 5882
 Testing time:46.526 seconds
 avg_test_acc: {'uniform': 0.5881999731063843, 'validclass': 0.5881999731063843, 'labeldist': 0.5881999731063843}
 pfl_avg_test_acc: {'uniform': 0.3644499905407429, 'validclass': 0.5630456268787384, 'labeldist': 0.8454115390777588}
Round:76 - Active clients:[38 37 32 50 10 94 19 44 86 23]:
 Training time:19.090 seconds
 server global model correct 6825
 Testing time:46.795 seconds
 avg_test_acc: {'uniform': 0.6825000047683716, 'validclass': 0.6825000047683716, 'labeldist': 0.6825000643730164}
 pfl_avg_test_acc: {'uniform': 0.4327800005674362, 'validclass': 0.5425327003002167, 'labeldist': 0.7757569670677185}
 Best test accuracy:0.683. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:77 - Active clients:[ 5 93 41 96 16 42 81 91 50 58]:
 Training time:19.870 seconds
 server global model correct 5465
 Testing time:46.843 seconds
 avg_test_acc: {'uniform': 0.546500027179718, 'validclass': 0.546500027179718, 'labeldist': 0.546500027179718}
 pfl_avg_test_acc: {'uniform': 0.3909199953079224, 'validclass': 0.5758453160524368, 'labeldist': 0.8267583131790162}
Round:78 - Active clients:[ 9 46  7 63 15  2 74 31  5 36]:
 Training time:24.700 seconds
 server global model correct 6205
 Testing time:46.682 seconds
 avg_test_acc: {'uniform': 0.6205000281333923, 'validclass': 0.6205000281333923, 'labeldist': 0.6205000281333923}
 pfl_avg_test_acc: {'uniform': 0.3825600057840347, 'validclass': 0.5914402812719345, 'labeldist': 0.8359941363334655}
Round:79 - Active clients:[68 18 86 60 56 32 30 24 45 92]:
 Training time:25.212 seconds
 server global model correct 5104
 Testing time:46.692 seconds
 avg_test_acc: {'uniform': 0.5103999972343445, 'validclass': 0.5103999972343445, 'labeldist': 0.5103999972343445}
 pfl_avg_test_acc: {'uniform': 0.3051699995994568, 'validclass': 0.5947700053453445, 'labeldist': 0.8585297763347626}
Round:80 - Active clients:[37 65 95 53 66 30 73 85 45 36]:
 Training time:22.264 seconds
 server global model correct 6520
 Testing time:46.643 seconds
 avg_test_acc: {'uniform': 0.6520000100135803, 'validclass': 0.6520000100135803, 'labeldist': 0.6520000696182251}
 pfl_avg_test_acc: {'uniform': 0.4122099965810776, 'validclass': 0.57530317902565, 'labeldist': 0.8008439302444458}
Round:81 - Active clients:[73 89 41 78 51 21 30 69  8  5]:
 Training time:18.999 seconds
 server global model correct 6322
 Testing time:46.687 seconds
 avg_test_acc: {'uniform': 0.6322000026702881, 'validclass': 0.6322000026702881, 'labeldist': 0.6321999430656433}
 pfl_avg_test_acc: {'uniform': 0.41680999398231505, 'validclass': 0.594885402917862, 'labeldist': 0.8223399460315705}
Round:82 - Active clients:[72 33 58  2 55 84 54 75 28 40]:
 Training time:20.198 seconds
 server global model correct 6820
 Testing time:46.388 seconds
 avg_test_acc: {'uniform': 0.6819999814033508, 'validclass': 0.6819999814033508, 'labeldist': 0.6820000410079956}
 pfl_avg_test_acc: {'uniform': 0.3669800043106079, 'validclass': 0.5264880925416946, 'labeldist': 0.7950902879238129}
Round:83 - Active clients:[ 6 65 95 84 61 12 30 69 35  1]:
 Training time:21.791 seconds
 server global model correct 7224
 Testing time:46.720 seconds
 avg_test_acc: {'uniform': 0.7224000096321106, 'validclass': 0.7224000096321106, 'labeldist': 0.7224000096321106}
 pfl_avg_test_acc: {'uniform': 0.4509999990463257, 'validclass': 0.5453171551227569, 'labeldist': 0.7993247807025909}
 Best test accuracy:0.722. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:84 - Active clients:[94 55 80  1 90 11 32  8  6 82]:
 Training time:25.297 seconds
 server global model correct 6468
 Testing time:46.401 seconds
 avg_test_acc: {'uniform': 0.6467999815940857, 'validclass': 0.6467999815940857, 'labeldist': 0.6467999815940857}
 pfl_avg_test_acc: {'uniform': 0.4043300002813339, 'validclass': 0.575660240650177, 'labeldist': 0.8280510544776917}
Round:85 - Active clients:[81 25 40 87 41 23 10 89 50 54]:
 Training time:19.123 seconds
 server global model correct 6648
 Testing time:46.465 seconds
 avg_test_acc: {'uniform': 0.6647999882698059, 'validclass': 0.6647999882698059, 'labeldist': 0.6648000478744507}
 pfl_avg_test_acc: {'uniform': 0.4055700033903122, 'validclass': 0.5959161043167114, 'labeldist': 0.7957773566246032}
Round:86 - Active clients:[69 74 34 68 42  0 32 88  8  3]:
 Training time:22.673 seconds
 server global model correct 5817
 Testing time:46.712 seconds
 avg_test_acc: {'uniform': 0.5817000269889832, 'validclass': 0.5817000269889832, 'labeldist': 0.5817000269889832}
 pfl_avg_test_acc: {'uniform': 0.366159999370575, 'validclass': 0.5410201102495193, 'labeldist': 0.826177453994751}
Round:87 - Active clients:[16 81 85 32 39 25 26 29 65  7]:
 Training time:21.837 seconds
 server global model correct 7060
 Testing time:46.368 seconds
 avg_test_acc: {'uniform': 0.7059999704360962, 'validclass': 0.7059999704360962, 'labeldist': 0.7059999704360962}
 pfl_avg_test_acc: {'uniform': 0.393230003118515, 'validclass': 0.581431582570076, 'labeldist': 0.8330332815647126}
Round:88 - Active clients:[95 53 43 84  2 74 55 31 54 97]:
 Training time:23.775 seconds
 server global model correct 6633
 Testing time:46.354 seconds
 avg_test_acc: {'uniform': 0.6632999777793884, 'validclass': 0.6632999777793884, 'labeldist': 0.6632999777793884}
 pfl_avg_test_acc: {'uniform': 0.4239999920129776, 'validclass': 0.5970496118068696, 'labeldist': 0.8058834433555603}
Round:89 - Active clients:[65 21 87  6 46 74 44 60 72  5]:
 Training time:22.879 seconds
 server global model correct 6837
 Testing time:46.652 seconds
 avg_test_acc: {'uniform': 0.6837000250816345, 'validclass': 0.6837000250816345, 'labeldist': 0.6837000846862793}
 pfl_avg_test_acc: {'uniform': 0.4351500034332275, 'validclass': 0.6022083282470703, 'labeldist': 0.8262062788009643}
Round:90 - Active clients:[25 85 96 89 65 94  5 35 36 92]:
 Training time:25.362 seconds
 server global model correct 6909
 Testing time:46.435 seconds
 avg_test_acc: {'uniform': 0.6909000277519226, 'validclass': 0.6909000277519226, 'labeldist': 0.6909000277519226}
 pfl_avg_test_acc: {'uniform': 0.40609000325202943, 'validclass': 0.6380505442619324, 'labeldist': 0.8411323428153992}
Round:91 - Active clients:[75 25  3 52 78 54 59 26 62 97]:
 Training time:21.518 seconds
 server global model correct 6730
 Testing time:46.935 seconds
 avg_test_acc: {'uniform': 0.6729999780654907, 'validclass': 0.6729999780654907, 'labeldist': 0.6730000376701355}
 pfl_avg_test_acc: {'uniform': 0.42012001276016236, 'validclass': 0.5918222218751907, 'labeldist': 0.8010025441646575}
Round:92 - Active clients:[25 99 73 61 66 36 23 83 77  6]:
 Training time:14.378 seconds
 server global model correct 6807
 Testing time:46.929 seconds
 avg_test_acc: {'uniform': 0.6807000041007996, 'validclass': 0.6807000041007996, 'labeldist': 0.6806999444961548}
 pfl_avg_test_acc: {'uniform': 0.43861999809741975, 'validclass': 0.5783399999141693, 'labeldist': 0.7776715099811554}
Round:93 - Active clients:[75 82 56 27 42 35  1 97 66 61]:
 Training time:22.295 seconds
 server global model correct 6637
 Testing time:46.355 seconds
 avg_test_acc: {'uniform': 0.6636999845504761, 'validclass': 0.6636999845504761, 'labeldist': 0.6636999845504761}
 pfl_avg_test_acc: {'uniform': 0.4235000044107437, 'validclass': 0.5614197194576264, 'labeldist': 0.8314889013767243}
Round:94 - Active clients:[13 73  5 18 99 48 23  4 35 17]:
 Training time:22.298 seconds
 server global model correct 6721
 Testing time:46.391 seconds
 avg_test_acc: {'uniform': 0.6721000075340271, 'validclass': 0.6721000075340271, 'labeldist': 0.6721000075340271}
 pfl_avg_test_acc: {'uniform': 0.4184299990534782, 'validclass': 0.640933096408844, 'labeldist': 0.837508600950241}
Round:95 - Active clients:[88  9  1 60 95 26 45 71 44 21]:
 Training time:26.793 seconds
 server global model correct 6572
 Testing time:46.377 seconds
 avg_test_acc: {'uniform': 0.6571999788284302, 'validclass': 0.6571999788284302, 'labeldist': 0.657200038433075}
 pfl_avg_test_acc: {'uniform': 0.4213499963283539, 'validclass': 0.5777628481388092, 'labeldist': 0.8146757841110229}
Round:96 - Active clients:[41 28 52 15 87 17 75 42 45 49]:
 Training time:17.139 seconds
 server global model correct 7001
 Testing time:46.995 seconds
 avg_test_acc: {'uniform': 0.7001000046730042, 'validclass': 0.7001000046730042, 'labeldist': 0.7001000642776489}
 pfl_avg_test_acc: {'uniform': 0.43065000176429746, 'validclass': 0.5418051213026047, 'labeldist': 0.8232403099536896}
Round:97 - Active clients:[31 43 64 56 85  2 70 21 34 50]:
 Training time:24.711 seconds
 server global model correct 6875
 Testing time:46.863 seconds
 avg_test_acc: {'uniform': 0.6875, 'validclass': 0.6875, 'labeldist': 0.6874999403953552}
 pfl_avg_test_acc: {'uniform': 0.4400499999523163, 'validclass': 0.6077012330293655, 'labeldist': 0.8255276560783387}
Round:98 - Active clients:[11 48 97 14 22 36 99 47 33 81]:
 Training time:25.363 seconds
 server global model correct 6988
 Testing time:46.379 seconds
 avg_test_acc: {'uniform': 0.6988000273704529, 'validclass': 0.6988000273704529, 'labeldist': 0.6987999677658081}
 pfl_avg_test_acc: {'uniform': 0.4304500013589859, 'validclass': 0.6052901178598404, 'labeldist': 0.8467404425144196}
Round:99 - Active clients:[14 34 30 78 16 15 91 38 10 85]:
 Training time:21.527 seconds
 server global model correct 7109
 Testing time:46.409 seconds
 avg_test_acc: {'uniform': 0.7109000086784363, 'validclass': 0.7109000086784363, 'labeldist': 0.7109000086784363}
 pfl_avg_test_acc: {'uniform': 0.43945000469684603, 'validclass': 0.6105592012405395, 'labeldist': 0.8306861758232117}
Round:100 - Active clients:[37 62 26 41 35 25 36 33 77 21]:
 Training time:24.679 seconds
 server global model correct 6906
 Testing time:46.698 seconds
 avg_test_acc: {'uniform': 0.6905999779701233, 'validclass': 0.6905999779701233, 'labeldist': 0.6906000375747681}
 pfl_avg_test_acc: {'uniform': 0.44851000010967257, 'validclass': 0.6362022936344147, 'labeldist': 0.8321795642375946}
Round:101 - Active clients:[16  1 43 67 89 21 97 51  6 41]:
 Training time:23.107 seconds
 server global model correct 7019
 Testing time:46.397 seconds
 avg_test_acc: {'uniform': 0.7019000053405762, 'validclass': 0.7019000053405762, 'labeldist': 0.7019000053405762}
 pfl_avg_test_acc: {'uniform': 0.44965999871492385, 'validclass': 0.6134331375360489, 'labeldist': 0.8437255024909973}
Round:102 - Active clients:[98 46 97 21 44 33 75 65 83 15]:
 Training time:22.211 seconds
 server global model correct 6662
 Testing time:46.385 seconds
 avg_test_acc: {'uniform': 0.6661999821662903, 'validclass': 0.6661999821662903, 'labeldist': 0.6662000417709351}
 pfl_avg_test_acc: {'uniform': 0.4561700075864792, 'validclass': 0.5270450383424758, 'labeldist': 0.8304089605808258}
Round:103 - Active clients:[79 92 25 64 97 61 50 76 99 42]:
 Training time:21.590 seconds
 server global model correct 6520
 Testing time:46.426 seconds
 avg_test_acc: {'uniform': 0.6520000100135803, 'validclass': 0.6520000100135803, 'labeldist': 0.6520000100135803}
 pfl_avg_test_acc: {'uniform': 0.4474199950695038, 'validclass': 0.6326141238212586, 'labeldist': 0.8106435060501098}
Round:104 - Active clients:[23  2 22 27 53 84 56 98 72 57]:
 Training time:21.432 seconds
 server global model correct 7246
 Testing time:46.537 seconds
 avg_test_acc: {'uniform': 0.7246000170707703, 'validclass': 0.7246000170707703, 'labeldist': 0.7246000170707703}
 pfl_avg_test_acc: {'uniform': 0.47438999712467195, 'validclass': 0.61853808760643, 'labeldist': 0.8113511502742767}
 Best test accuracy:0.725. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:105 - Active clients:[52 26 40 89 90 85  3 87 63 92]:
 Training time:26.008 seconds
 server global model correct 6686
 Testing time:48.057 seconds
 avg_test_acc: {'uniform': 0.6686000227928162, 'validclass': 0.6686000227928162, 'labeldist': 0.6685999631881714}
 pfl_avg_test_acc: {'uniform': 0.42714000344276426, 'validclass': 0.6346027791500092, 'labeldist': 0.8052754878997803}
Round:106 - Active clients:[28  4 98 49  1 50 72 38 46 79]:
 Training time:19.048 seconds
 server global model correct 7033
 Testing time:46.775 seconds
 avg_test_acc: {'uniform': 0.7032999992370605, 'validclass': 0.7032999992370605, 'labeldist': 0.7032999992370605}
 pfl_avg_test_acc: {'uniform': 0.43106999695301057, 'validclass': 0.512603372335434, 'labeldist': 0.8262512683868408}
Round:107 - Active clients:[35 46  1 32 90 77 10 87 69 84]:
 Training time:22.490 seconds
 server global model correct 7434
 Testing time:46.415 seconds
 avg_test_acc: {'uniform': 0.743399977684021, 'validclass': 0.743399977684021, 'labeldist': 0.743399977684021}
 pfl_avg_test_acc: {'uniform': 0.4674500048160553, 'validclass': 0.6029451161623001, 'labeldist': 0.8152216911315918}
 Best test accuracy:0.743. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:108 - Active clients:[59 12 21 16 72 29 58 73 34 13]:
 Training time:19.199 seconds
 server global model correct 7231
 Testing time:47.173 seconds
 avg_test_acc: {'uniform': 0.7231000065803528, 'validclass': 0.7231000065803528, 'labeldist': 0.7231000661849976}
 pfl_avg_test_acc: {'uniform': 0.4580499976873398, 'validclass': 0.5471953988075257, 'labeldist': 0.8288360297679901}
Round:109 - Active clients:[70 61 90 68 91 87 86 20 49 67]:
 Training time:24.242 seconds
 server global model correct 6978
 Testing time:47.044 seconds
 avg_test_acc: {'uniform': 0.6977999806404114, 'validclass': 0.6977999806404114, 'labeldist': 0.6977999806404114}
 pfl_avg_test_acc: {'uniform': 0.42331999987363816, 'validclass': 0.5582102745771408, 'labeldist': 0.847424203157425}
Round:110 - Active clients:[14 88 71 30 75 63 24 87 98 19]:
 Training time:21.917 seconds
 server global model correct 7207
 Testing time:46.728 seconds
 avg_test_acc: {'uniform': 0.7207000255584717, 'validclass': 0.7207000255584717, 'labeldist': 0.7207000255584717}
 pfl_avg_test_acc: {'uniform': 0.4389500021934509, 'validclass': 0.6127967417240143, 'labeldist': 0.8173305571079255}
Round:111 - Active clients:[15 53 44 16 90 20 89 91 92 36]:
 Training time:25.937 seconds
 server global model correct 7054
 Testing time:46.508 seconds
 avg_test_acc: {'uniform': 0.7053999900817871, 'validclass': 0.7053999900817871, 'labeldist': 0.7054000496864319}
 pfl_avg_test_acc: {'uniform': 0.5098899900913239, 'validclass': 0.6206161975860596, 'labeldist': 0.8330174505710601}
Round:112 - Active clients:[ 0 64 55 36 33 45 73 84 56 80]:
 Training time:20.000 seconds
 server global model correct 5361
 Testing time:46.440 seconds
 avg_test_acc: {'uniform': 0.5360999703407288, 'validclass': 0.5360999703407288, 'labeldist': 0.5360999703407288}
 pfl_avg_test_acc: {'uniform': 0.39880000054836273, 'validclass': 0.6559888839721679, 'labeldist': 0.8365155279636383}
Round:113 - Active clients:[76 53 98 13 52 38 94 43 20 48]:
 Training time:25.534 seconds
 server global model correct 6535
 Testing time:46.366 seconds
 avg_test_acc: {'uniform': 0.6535000205039978, 'validclass': 0.6535000205039978, 'labeldist': 0.6535000205039978}
 pfl_avg_test_acc: {'uniform': 0.43743000030517576, 'validclass': 0.5768826901912689, 'labeldist': 0.8282794654369354}
Round:114 - Active clients:[83 65 93 90 24  8 36 16 85 25]:
 Training time:23.225 seconds
 server global model correct 6425
 Testing time:46.409 seconds
 avg_test_acc: {'uniform': 0.6424999833106995, 'validclass': 0.6424999833106995, 'labeldist': 0.6424999833106995}
 pfl_avg_test_acc: {'uniform': 0.4423099994659424, 'validclass': 0.6540663123130799, 'labeldist': 0.8364084303379059}
Round:115 - Active clients:[78 96 25 26 59 71 42 15 35 73]:
 Training time:20.542 seconds
 server global model correct 7230
 Testing time:46.343 seconds
 avg_test_acc: {'uniform': 0.7229999899864197, 'validclass': 0.7229999899864197, 'labeldist': 0.7229999899864197}
 pfl_avg_test_acc: {'uniform': 0.4428999960422516, 'validclass': 0.611323007941246, 'labeldist': 0.83219775557518}
Round:116 - Active clients:[38 69  7 33 15 78 20 34 56 32]:
 Training time:21.814 seconds
 server global model correct 7121
 Testing time:46.289 seconds
 avg_test_acc: {'uniform': 0.7121000289916992, 'validclass': 0.7121000289916992, 'labeldist': 0.7121000289916992}
 pfl_avg_test_acc: {'uniform': 0.4540899991989136, 'validclass': 0.5921598464250565, 'labeldist': 0.8493029296398162}
Round:117 - Active clients:[64 91 65 47 60  1  5 29 74 70]:
 Training time:23.775 seconds
 server global model correct 6917
 Testing time:46.337 seconds
 avg_test_acc: {'uniform': 0.6916999816894531, 'validclass': 0.6916999816894531, 'labeldist': 0.6917000412940979}
 pfl_avg_test_acc: {'uniform': 0.45726999938488005, 'validclass': 0.6220162779092788, 'labeldist': 0.8378887593746185}
Round:118 - Active clients:[ 4 32 41 78 82 16 13 58 66 92]:
 Training time:21.649 seconds
 server global model correct 7375
 Testing time:46.373 seconds
 avg_test_acc: {'uniform': 0.737500011920929, 'validclass': 0.737500011920929, 'labeldist': 0.7375000715255737}
 pfl_avg_test_acc: {'uniform': 0.4582899987697601, 'validclass': 0.5826954066753387, 'labeldist': 0.8519939541816711}
Round:119 - Active clients:[53 20  7 13 51 31  0 79 82 75]:
 Training time:24.347 seconds
 server global model correct 6923
 Testing time:46.391 seconds
 avg_test_acc: {'uniform': 0.692300021648407, 'validclass': 0.692300021648407, 'labeldist': 0.692300021648407}
 pfl_avg_test_acc: {'uniform': 0.460359999537468, 'validclass': 0.5552773773670197, 'labeldist': 0.8633132219314575}
Round:120 - Active clients:[80 38  5 61 93 66 41 65  3 72]:
 Training time:22.048 seconds
 server global model correct 7113
 Testing time:46.862 seconds
 avg_test_acc: {'uniform': 0.7113000154495239, 'validclass': 0.7113000154495239, 'labeldist': 0.7113000154495239}
 pfl_avg_test_acc: {'uniform': 0.44799000322818755, 'validclass': 0.6701484113931656, 'labeldist': 0.8331019282341003}
Round:121 - Active clients:[82 38 23 98 18 22 20 15 97 29]:
 Training time:20.844 seconds
 server global model correct 7361
 Testing time:46.614 seconds
 avg_test_acc: {'uniform': 0.7361000180244446, 'validclass': 0.7361000180244446, 'labeldist': 0.7360999584197998}
 pfl_avg_test_acc: {'uniform': 0.4412300050258636, 'validclass': 0.5669036090373993, 'labeldist': 0.8438125014305115}
Round:122 - Active clients:[49 96  3 34 17 85 53 27 37 90]:
 Training time:24.471 seconds
 server global model correct 7255
 Testing time:46.667 seconds
 avg_test_acc: {'uniform': 0.7254999876022339, 'validclass': 0.7254999876022339, 'labeldist': 0.7254999876022339}
 pfl_avg_test_acc: {'uniform': 0.47872000336647036, 'validclass': 0.5688823461532593, 'labeldist': 0.8410671532154084}
Round:123 - Active clients:[ 8 70 82 28 63  0  5 50 81  4]:
 Training time:18.124 seconds
 server global model correct 7230
 Testing time:46.449 seconds
 avg_test_acc: {'uniform': 0.7229999899864197, 'validclass': 0.7229999899864197, 'labeldist': 0.7229999899864197}
 pfl_avg_test_acc: {'uniform': 0.4064999967813492, 'validclass': 0.606521663069725, 'labeldist': 0.8560108482837677}
Round:124 - Active clients:[35 34 27 23 61 77 13 88 10 56]:
 Training time:25.879 seconds
 server global model correct 7280
 Testing time:46.393 seconds
 avg_test_acc: {'uniform': 0.7279999852180481, 'validclass': 0.7279999852180481, 'labeldist': 0.7279999852180481}
 pfl_avg_test_acc: {'uniform': 0.4627800017595291, 'validclass': 0.6225230991840363, 'labeldist': 0.8416945219039917}
Round:125 - Active clients:[65  2 49  6 83 73 33  8 54 48]:
 Training time:21.596 seconds
 server global model correct 6852
 Testing time:46.770 seconds
 avg_test_acc: {'uniform': 0.6851999759674072, 'validclass': 0.6851999759674072, 'labeldist': 0.685200035572052}
 pfl_avg_test_acc: {'uniform': 0.44650999307632444, 'validclass': 0.6029296457767487, 'labeldist': 0.8464645147323608}
Round:126 - Active clients:[13 18 88 63 37 43 20  0 47  5]:
 Training time:29.797 seconds
 server global model correct 6402
 Testing time:47.428 seconds
 avg_test_acc: {'uniform': 0.6402000188827515, 'validclass': 0.6402000188827515, 'labeldist': 0.6402000188827515}
 pfl_avg_test_acc: {'uniform': 0.39316999912261963, 'validclass': 0.6783403187990189, 'labeldist': 0.8713984608650207}
Round:127 - Active clients:[17 10 86 24 75 48 40 41  6 85]:
 Training time:23.272 seconds
 server global model correct 6772
 Testing time:46.620 seconds
 avg_test_acc: {'uniform': 0.6772000193595886, 'validclass': 0.6772000193595886, 'labeldist': 0.6772000789642334}
 pfl_avg_test_acc: {'uniform': 0.42710000574588775, 'validclass': 0.6156863510608673, 'labeldist': 0.8474624633789063}
Round:128 - Active clients:[65 67 33 18 13 31 24 38 32 41]:
 Training time:28.189 seconds
 server global model correct 6758
 Testing time:46.201 seconds
 avg_test_acc: {'uniform': 0.6758000254631042, 'validclass': 0.6758000254631042, 'labeldist': 0.6758000254631042}
 pfl_avg_test_acc: {'uniform': 0.44872999638319017, 'validclass': 0.6715944468975067, 'labeldist': 0.8685198128223419}
Round:129 - Active clients:[65 68 59  9 38 67 41 97 37 18]:
 Training time:24.967 seconds
 server global model correct 7016
 Testing time:46.678 seconds
 avg_test_acc: {'uniform': 0.7016000151634216, 'validclass': 0.7016000151634216, 'labeldist': 0.7015999555587769}
 pfl_avg_test_acc: {'uniform': 0.4052599959075451, 'validclass': 0.6112730920314788, 'labeldist': 0.8795997023582458}
Round:130 - Active clients:[43 93 41  3 42  6 97 53 73 49]:
 Training time:19.980 seconds
 server global model correct 7290
 Testing time:47.851 seconds
 avg_test_acc: {'uniform': 0.7289999723434448, 'validclass': 0.7289999723434448, 'labeldist': 0.7289999723434448}
 pfl_avg_test_acc: {'uniform': 0.4854299992322922, 'validclass': 0.6120244443416596, 'labeldist': 0.8297722518444062}
Round:131 - Active clients:[58 91 28 46 13  2 34 49 81 23]:
 Training time:21.330 seconds
 server global model correct 7484
 Testing time:46.238 seconds
 avg_test_acc: {'uniform': 0.7483999729156494, 'validclass': 0.7483999729156494, 'labeldist': 0.7484000325202942}
 pfl_avg_test_acc: {'uniform': 0.4773900002241135, 'validclass': 0.5523313045501709, 'labeldist': 0.8536093533039093}
 Best test accuracy:0.748. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:132 - Active clients:[65  2 27 95  8 16 15 92 85 79]:
 Training time:26.720 seconds
 server global model correct 7003
 Testing time:46.216 seconds
 avg_test_acc: {'uniform': 0.7002999782562256, 'validclass': 0.7002999782562256, 'labeldist': 0.7002999782562256}
 pfl_avg_test_acc: {'uniform': 0.488510000705719, 'validclass': 0.6173300325870514, 'labeldist': 0.8460079252719879}
Round:133 - Active clients:[96 46 15 71 80 11  0 37 67 27]:
 Training time:25.038 seconds
 server global model correct 6955
 Testing time:46.494 seconds
 avg_test_acc: {'uniform': 0.6955000162124634, 'validclass': 0.6955000162124634, 'labeldist': 0.6955000758171082}
 pfl_avg_test_acc: {'uniform': 0.40187000185251237, 'validclass': 0.6334315538406372, 'labeldist': 0.8593803405761719}
Round:134 - Active clients:[39 45 78 25 90 98 48 47 72 66]:
 Training time:23.323 seconds
 server global model correct 7583
 Testing time:46.801 seconds
 avg_test_acc: {'uniform': 0.7583000063896179, 'validclass': 0.7583000063896179, 'labeldist': 0.7583000659942627}
 pfl_avg_test_acc: {'uniform': 0.4297999948263168, 'validclass': 0.6662278175354004, 'labeldist': 0.8712009489536285}
 Best test accuracy:0.758. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:135 - Active clients:[24 32 82 20 94 30 54 15 46 51]:
 Training time:24.000 seconds
 server global model correct 7317
 Testing time:46.277 seconds
 avg_test_acc: {'uniform': 0.7317000031471252, 'validclass': 0.7317000031471252, 'labeldist': 0.73170006275177}
 pfl_avg_test_acc: {'uniform': 0.44484000504016874, 'validclass': 0.616472738981247, 'labeldist': 0.8628539144992828}
Round:136 - Active clients:[16 55 28 84 49 99 86 67 87 53]:
 Training time:19.602 seconds
 server global model correct 7244
 Testing time:46.620 seconds
 avg_test_acc: {'uniform': 0.724399983882904, 'validclass': 0.724399983882904, 'labeldist': 0.7244000434875488}
 pfl_avg_test_acc: {'uniform': 0.47672000229358674, 'validclass': 0.6278178572654725, 'labeldist': 0.8113250315189362}
Round:137 - Active clients:[88 73 90 93 87 13  0 53 18 20]:
 Training time:25.526 seconds
 server global model correct 7252
 Testing time:46.250 seconds
 avg_test_acc: {'uniform': 0.7251999974250793, 'validclass': 0.7251999974250793, 'labeldist': 0.7251999974250793}
 pfl_avg_test_acc: {'uniform': 0.4628299981355667, 'validclass': 0.6541832506656646, 'labeldist': 0.8644518792629242}
Round:138 - Active clients:[74 23 41 55  8 44 12 97 88 45]:
 Training time:21.353 seconds
 server global model correct 6964
 Testing time:46.570 seconds
 avg_test_acc: {'uniform': 0.696399986743927, 'validclass': 0.696399986743927, 'labeldist': 0.6964000463485718}
 pfl_avg_test_acc: {'uniform': 0.45769000351428984, 'validclass': 0.5922491163015365, 'labeldist': 0.8520551502704621}
Round:139 - Active clients:[52 82 14  7 40 45 23 39 74 68]:
 Training time:21.085 seconds
 server global model correct 7109
 Testing time:46.409 seconds
 avg_test_acc: {'uniform': 0.7109000086784363, 'validclass': 0.7109000086784363, 'labeldist': 0.7109000086784363}
 pfl_avg_test_acc: {'uniform': 0.45613000094890593, 'validclass': 0.5708088874816895, 'labeldist': 0.8618821859359741}
Round:140 - Active clients:[64  9 98 29 60 39  1 43 90 42]:
 Training time:23.947 seconds
 server global model correct 7341
 Testing time:46.544 seconds
 avg_test_acc: {'uniform': 0.7340999841690063, 'validclass': 0.7340999841690063, 'labeldist': 0.7340999841690063}
 pfl_avg_test_acc: {'uniform': 0.5139899969100952, 'validclass': 0.6356855899095535, 'labeldist': 0.8452979505062104}
Round:141 - Active clients:[46  1 51 10 96 87 15 73 20 41]:
 Training time:22.949 seconds
 server global model correct 7521
 Testing time:46.281 seconds
 avg_test_acc: {'uniform': 0.7520999908447266, 'validclass': 0.7520999908447266, 'labeldist': 0.7520999312400818}
 pfl_avg_test_acc: {'uniform': 0.4757799983024597, 'validclass': 0.5929666727781295, 'labeldist': 0.8560031056404114}
Round:142 - Active clients:[25 61 42 33 81 68  6  7 54 94]:
 Training time:19.672 seconds
 server global model correct 6986
 Testing time:46.335 seconds
 avg_test_acc: {'uniform': 0.6985999941825867, 'validclass': 0.6985999941825867, 'labeldist': 0.6986000537872314}
 pfl_avg_test_acc: {'uniform': 0.40218000411987304, 'validclass': 0.5804336100816727, 'labeldist': 0.8569880664348603}
Round:143 - Active clients:[48  9 67 99 79  5 66 46 42 65]:
 Training time:24.728 seconds
 server global model correct 7322
 Testing time:46.884 seconds
 avg_test_acc: {'uniform': 0.732200026512146, 'validclass': 0.732200026512146, 'labeldist': 0.7321999669075012}
 pfl_avg_test_acc: {'uniform': 0.4545099914073944, 'validclass': 0.7157291650772095, 'labeldist': 0.8721782386302948}
Round:144 - Active clients:[79 90 28 32 18 35 17 59 99 64]:
 Training time:23.168 seconds
 server global model correct 6957
 Testing time:46.244 seconds
 avg_test_acc: {'uniform': 0.6956999897956848, 'validclass': 0.6956999897956848, 'labeldist': 0.6956999897956848}
 pfl_avg_test_acc: {'uniform': 0.4680599942803383, 'validclass': 0.6302874565124512, 'labeldist': 0.8629901945590973}
Round:145 - Active clients:[39 24 70 43 88 74 45 54 63  0]:
 Training time:22.036 seconds
 server global model correct 7461
 Testing time:46.574 seconds
 avg_test_acc: {'uniform': 0.7461000084877014, 'validclass': 0.7461000084877014, 'labeldist': 0.7461000084877014}
 pfl_avg_test_acc: {'uniform': 0.4161899983882904, 'validclass': 0.6489622175693512, 'labeldist': 0.8618745505809784}
Round:146 - Active clients:[91 54 23 10 89 34 68 83 84 67]:
 Training time:22.393 seconds
 server global model correct 7406
 Testing time:46.708 seconds
 avg_test_acc: {'uniform': 0.7405999898910522, 'validclass': 0.7405999898910522, 'labeldist': 0.7405999898910522}
 pfl_avg_test_acc: {'uniform': 0.43965000212192534, 'validclass': 0.6808553606271743, 'labeldist': 0.8520594298839569}
Round:147 - Active clients:[ 9 28 51 49 13  6 26 61 15 37]:
 Training time:18.414 seconds
 server global model correct 7164
 Testing time:46.341 seconds
 avg_test_acc: {'uniform': 0.7164000272750854, 'validclass': 0.7164000272750854, 'labeldist': 0.7164000272750854}
 pfl_avg_test_acc: {'uniform': 0.4890300065279007, 'validclass': 0.5940213531255722, 'labeldist': 0.8261501550674438}
Round:148 - Active clients:[77 90 30 39 54 62 59 37 76 10]:
 Training time:24.149 seconds
 server global model correct 6697
 Testing time:46.945 seconds
 avg_test_acc: {'uniform': 0.669700026512146, 'validclass': 0.669700026512146, 'labeldist': 0.669700026512146}
 pfl_avg_test_acc: {'uniform': 0.45946999788284304, 'validclass': 0.6588769078254699, 'labeldist': 0.8694675981998443}
Round:149 - Active clients:[50 72 62 53 76 94 25 13 42 51]:
 Training time:20.008 seconds
 server global model correct 7322
 Testing time:46.391 seconds
 avg_test_acc: {'uniform': 0.732200026512146, 'validclass': 0.732200026512146, 'labeldist': 0.732200026512146}
 pfl_avg_test_acc: {'uniform': 0.4881300002336502, 'validclass': 0.6640515804290772, 'labeldist': 0.8510975897312164}
Round:150 - Active clients:[85 57 52 32 35 20 39 72  8 89]:
 Training time:26.817 seconds
 server global model correct 6914
 Testing time:46.334 seconds
 avg_test_acc: {'uniform': 0.6913999915122986, 'validclass': 0.6913999915122986, 'labeldist': 0.6914000511169434}
 pfl_avg_test_acc: {'uniform': 0.5033300042152404, 'validclass': 0.6510457873344422, 'labeldist': 0.8641667068004608}
Round:151 - Active clients:[18 12 88 60 84 40 53 15 49  1]:
 Training time:22.915 seconds
 server global model correct 7475
 Testing time:47.229 seconds
 avg_test_acc: {'uniform': 0.7475000023841858, 'validclass': 0.7475000023841858, 'labeldist': 0.7475000023841858}
 pfl_avg_test_acc: {'uniform': 0.45958000272512434, 'validclass': 0.643362694978714, 'labeldist': 0.8398864984512329}
Round:152 - Active clients:[61 37 89 76 10 46 84 32 75 38]:
 Training time:20.837 seconds
 server global model correct 7309
 Testing time:46.407 seconds
 avg_test_acc: {'uniform': 0.73089998960495, 'validclass': 0.73089998960495, 'labeldist': 0.7309000492095947}
 pfl_avg_test_acc: {'uniform': 0.4749199986457825, 'validclass': 0.6290335685014725, 'labeldist': 0.8466026604175567}
Round:153 - Active clients:[32 27 80 15 25 13 91 83 51 56]:
 Training time:22.070 seconds
 server global model correct 6226
 Testing time:46.467 seconds
 avg_test_acc: {'uniform': 0.6226000189781189, 'validclass': 0.6226000189781189, 'labeldist': 0.6226000189781189}
 pfl_avg_test_acc: {'uniform': 0.4638699948787689, 'validclass': 0.7154494464397431, 'labeldist': 0.8697221159934998}
Round:154 - Active clients:[93 62 98 13  5 77  2 65 96 53]:
 Training time:22.832 seconds
 server global model correct 6991
 Testing time:46.367 seconds
 avg_test_acc: {'uniform': 0.6991000175476074, 'validclass': 0.6991000175476074, 'labeldist': 0.6990999579429626}
 pfl_avg_test_acc: {'uniform': 0.470770001411438, 'validclass': 0.6246736139059067, 'labeldist': 0.8420395076274871}
Round:155 - Active clients:[78 45 76 63 38 30  1 20 80 13]:
 Training time:27.766 seconds
 server global model correct 6852
 Testing time:46.746 seconds
 avg_test_acc: {'uniform': 0.6851999759674072, 'validclass': 0.6851999759674072, 'labeldist': 0.685200035572052}
 pfl_avg_test_acc: {'uniform': 0.4235799998044968, 'validclass': 0.6562862664461135, 'labeldist': 0.8886412620544434}
Round:156 - Active clients:[ 0 79 98 90 80 50 82 29 93 68]:
 Training time:21.460 seconds
 server global model correct 7499
 Testing time:46.459 seconds
 avg_test_acc: {'uniform': 0.7498999834060669, 'validclass': 0.7498999834060669, 'labeldist': 0.7498999834060669}
 pfl_avg_test_acc: {'uniform': 0.42964999973773954, 'validclass': 0.6148545563220977, 'labeldist': 0.8778383076190949}
Round:157 - Active clients:[93 73 99 29 37 92 90 12  7 96]:
 Training time:20.003 seconds
 server global model correct 7561
 Testing time:47.664 seconds
 avg_test_acc: {'uniform': 0.7560999989509583, 'validclass': 0.7560999989509583, 'labeldist': 0.756100058555603}
 pfl_avg_test_acc: {'uniform': 0.47984000444412234, 'validclass': 0.6065147310495377, 'labeldist': 0.8373547255992889}
Round:158 - Active clients:[27 15 55 77 19  0 75 87 65 57]:
 Training time:22.815 seconds
 server global model correct 7330
 Testing time:46.380 seconds
 avg_test_acc: {'uniform': 0.7329999804496765, 'validclass': 0.7329999804496765, 'labeldist': 0.7329999804496765}
 pfl_avg_test_acc: {'uniform': 0.5248700052499771, 'validclass': 0.6217821031808853, 'labeldist': 0.8520251095294953}
Round:159 - Active clients:[50 75 45 33 21  8 52 62 82 59]:
 Training time:18.891 seconds
 server global model correct 7222
 Testing time:46.381 seconds
 avg_test_acc: {'uniform': 0.7221999764442444, 'validclass': 0.7221999764442444, 'labeldist': 0.7222000360488892}
 pfl_avg_test_acc: {'uniform': 0.5075599998235703, 'validclass': 0.5832455515861511, 'labeldist': 0.8470050394535065}
Round:160 - Active clients:[ 9 57 22 41 28 46 83 73 85 71]:
 Training time:20.108 seconds
 server global model correct 7498
 Testing time:46.732 seconds
 avg_test_acc: {'uniform': 0.7498000264167786, 'validclass': 0.7498000264167786, 'labeldist': 0.7497999668121338}
 pfl_avg_test_acc: {'uniform': 0.5091299951076508, 'validclass': 0.6213910728693008, 'labeldist': 0.8594038188457489}
Round:161 - Active clients:[91  7 93 55 62  9 25 20 98 30]:
 Training time:24.273 seconds
 server global model correct 7416
 Testing time:46.424 seconds
 avg_test_acc: {'uniform': 0.741599977016449, 'validclass': 0.741599977016449, 'labeldist': 0.7416000366210938}
 pfl_avg_test_acc: {'uniform': 0.4720499962568283, 'validclass': 0.6567466706037521, 'labeldist': 0.8535842955112457}
Round:162 - Active clients:[31 40 67 21  0 88 90 93 41 20]:
 Training time:30.454 seconds
 server global model correct 7102
 Testing time:46.386 seconds
 avg_test_acc: {'uniform': 0.7102000117301941, 'validclass': 0.7102000117301941, 'labeldist': 0.7102000117301941}
 pfl_avg_test_acc: {'uniform': 0.455929996073246, 'validclass': 0.6599672555923461, 'labeldist': 0.8719965100288392}
Round:163 - Active clients:[54 92 21 58 49 95 24 61 52  4]:
 Training time:20.717 seconds
 server global model correct 7450
 Testing time:46.393 seconds
 avg_test_acc: {'uniform': 0.7450000047683716, 'validclass': 0.7450000047683716, 'labeldist': 0.7450000643730164}
 pfl_avg_test_acc: {'uniform': 0.4853799998760223, 'validclass': 0.6077436119318008, 'labeldist': 0.8296432554721832}
Round:164 - Active clients:[32 92 71  3 65 60 25 30 39 19]:
 Training time:26.074 seconds
 server global model correct 7533
 Testing time:46.455 seconds
 avg_test_acc: {'uniform': 0.7533000111579895, 'validclass': 0.7533000111579895, 'labeldist': 0.7533000111579895}
 pfl_avg_test_acc: {'uniform': 0.4775699973106384, 'validclass': 0.6915690481662751, 'labeldist': 0.8626259088516235}
Round:165 - Active clients:[62 14 59 39 40 26 54 82  6 95]:
 Training time:21.332 seconds
 server global model correct 7583
 Testing time:46.400 seconds
 avg_test_acc: {'uniform': 0.7583000063896179, 'validclass': 0.7583000063896179, 'labeldist': 0.7583000659942627}
 pfl_avg_test_acc: {'uniform': 0.52469000518322, 'validclass': 0.6481789708137512, 'labeldist': 0.85248002409935}
Round:166 - Active clients:[53 75 92 67 43  7 46 98 77 64]:
 Training time:23.004 seconds
 server global model correct 7428
 Testing time:46.350 seconds
 avg_test_acc: {'uniform': 0.7427999973297119, 'validclass': 0.7427999973297119, 'labeldist': 0.7427999973297119}
 pfl_avg_test_acc: {'uniform': 0.48350000381469727, 'validclass': 0.6477278649806977, 'labeldist': 0.8676271617412568}
Round:167 - Active clients:[61 35 96 93  2 95 40  5 26 11]:
 Training time:24.008 seconds
 server global model correct 6940
 Testing time:46.342 seconds
 avg_test_acc: {'uniform': 0.6940000057220459, 'validclass': 0.6940000057220459, 'labeldist': 0.6939999461174011}
 pfl_avg_test_acc: {'uniform': 0.4627199947834015, 'validclass': 0.6387750059366226, 'labeldist': 0.8307049751281739}
Round:168 - Active clients:[33 60 31 76 79 86 16 19 47 68]:
 Training time:25.205 seconds
 server global model correct 7473
 Testing time:46.577 seconds
 avg_test_acc: {'uniform': 0.7473000288009644, 'validclass': 0.7473000288009644, 'labeldist': 0.7473000288009644}
 pfl_avg_test_acc: {'uniform': 0.48351000249385834, 'validclass': 0.630786943435669, 'labeldist': 0.8767206013202667}
Round:169 - Active clients:[13 31 85 69 87 59  2 46 67 40]:
 Training time:22.615 seconds
 server global model correct 7482
 Testing time:46.372 seconds
 avg_test_acc: {'uniform': 0.748199999332428, 'validclass': 0.748199999332428, 'labeldist': 0.748199999332428}
 pfl_avg_test_acc: {'uniform': 0.5001499965786934, 'validclass': 0.664988535642624, 'labeldist': 0.871419483423233}
Round:170 - Active clients:[83 75 84 21  0 68 30 91 96 56]:
 Training time:18.356 seconds
 server global model correct 7151
 Testing time:46.347 seconds
 avg_test_acc: {'uniform': 0.7150999903678894, 'validclass': 0.7150999903678894, 'labeldist': 0.7151000499725342}
 pfl_avg_test_acc: {'uniform': 0.41224000304937364, 'validclass': 0.5799957484006881, 'labeldist': 0.8570083200931549}
Round:171 - Active clients:[72 76 52 63  4 33 59 47  2 49]:
 Training time:21.640 seconds
 server global model correct 7448
 Testing time:46.419 seconds
 avg_test_acc: {'uniform': 0.7447999715805054, 'validclass': 0.7447999715805054, 'labeldist': 0.7447999119758606}
 pfl_avg_test_acc: {'uniform': 0.4746099978685379, 'validclass': 0.6191713064908981, 'labeldist': 0.8723622679710388}
Round:172 - Active clients:[17 56 35 15 96 30 24 75 39  0]:
 Training time:18.635 seconds
 server global model correct 7219
 Testing time:46.509 seconds
 avg_test_acc: {'uniform': 0.7218999862670898, 'validclass': 0.7218999862670898, 'labeldist': 0.7219000458717346}
 pfl_avg_test_acc: {'uniform': 0.4618499994277954, 'validclass': 0.6164297640323639, 'labeldist': 0.8613924980163574}
Round:173 - Active clients:[70  1 20 90 94 82 80 73 27  8]:
 Training time:25.515 seconds
 server global model correct 7474
 Testing time:46.718 seconds
 avg_test_acc: {'uniform': 0.7473999857902527, 'validclass': 0.7473999857902527, 'labeldist': 0.7473999857902527}
 pfl_avg_test_acc: {'uniform': 0.5163599997758865, 'validclass': 0.6283669888973236, 'labeldist': 0.8713414549827576}
Round:174 - Active clients:[13 96 94 55  6 21 51 10 34 50]:
 Training time:19.701 seconds
 server global model correct 7728
 Testing time:46.373 seconds
 avg_test_acc: {'uniform': 0.7728000283241272, 'validclass': 0.7728000283241272, 'labeldist': 0.7728000283241272}
 pfl_avg_test_acc: {'uniform': 0.49700999855995176, 'validclass': 0.6129126220941543, 'labeldist': 0.8510511100292206}
 Best test accuracy:0.773. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:175 - Active clients:[17 80 47 42 99 76 48 94 25 24]:
 Training time:22.788 seconds
 server global model correct 6843
 Testing time:46.461 seconds
 avg_test_acc: {'uniform': 0.6843000054359436, 'validclass': 0.6843000054359436, 'labeldist': 0.6843000650405884}
 pfl_avg_test_acc: {'uniform': 0.4437199950218201, 'validclass': 0.7255495965480805, 'labeldist': 0.8700909733772277}
Round:176 - Active clients:[ 7 49 74 23 33 39 28 35  2 93]:
 Training time:19.894 seconds
 server global model correct 7329
 Testing time:46.302 seconds
 avg_test_acc: {'uniform': 0.7329000234603882, 'validclass': 0.7329000234603882, 'labeldist': 0.7329000234603882}
 pfl_avg_test_acc: {'uniform': 0.4818699985742569, 'validclass': 0.5956986337900162, 'labeldist': 0.864374327659607}
Round:177 - Active clients:[89 97 65  1 80 27 25 93 37 54]:
 Training time:28.426 seconds
 server global model correct 6873
 Testing time:46.807 seconds
 avg_test_acc: {'uniform': 0.6873000264167786, 'validclass': 0.6873000264167786, 'labeldist': 0.6873000264167786}
 pfl_avg_test_acc: {'uniform': 0.49030000567436216, 'validclass': 0.7415602445602417, 'labeldist': 0.8810218751430512}
Round:178 - Active clients:[ 1 32 94 87 33 50 91 52 77 59]:
 Training time:19.241 seconds
 server global model correct 7500
 Testing time:48.359 seconds
 avg_test_acc: {'uniform': 0.75, 'validclass': 0.75, 'labeldist': 0.7499999403953552}
 pfl_avg_test_acc: {'uniform': 0.5591399937868118, 'validclass': 0.6118290901184082, 'labeldist': 0.8372469484806061}
Round:179 - Active clients:[93 94 18 27 50 29 80 40 20 56]:
 Training time:23.548 seconds
 server global model correct 7019
 Testing time:46.295 seconds
 avg_test_acc: {'uniform': 0.7019000053405762, 'validclass': 0.7019000053405762, 'labeldist': 0.7019000053405762}
 pfl_avg_test_acc: {'uniform': 0.4543300002813339, 'validclass': 0.7256425708532334, 'labeldist': 0.8771148681640625}
Round:180 - Active clients:[67 71 64 63 96 16 30  6  9 61]:
 Training time:19.380 seconds
 server global model correct 7616
 Testing time:46.678 seconds
 avg_test_acc: {'uniform': 0.7616000175476074, 'validclass': 0.7616000175476074, 'labeldist': 0.7616000771522522}
 pfl_avg_test_acc: {'uniform': 0.4606299981474876, 'validclass': 0.659846943616867, 'labeldist': 0.852917468547821}
Round:181 - Active clients:[67 37 22 13 40 45 60 15 29 59]:
 Training time:21.501 seconds
 server global model correct 7398
 Testing time:46.656 seconds
 avg_test_acc: {'uniform': 0.739799976348877, 'validclass': 0.739799976348877, 'labeldist': 0.739799976348877}
 pfl_avg_test_acc: {'uniform': 0.5035199970006943, 'validclass': 0.6724693655967713, 'labeldist': 0.8563928008079529}
Round:182 - Active clients:[76 81 58 20 97 47 59 40 93 56]:
 Training time:24.880 seconds
 server global model correct 7308
 Testing time:46.550 seconds
 avg_test_acc: {'uniform': 0.7307999730110168, 'validclass': 0.7307999730110168, 'labeldist': 0.7307999730110168}
 pfl_avg_test_acc: {'uniform': 0.4669299989938736, 'validclass': 0.6607436835765839, 'labeldist': 0.8886130511760711}
Round:183 - Active clients:[58 34 18 69 26 86 72 45 29  9]:
 Training time:20.059 seconds
 server global model correct 7668
 Testing time:46.283 seconds
 avg_test_acc: {'uniform': 0.7667999863624573, 'validclass': 0.7667999863624573, 'labeldist': 0.7667999863624573}
 pfl_avg_test_acc: {'uniform': 0.49013000130653384, 'validclass': 0.6677388072013855, 'labeldist': 0.86669220328331}
Round:184 - Active clients:[87 50 18 81 51 70 34 42 15 77]:
 Training time:19.472 seconds
 server global model correct 7784
 Testing time:46.297 seconds
 avg_test_acc: {'uniform': 0.7784000039100647, 'validclass': 0.7784000039100647, 'labeldist': 0.7783999443054199}
 pfl_avg_test_acc: {'uniform': 0.5152999997138977, 'validclass': 0.682548725605011, 'labeldist': 0.8726562142372132}
 Best test accuracy:0.778. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:185 - Active clients:[ 6  9 42 60 43 50 12 26 61 77]:
 Training time:18.839 seconds
 server global model correct 7606
 Testing time:46.742 seconds
 avg_test_acc: {'uniform': 0.7605999708175659, 'validclass': 0.7605999708175659, 'labeldist': 0.7606000304222107}
 pfl_avg_test_acc: {'uniform': 0.5433600068092346, 'validclass': 0.6689688920974731, 'labeldist': 0.8474416911602021}
Round:186 - Active clients:[42 79 89 72 49  6 16 64 96 87]:
 Training time:17.461 seconds
 server global model correct 7734
 Testing time:46.357 seconds
 avg_test_acc: {'uniform': 0.7734000086784363, 'validclass': 0.7734000086784363, 'labeldist': 0.7734000086784363}
 pfl_avg_test_acc: {'uniform': 0.544010004401207, 'validclass': 0.6266586601734161, 'labeldist': 0.84262815117836}
Round:187 - Active clients:[92 29 94 81 27  4 65 32 41 12]:
 Training time:22.652 seconds
 server global model correct 7816
 Testing time:46.332 seconds
 avg_test_acc: {'uniform': 0.7815999984741211, 'validclass': 0.7815999984741211, 'labeldist': 0.7815999984741211}
 pfl_avg_test_acc: {'uniform': 0.5305699974298477, 'validclass': 0.6111514329910278, 'labeldist': 0.8676097691059113}
 Best test accuracy:0.782. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:188 - Active clients:[96 12 73 81  4 66 87 79 32 93]:
 Training time:14.609 seconds
 server global model correct 7812
 Testing time:46.543 seconds
 avg_test_acc: {'uniform': 0.7811999917030334, 'validclass': 0.7811999917030334, 'labeldist': 0.7811999917030334}
 pfl_avg_test_acc: {'uniform': 0.5388700008392334, 'validclass': 0.6413888841867447, 'labeldist': 0.8705788254737854}
Round:189 - Active clients:[27 49 43  4 14 89 52 98 41 22]:
 Training time:22.916 seconds
 server global model correct 7673
 Testing time:46.626 seconds
 avg_test_acc: {'uniform': 0.767300009727478, 'validclass': 0.767300009727478, 'labeldist': 0.767300009727478}
 pfl_avg_test_acc: {'uniform': 0.5917200028896332, 'validclass': 0.6494131684303284, 'labeldist': 0.8492506921291352}
Round:190 - Active clients:[62 72 26 47 41 60 28 45 91 79]:
 Training time:20.634 seconds
 server global model correct 7725
 Testing time:46.310 seconds
 avg_test_acc: {'uniform': 0.7724999785423279, 'validclass': 0.7724999785423279, 'labeldist': 0.7725000381469727}
 pfl_avg_test_acc: {'uniform': 0.5233599960803985, 'validclass': 0.6643688440322876, 'labeldist': 0.8551294386386872}
Round:191 - Active clients:[46 33  7 54 12 87 67 25  4 73]:
 Training time:18.147 seconds
 server global model correct 7700
 Testing time:46.367 seconds
 avg_test_acc: {'uniform': 0.7699999809265137, 'validclass': 0.7699999809265137, 'labeldist': 0.7699999809265137}
 pfl_avg_test_acc: {'uniform': 0.4702000066637993, 'validclass': 0.6831111133098602, 'labeldist': 0.8910994708538056}
Round:192 - Active clients:[70 11 84 47 76 15  5  4  6 65]:
 Training time:24.650 seconds
 server global model correct 7279
 Testing time:47.036 seconds
 avg_test_acc: {'uniform': 0.7279000282287598, 'validclass': 0.7279000282287598, 'labeldist': 0.7279000282287598}
 pfl_avg_test_acc: {'uniform': 0.4987900048494339, 'validclass': 0.6551617085933685, 'labeldist': 0.8537372827529908}
Round:193 - Active clients:[45 79 29 86 90 85  4 51 33 80]:
 Training time:23.187 seconds
 server global model correct 6952
 Testing time:47.261 seconds
 avg_test_acc: {'uniform': 0.6952000260353088, 'validclass': 0.6952000260353088, 'labeldist': 0.6952000260353088}
 pfl_avg_test_acc: {'uniform': 0.4850300014019012, 'validclass': 0.6622846007347107, 'labeldist': 0.8983781933784485}
Round:194 - Active clients:[10 62 25 13 35 90 83  6 46 75]:
 Training time:22.748 seconds
 server global model correct 7541
 Testing time:46.480 seconds
 avg_test_acc: {'uniform': 0.7541000247001648, 'validclass': 0.7541000247001648, 'labeldist': 0.75409996509552}
 pfl_avg_test_acc: {'uniform': 0.5037600010633468, 'validclass': 0.6402747213840485, 'labeldist': 0.8635514855384827}
Round:195 - Active clients:[50 90 24 77 39 32 76 60  2 51]:
 Training time:22.201 seconds
 server global model correct 7500
 Testing time:47.278 seconds
 avg_test_acc: {'uniform': 0.75, 'validclass': 0.75, 'labeldist': 0.75}
 pfl_avg_test_acc: {'uniform': 0.5365700006484986, 'validclass': 0.67615607380867, 'labeldist': 0.8822977840900421}
Round:196 - Active clients:[80 87 37 77  4 97 82 73 61 29]:
 Training time:17.008 seconds
 server global model correct 7623
 Testing time:47.296 seconds
 avg_test_acc: {'uniform': 0.7623000144958496, 'validclass': 0.7623000144958496, 'labeldist': 0.7622999548912048}
 pfl_avg_test_acc: {'uniform': 0.5357300102710724, 'validclass': 0.6474145114421844, 'labeldist': 0.8664291143417359}
Round:197 - Active clients:[82 16 28  0  8 70  4 13 32 11]:
 Training time:20.315 seconds
 server global model correct 7678
 Testing time:46.466 seconds
 avg_test_acc: {'uniform': 0.767799973487854, 'validclass': 0.767799973487854, 'labeldist': 0.7678000330924988}
 pfl_avg_test_acc: {'uniform': 0.5081999957561493, 'validclass': 0.6057683736085892, 'labeldist': 0.8593358397483826}
Round:198 - Active clients:[11 38 53 19 87 42 40 78 60 35]:
 Training time:22.200 seconds
 server global model correct 7658
 Testing time:46.431 seconds
 avg_test_acc: {'uniform': 0.7657999992370605, 'validclass': 0.7657999992370605, 'labeldist': 0.7657999992370605}
 pfl_avg_test_acc: {'uniform': 0.5514200061559678, 'validclass': 0.6675386130809784, 'labeldist': 0.8471524238586425}
Round:199 - Active clients:[51 87 30 25 49 57 37 52 56 29]:
 Training time:20.342 seconds
 server global model correct 7152
 Testing time:47.532 seconds
 avg_test_acc: {'uniform': 0.7152000069618225, 'validclass': 0.7152000069618225, 'labeldist': 0.7152000069618225}
 pfl_avg_test_acc: {'uniform': 0.4713400065898895, 'validclass': 0.6827047556638718, 'labeldist': 0.8718752801418305}
Round:200 - Active clients:[34  2 72 37 86 64 80 63  9 19]:
 Training time:24.821 seconds
 server global model correct 7651
 Testing time:46.456 seconds
 avg_test_acc: {'uniform': 0.7651000022888184, 'validclass': 0.7651000022888184, 'labeldist': 0.7651000618934631}
 pfl_avg_test_acc: {'uniform': 0.5040300041437149, 'validclass': 0.6962196469306946, 'labeldist': 0.8712559998035431}
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mgentle-cosmos-4[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/eba6p4oj[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250310_085906-eba6p4oj/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250310_144105-x2gpi5el
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run blooming-forest-6
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/x2gpi5el
results are saved in:  ./ICH_FedAvg/FedAvg_Cifar10_Conv2Cifar_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 147, in run
    clients_dict = setup_clients(ClientCstr, trainset, None, criterion,
  File "/media/data3/home/dungkt/FedNH/src/flbase/utils.py", line 64, in setup_clients
    trainset_per_client_dict, stats_dict = sampler(trainset, num_clients, partition, ylabels=trainset.targets,
  File "/media/data3/home/dungkt/FedNH/src/utils.py", line 258, in sampler
    assert num_classes == num_unique_class, f"num_classes is set to {num_classes}, but number of unique class detected in ylables are {num_unique_class}."
AssertionError: num_classes is set to 5, but number of unique class detected in ylables are 10.
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mblooming-forest-6[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/x2gpi5el[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250310_144105-x2gpi5el/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250310_150237-gosa5zqz
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run dashing-leaf-7
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/gosa5zqz
results are saved in:  ./ICH_FedAvg/FedAvg_ich_Conv2Cifar_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 143, in run
    trainset, testset, _ = get_datasets(server_config['dataset'])
  File "/media/data3/home/dungkt/FedNH/src/utils.py", line 1046, in get_datasets
    raise ValueError(f"Unrecognized dataset:{datasetname}")
ValueError: Unrecognized dataset:ich
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mdashing-leaf-7[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/gosa5zqz[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250310_150237-gosa5zqz/logs[0m
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 13, in <module>
    from src.flbase.utils import setup_clients, resume_training
  File "/media/data3/home/dungkt/FedNH/src/flbase/utils.py", line 6, in <module>
    from src.utils import sampler, sampler_reuse, DatasetSplit, setup_seed
  File "/media/data3/home/dungkt/FedNH/src/utils.py", line 20, in <module>
    from .all_datasets import ICH
  File "/media/data3/home/dungkt/FedNH/src/all_datasets.py", line 4, in <module>
    import pandas as pd
ModuleNotFoundError: No module named 'pandas'
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250311_164547-b3vror85
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run decent-cosmos-8
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/b3vror85
results are saved in:  ./ICH_FedAvg/FedAvg_ich_Conv2Cifar_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 143, in run
    trainset, testset, _ = get_datasets(server_config['dataset'])
  File "/media/data3/home/dungkt/FedNH/src/utils.py", line 1060, in get_datasets
    raise ValueError(f"Unrecognized dataset:{datasetname}")
ValueError: Unrecognized dataset:ich
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mdecent-cosmos-8[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/b3vror85[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250311_164547-b3vror85/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250311_181134-wpyfwy9g
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run genial-smoke-9
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/wpyfwy9g
results are saved in:  ./ICH_FedAvg/FedAvg_ICH_Conv2Cifar_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
ICH dataset dang su dung
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 143, in run
    trainset, testset, _ = get_datasets(server_config['dataset'])
  File "/media/data3/home/dungkt/FedNH/src/utils.py", line 1024, in get_datasets
    trainset = ICH(root, "train", train_transform)
  File "/media/data3/home/dungkt/FedNH/src/all_datasets.py", line 51, in __init__
    self.file = pd.read_csv(csv_file)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1026, in read_csv
    return _read(filepath_or_buffer, kwds)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 620, in _read
    parser = TextFileReader(filepath_or_buffer, **kwds)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1620, in __init__
    self._engine = self._make_engine(f, self.engine)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/pandas/io/parsers/readers.py", line 1880, in _make_engine
    self.handles = get_handle(
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/pandas/io/common.py", line 873, in get_handle
    handle = open(
FileNotFoundError: [Errno 2] No such file or directory: 'data/train_ICH.csv'
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mgenial-smoke-9[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/wpyfwy9g[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250311_181134-wpyfwy9g/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250311_191558-ztudr00h
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run colorful-leaf-10
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/ztudr00h
results are saved in:  ./ICH_FedAvg/FedAvg_ICH_Conv2Cifar_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
ICH dataset dang su dung
<src.all_datasets.ICH object at 0x7d55722df4f0>
<src.all_datasets.ICH object at 0x7d55722df520>
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 Warning: 2 clients have less than 2 classes
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 147, in run
    clients_dict = setup_clients(ClientCstr, trainset, None, criterion,
  File "/media/data3/home/dungkt/FedNH/src/flbase/utils.py", line 88, in setup_clients
    all_clients_dict[cid] = Client(
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 24, in __init__
    self._initialize_model()
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 30, in _initialize_model
    self.model = eval(self.client_config['model'])(self.client_config).to(self.device)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1343, in to
    return self._apply(convert)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 903, in _apply
    module._apply(fn)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1329, in convert
    return t.to(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 264.00 MiB. GPU 0 has a total capacity of 10.91 GiB of which 9.31 MiB is free. Process 4189 has 164.00 MiB memory in use. Process 4239 has 1.29 GiB memory in use. Including non-PyTorch memory, this process has 9.44 GiB memory in use. Of the allocated memory 9.31 GiB is allocated by PyTorch, and 2.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mcolorful-leaf-10[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/ztudr00h[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250311_191558-ztudr00h/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250311_192122-co25t4sy
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run valiant-serenity-11
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/co25t4sy
results are saved in:  ./ICH_FedAvg/FedAvg_ICH_Resnet_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
ICH dataset dang su dung
<src.all_datasets.ICH object at 0x750f6cd0b460>
<src.all_datasets.ICH object at 0x750f6cd0b490>
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 Warning: 2 clients have less than 2 classes
From FedAvg
Resnet{'model': 'Resnet', 'input_size': (3, 32, 32), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 147, in run
    clients_dict = setup_clients(ClientCstr, trainset, None, criterion,
  File "/media/data3/home/dungkt/FedNH/src/flbase/utils.py", line 88, in setup_clients
    all_clients_dict[cid] = Client(
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 24, in __init__
    self._initialize_model()
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 30, in _initialize_model
    self.model = eval(self.client_config['model'])(self.client_config).to(self.device)
  File "<string>", line 1, in <module>
NameError: name 'Resnet' is not defined
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mvaliant-serenity-11[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/co25t4sy[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250311_192122-co25t4sy/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250311_192248-2a0bh7g1
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run major-music-12
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/2a0bh7g1
results are saved in:  ./ICH_FedAvg/FedAvg_ICH_Resnet18_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
ICH dataset dang su dung
<src.all_datasets.ICH object at 0x7d13f67f3640>
<src.all_datasets.ICH object at 0x7d13f67f3670>
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 Warning: 2 clients have less than 2 classes
From FedAvg
Resnet18{'model': 'Resnet18', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 147, in run
    clients_dict = setup_clients(ClientCstr, trainset, None, criterion,
  File "/media/data3/home/dungkt/FedNH/src/flbase/utils.py", line 88, in setup_clients
    all_clients_dict[cid] = Client(
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 24, in __init__
    self._initialize_model()
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 30, in _initialize_model
    self.model = eval(self.client_config['model'])(self.client_config).to(self.device)
  File "<string>", line 1, in <module>
NameError: name 'Resnet18' is not defined
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mmajor-music-12[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/2a0bh7g1[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250311_192248-2a0bh7g1/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250311_214225-1tbgoj0i
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run sunny-bird-13
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/1tbgoj0i
results are saved in:  ./ICH_FedAvg/FedAvg_ICH_RestNet18_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
ICH dataset dang su dung
<src.all_datasets.ICH object at 0x709ea79ef6d0>
<src.all_datasets.ICH object at 0x709ea79ef700>
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 Warning: 2 clients have less than 2 classes
From FedAvg
RestNet18{'model': 'RestNet18', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 147, in run
    clients_dict = setup_clients(ClientCstr, trainset, None, criterion,
  File "/media/data3/home/dungkt/FedNH/src/flbase/utils.py", line 88, in setup_clients
    all_clients_dict[cid] = Client(
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 25, in __init__
    self._initialize_model()
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 31, in _initialize_model
    self.model = eval(self.client_config['model'])(self.client_config).to(self.device)
  File "<string>", line 1, in <module>
NameError: name 'RestNet18' is not defined
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33msunny-bird-13[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/1tbgoj0i[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250311_214225-1tbgoj0i/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250311_220404-j8jm889y
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run northern-cosmos-14
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/j8jm889y
results are saved in:  ./ICH_FedAvg/FedAvg_ICH_RestNet_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
ICH dataset dang su dung
<src.all_datasets.ICH object at 0x7fe2dcdf34c0>
<src.all_datasets.ICH object at 0x7fe2dcdf34f0>
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 Warning: 2 clients have less than 2 classes
From FedAvg
RestNet{'model': 'RestNet', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 147, in run
    clients_dict = setup_clients(ClientCstr, trainset, None, criterion,
  File "/media/data3/home/dungkt/FedNH/src/flbase/utils.py", line 88, in setup_clients
    all_clients_dict[cid] = Client(
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 25, in __init__
    self._initialize_model()
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 31, in _initialize_model
    self.model = eval(self.client_config['model'])(self.client_config).to(self.device)
  File "<string>", line 1, in <module>
NameError: name 'RestNet' is not defined
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mnorthern-cosmos-14[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/j8jm889y[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250311_220404-j8jm889y/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250311_232422-0uglze22
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run silver-violet-15
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/0uglze22
results are saved in:  ./ICH_FedAvg/FedAvg_ICH_Conv2Cifar_noniid-label-distribution_beta_0.3_num_clients_100_participate_ratio_0.1_global_seed_0_no_norm_False
ICH dataset dang su dung
<src.all_datasets.ICH object at 0x70134cd07430>
<src.all_datasets.ICH object at 0x70134cd07460>
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 [Info - Dirichlet Sampling]: At leaset one client only has one class label. Perform Resampling...
 Warning: 2 clients have less than 2 classes
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
From FedAvg
Conv2Cifar{'model': 'Conv2Cifar', 'input_size': (1, 224, 224), 'num_classes': 5, 'num_epochs': 5, 'batch_size': 64, 'optimizer': 'SGD', 'learning_rate': 0.1, 'lr_scheduler': 'stepwise', 'lr_decay_per_round': 0.99, 'num_rounds': 200, 'use_tqdm': False, 'FedROD_hyper_clf': True, 'FedROD_phead_separate': False, 'FedNH_return_embedding': False, 'FedNH_head_init': 'orthogonal', 'FedNH_client_adv_prototype_agg': False, 'FedNH_fix_scaling': False, 'FedProto_lambda': 0.1, 'FedRep_head_epochs': 10, 'FedBABU_finetune_epoch': 5, 'Ditto_lambda': 0.75, 'CReFF_batch_real': 64, 'global_seed': 0, 'client_lr': 0.01, 'client_lr_scheduler': 'diminishing', 'sgd_momentum': 0.9, 'sgd_weight_decay': 1e-05, 'use_sam': False, 'no_norm': False}
Traceback (most recent call last):
  File "/media/data3/home/dungkt/FedNH/main.py", line 251, in <module>
    run(args)
  File "/media/data3/home/dungkt/FedNH/main.py", line 147, in run
    clients_dict = setup_clients(ClientCstr, trainset, None, criterion,
  File "/media/data3/home/dungkt/FedNH/src/flbase/utils.py", line 88, in setup_clients
    all_clients_dict[cid] = Client(
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 25, in __init__
    self._initialize_model()
  File "/media/data3/home/dungkt/FedNH/src/flbase/strategies/FedAvg.py", line 31, in _initialize_model
    self.model = eval(self.client_config['model'])(self.client_config).to(self.device)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1343, in to
    return self._apply(convert)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 903, in _apply
    module._apply(fn)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 930, in _apply
    param_applied = fn(param)
  File "/media/data3/home/dungkt/FedNH/myenv/lib/python3.10/site-packages/torch/nn/modules/module.py", line 1329, in convert
    return t.to(
torch.OutOfMemoryError: CUDA out of memory. Tried to allocate 264.00 MiB. GPU 0 has a total capacity of 10.91 GiB of which 9.31 MiB is free. Process 4189 has 164.00 MiB memory in use. Process 4239 has 1.29 GiB memory in use. Including non-PyTorch memory, this process has 9.44 GiB memory in use. Of the allocated memory 9.31 GiB is allocated by PyTorch, and 2.47 MiB is reserved by PyTorch but unallocated. If reserved but unallocated memory is large try setting PYTORCH_CUDA_ALLOC_CONF=expandable_segments:True to avoid fragmentation.  See documentation for Memory Management  (https://pytorch.org/docs/stable/notes/cuda.html#environment-variables)
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33msilver-violet-15[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/0uglze22[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250311_232422-0uglze22/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250314_212017-z4pm6hg6
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run ricotta-tart-36
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/z4pm6hg6
results are saved in:  ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
============================================================Run Summary============================================================
Dataset:
 dataset:Cifar10 | num_classes:10 | partition:noniid-label-distribution | beta:0.3
Server Info:
 strategy:FedNH | num_clients:50 | num_rounds: 200 | participate_ratio:0.1 | drop_ratio:0.0
Clients Info:
 model:tumorModel_cifar10_data | num_epochs:5 | batch_size:64 | optimizer:SGD | inint lr:0.01 | lr scheduler:diminishing | momentum: 0.9 | weight decay: 1e-05
 tumorModel_cifar10_data: size:3.732 MB | num params: 0.933 M
FedUHServer: the following layers will not be updated: ['prototype']
Strategy Related Hyper-parameters:
 server side
  FedNH_smoothing _ 0.9
  FedNH_server_adv_prototype_agg _ False
 client side
  FedNH_return_embedding _ False
  FedNH_head_init _ orthogonal
  FedNH_client_adv_prototype_agg _ False
  FedNH_fix_scaling _ False
Round:1 - Active clients:[27 35 40 38  2]:
 Training time:33.080 seconds
 server global model correct 1938
 Testing time:25.434 seconds
 avg_test_acc: {'uniform': 0.19380000233650208, 'validclass': 0.19380000233650208, 'labeldist': 0.19380000233650208}
 pfl_avg_test_acc: {'uniform': 0.1936400055885315, 'validclass': 0.25059841573238373, 'labeldist': 0.656229555606842}
Round:2 - Active clients:[36 47 28  9 13]:
 Training time:22.896 seconds
 server global model correct 2187
 Testing time:25.476 seconds
 avg_test_acc: {'uniform': 0.21870000660419464, 'validclass': 0.21870000660419464, 'labeldist': 0.21870000660419464}
 pfl_avg_test_acc: {'uniform': 0.19039999842643737, 'validclass': 0.23233189880847932, 'labeldist': 0.7394668698310852}
 Best test accuracy:0.219. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:3 - Active clients:[12 39  9 47 31]:
 Training time:20.539 seconds
 server global model correct 2740
 Testing time:26.040 seconds
 avg_test_acc: {'uniform': 0.27399998903274536, 'validclass': 0.27399998903274536, 'labeldist': 0.27399998903274536}
 pfl_avg_test_acc: {'uniform': 0.24731999933719634, 'validclass': 0.2766066640615463, 'labeldist': 0.6689605474472046}
 Best test accuracy:0.274. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:4 - Active clients:[ 6 48 11  4 12]:
 Training time:23.311 seconds
 server global model correct 3393
 Testing time:25.456 seconds
 avg_test_acc: {'uniform': 0.3393000066280365, 'validclass': 0.3393000066280365, 'labeldist': 0.3393000066280365}
 pfl_avg_test_acc: {'uniform': 0.24754000306129456, 'validclass': 0.3203642874956131, 'labeldist': 0.6586040735244751}
 Best test accuracy:0.339. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:5 - Active clients:[42 29  6 19 28]:
 Training time:22.893 seconds
 server global model correct 3911
 Testing time:26.315 seconds
 avg_test_acc: {'uniform': 0.3910999894142151, 'validclass': 0.3910999894142151, 'labeldist': 0.39110004901885986}
 pfl_avg_test_acc: {'uniform': 0.24198000133037567, 'validclass': 0.3450492858886719, 'labeldist': 0.7242948293685914}
 Best test accuracy:0.391. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:6 - Active clients:[49 40 38 23  7]:
 Training time:19.422 seconds
 server global model correct 2757
 Testing time:26.383 seconds
 avg_test_acc: {'uniform': 0.27570000290870667, 'validclass': 0.27570000290870667, 'labeldist': 0.27570000290870667}
 pfl_avg_test_acc: {'uniform': 0.21225999891757966, 'validclass': 0.2918482571840286, 'labeldist': 0.7136626601219177}
Round:7 - Active clients:[13 15 22 42 30]:
 Training time:20.163 seconds
 server global model correct 3169
 Testing time:26.084 seconds
 avg_test_acc: {'uniform': 0.31690001487731934, 'validclass': 0.31690001487731934, 'labeldist': 0.31689998507499695}
 pfl_avg_test_acc: {'uniform': 0.23895999491214753, 'validclass': 0.32601499259471894, 'labeldist': 0.7986286997795105}
Round:8 - Active clients:[44 49 36 23 48]:
 Training time:22.445 seconds
 server global model correct 2747
 Testing time:25.505 seconds
 avg_test_acc: {'uniform': 0.27469998598098755, 'validclass': 0.27469998598098755, 'labeldist': 0.27469998598098755}
 pfl_avg_test_acc: {'uniform': 0.21414000391960145, 'validclass': 0.29714754819869993, 'labeldist': 0.7373617768287659}
Round:9 - Active clients:[21 37  2 14 44]:
 Training time:22.010 seconds
 server global model correct 2623
 Testing time:25.487 seconds
 avg_test_acc: {'uniform': 0.2623000144958496, 'validclass': 0.2623000144958496, 'labeldist': 0.2622999846935272}
 pfl_avg_test_acc: {'uniform': 0.2180400013923645, 'validclass': 0.357021102309227, 'labeldist': 0.7475099086761474}
Round:10 - Active clients:[37 23 44 42 47]:
 Training time:25.498 seconds
 server global model correct 3957
 Testing time:26.122 seconds
 avg_test_acc: {'uniform': 0.39570000767707825, 'validclass': 0.39570000767707825, 'labeldist': 0.39570000767707825}
 pfl_avg_test_acc: {'uniform': 0.2534199982881546, 'validclass': 0.4195122241973877, 'labeldist': 0.7492323756217957}
 Best test accuracy:0.396. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:11 - Active clients:[37 45 36 22  2]:
 Training time:21.122 seconds
 server global model correct 4215
 Testing time:25.537 seconds
 avg_test_acc: {'uniform': 0.42149999737739563, 'validclass': 0.42149999737739563, 'labeldist': 0.42149999737739563}
 pfl_avg_test_acc: {'uniform': 0.23090000152587892, 'validclass': 0.35403889417648315, 'labeldist': 0.7610509395599365}
 Best test accuracy:0.421. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:12 - Active clients:[28 46  7 41 36]:
 Training time:21.232 seconds
 server global model correct 4815
 Testing time:25.545 seconds
 avg_test_acc: {'uniform': 0.4814999997615814, 'validclass': 0.4814999997615814, 'labeldist': 0.4814999997615814}
 pfl_avg_test_acc: {'uniform': 0.2443000018596649, 'validclass': 0.34616547226905825, 'labeldist': 0.7389138817787171}
 Best test accuracy:0.481. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:13 - Active clients:[43  4 20 46  0]:
 Training time:22.339 seconds
 server global model correct 4034
 Testing time:25.587 seconds
 avg_test_acc: {'uniform': 0.4034000039100647, 'validclass': 0.4034000039100647, 'labeldist': 0.4034000337123871}
 pfl_avg_test_acc: {'uniform': 0.30822000503540037, 'validclass': 0.48378332853317263, 'labeldist': 0.7951015591621399}
Round:14 - Active clients:[47 21 14 30 37]:
 Training time:20.030 seconds
 server global model correct 3235
 Testing time:26.096 seconds
 avg_test_acc: {'uniform': 0.32350000739097595, 'validclass': 0.32350000739097595, 'labeldist': 0.32350000739097595}
 pfl_avg_test_acc: {'uniform': 0.2802200049161911, 'validclass': 0.3922661244869232, 'labeldist': 0.7798646211624145}
Round:15 - Active clients:[35 37 41 26 38]:
 Training time:29.005 seconds
 server global model correct 3458
 Testing time:25.548 seconds
 avg_test_acc: {'uniform': 0.3458000123500824, 'validclass': 0.3458000123500824, 'labeldist': 0.3458000123500824}
 pfl_avg_test_acc: {'uniform': 0.2532399982213974, 'validclass': 0.44831952452659607, 'labeldist': 0.7880903720855713}
Round:16 - Active clients:[ 3 34 25 36 20]:
 Training time:24.566 seconds
 server global model correct 3959
 Testing time:25.588 seconds
 avg_test_acc: {'uniform': 0.39590001106262207, 'validclass': 0.39590001106262207, 'labeldist': 0.3958999812602997}
 pfl_avg_test_acc: {'uniform': 0.25843999683856966, 'validclass': 0.46295318603515623, 'labeldist': 0.825835132598877}
Round:17 - Active clients:[44 16 21 42 19]:
 Training time:19.290 seconds
 server global model correct 3958
 Testing time:25.551 seconds
 avg_test_acc: {'uniform': 0.39579999446868896, 'validclass': 0.39579999446868896, 'labeldist': 0.39580002427101135}
 pfl_avg_test_acc: {'uniform': 0.278999999165535, 'validclass': 0.389562776684761, 'labeldist': 0.759446120262146}
Round:18 - Active clients:[43 16 26 30 20]:
 Training time:18.874 seconds
 server global model correct 4504
 Testing time:25.509 seconds
 avg_test_acc: {'uniform': 0.4503999948501587, 'validclass': 0.4503999948501587, 'labeldist': 0.4504000246524811}
 pfl_avg_test_acc: {'uniform': 0.32008000612258913, 'validclass': 0.39464778304100034, 'labeldist': 0.8188410997390747}
Round:19 - Active clients:[24 23 35 30 26]:
 Training time:22.393 seconds
 server global model correct 4302
 Testing time:25.482 seconds
 avg_test_acc: {'uniform': 0.4302000105381012, 'validclass': 0.4302000105381012, 'labeldist': 0.4302000105381012}
 pfl_avg_test_acc: {'uniform': 0.3042599976062775, 'validclass': 0.3947912633419037, 'labeldist': 0.8394400477409363}
Round:20 - Active clients:[12 14  4  8 45]:
 Training time:15.398 seconds
 server global model correct 4610
 Testing time:25.570 seconds
 avg_test_acc: {'uniform': 0.460999995470047, 'validclass': 0.460999995470047, 'labeldist': 0.460999995470047}
 pfl_avg_test_acc: {'uniform': 0.3047400027513504, 'validclass': 0.4028833329677582, 'labeldist': 0.8115837693214416}
Round:21 - Active clients:[ 7 44 43 25 14]:
 Training time:16.422 seconds
 server global model correct 4609
 Testing time:25.479 seconds
 avg_test_acc: {'uniform': 0.4609000086784363, 'validclass': 0.4609000086784363, 'labeldist': 0.46090003848075867}
 pfl_avg_test_acc: {'uniform': 0.2517599999904633, 'validclass': 0.4610399901866913, 'labeldist': 0.7333804488182067}
Round:22 - Active clients:[32 12 25 47 33]:
 Training time:24.305 seconds
 server global model correct 4728
 Testing time:25.806 seconds
 avg_test_acc: {'uniform': 0.47279998660087585, 'validclass': 0.47279998660087585, 'labeldist': 0.47279998660087585}
 pfl_avg_test_acc: {'uniform': 0.3724000036716461, 'validclass': 0.5663861751556396, 'labeldist': 0.7707852125167847}
Round:23 - Active clients:[14 18 17 32 13]:
 Training time:18.017 seconds
 server global model correct 3981
 Testing time:25.650 seconds
 avg_test_acc: {'uniform': 0.39809998869895935, 'validclass': 0.39809998869895935, 'labeldist': 0.39810001850128174}
 pfl_avg_test_acc: {'uniform': 0.32152000069618225, 'validclass': 0.41353928446769717, 'labeldist': 0.7098815083503723}
Round:24 - Active clients:[ 8  5 32 26 19]:
 Training time:20.435 seconds
 server global model correct 4160
 Testing time:25.569 seconds
 avg_test_acc: {'uniform': 0.41600000858306885, 'validclass': 0.41600000858306885, 'labeldist': 0.41600003838539124}
 pfl_avg_test_acc: {'uniform': 0.3293799996376038, 'validclass': 0.43781666159629823, 'labeldist': 0.7957715630531311}
Round:25 - Active clients:[36 46  7 41 17]:
 Training time:16.737 seconds
 server global model correct 5167
 Testing time:25.728 seconds
 avg_test_acc: {'uniform': 0.516700029373169, 'validclass': 0.516700029373169, 'labeldist': 0.516700029373169}
 pfl_avg_test_acc: {'uniform': 0.3106999933719635, 'validclass': 0.4157595276832581, 'labeldist': 0.7736372828483582}
 Best test accuracy:0.517. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:26 - Active clients:[ 2 43 10 14 44]:
 Training time:24.839 seconds
 server global model correct 4724
 Testing time:25.830 seconds
 avg_test_acc: {'uniform': 0.4724000096321106, 'validclass': 0.4724000096321106, 'labeldist': 0.4724000096321106}
 pfl_avg_test_acc: {'uniform': 0.3185599982738495, 'validclass': 0.49527000784873965, 'labeldist': 0.7838649392127991}
Round:27 - Active clients:[14 20 46 43  6]:
 Training time:24.245 seconds
 server global model correct 5463
 Testing time:25.616 seconds
 avg_test_acc: {'uniform': 0.5462999939918518, 'validclass': 0.5462999939918518, 'labeldist': 0.5462999939918518}
 pfl_avg_test_acc: {'uniform': 0.3714399993419647, 'validclass': 0.4526777803897858, 'labeldist': 0.8277610540390015}
 Best test accuracy:0.546. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:28 - Active clients:[11 16  9 31 27]:
 Training time:23.693 seconds
 server global model correct 5883
 Testing time:26.147 seconds
 avg_test_acc: {'uniform': 0.5882999897003174, 'validclass': 0.5882999897003174, 'labeldist': 0.5882999897003174}
 pfl_avg_test_acc: {'uniform': 0.3970600008964539, 'validclass': 0.4558634877204895, 'labeldist': 0.8057955980300904}
 Best test accuracy:0.588. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:29 - Active clients:[35 26 45 48 22]:
 Training time:23.557 seconds
 server global model correct 4875
 Testing time:25.649 seconds
 avg_test_acc: {'uniform': 0.48750001192092896, 'validclass': 0.48750001192092896, 'labeldist': 0.48750001192092896}
 pfl_avg_test_acc: {'uniform': 0.33863999843597414, 'validclass': 0.4458646774291992, 'labeldist': 0.7826694130897522}
Round:30 - Active clients:[41 20 32 43 10]:
 Training time:26.054 seconds
 server global model correct 5368
 Testing time:25.641 seconds
 avg_test_acc: {'uniform': 0.5368000268936157, 'validclass': 0.5368000268936157, 'labeldist': 0.536799967288971}
 pfl_avg_test_acc: {'uniform': 0.3516600012779236, 'validclass': 0.5093357145786286, 'labeldist': 0.8070726037025452}
Round:31 - Active clients:[32  4  5 31  2]:
 Training time:21.455 seconds
 server global model correct 5857
 Testing time:25.590 seconds
 avg_test_acc: {'uniform': 0.5856999754905701, 'validclass': 0.5856999754905701, 'labeldist': 0.5857000350952148}
 pfl_avg_test_acc: {'uniform': 0.36543999910354613, 'validclass': 0.4293594479560852, 'labeldist': 0.8048296570777893}
Round:32 - Active clients:[49 16 41 35 44]:
 Training time:27.422 seconds
 server global model correct 4977
 Testing time:25.607 seconds
 avg_test_acc: {'uniform': 0.4977000057697296, 'validclass': 0.4977000057697296, 'labeldist': 0.4977000057697296}
 pfl_avg_test_acc: {'uniform': 0.34158000349998474, 'validclass': 0.4669885694980621, 'labeldist': 0.8228215098381042}
Round:33 - Active clients:[ 5 27 37 15 40]:
 Training time:25.265 seconds
 server global model correct 5092
 Testing time:25.575 seconds
 avg_test_acc: {'uniform': 0.5091999769210815, 'validclass': 0.5091999769210815, 'labeldist': 0.5092000365257263}
 pfl_avg_test_acc: {'uniform': 0.37342000007629395, 'validclass': 0.4825244426727295, 'labeldist': 0.8429987311363221}
Round:34 - Active clients:[16 39  1  3  0]:
 Training time:19.060 seconds
 server global model correct 6017
 Testing time:26.082 seconds
 avg_test_acc: {'uniform': 0.6017000079154968, 'validclass': 0.6017000079154968, 'labeldist': 0.6017000079154968}
 pfl_avg_test_acc: {'uniform': 0.4180600047111511, 'validclass': 0.5967634975910187, 'labeldist': 0.8219764351844787}
 Best test accuracy:0.602. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:35 - Active clients:[39 26 22 31 29]:
 Training time:16.955 seconds
 server global model correct 5589
 Testing time:25.576 seconds
 avg_test_acc: {'uniform': 0.558899998664856, 'validclass': 0.558899998664856, 'labeldist': 0.5588999390602112}
 pfl_avg_test_acc: {'uniform': 0.3888800024986267, 'validclass': 0.47180832624435426, 'labeldist': 0.8164775848388672}
Round:36 - Active clients:[29 11 18 32 12]:
 Training time:21.762 seconds
 server global model correct 5996
 Testing time:25.824 seconds
 avg_test_acc: {'uniform': 0.5996000170707703, 'validclass': 0.5996000170707703, 'labeldist': 0.5996000170707703}
 pfl_avg_test_acc: {'uniform': 0.42565999627113343, 'validclass': 0.559289276599884, 'labeldist': 0.7665355920791626}
Round:37 - Active clients:[49 37 13  0 41]:
 Training time:26.042 seconds
 server global model correct 4946
 Testing time:25.572 seconds
 avg_test_acc: {'uniform': 0.49459999799728394, 'validclass': 0.49459999799728394, 'labeldist': 0.4946000576019287}
 pfl_avg_test_acc: {'uniform': 0.31413999795913694, 'validclass': 0.5994999945163727, 'labeldist': 0.8621463298797607}
Round:38 - Active clients:[29 17  0 21 40]:
 Training time:16.343 seconds
 server global model correct 5989
 Testing time:25.629 seconds
 avg_test_acc: {'uniform': 0.5989000201225281, 'validclass': 0.5989000201225281, 'labeldist': 0.5989000201225281}
 pfl_avg_test_acc: {'uniform': 0.37624000310897826, 'validclass': 0.5459233343601226, 'labeldist': 0.8410616040229797}
Round:39 - Active clients:[ 2 23 47 16 29]:
 Training time:22.707 seconds
 server global model correct 6231
 Testing time:25.587 seconds
 avg_test_acc: {'uniform': 0.6230999827384949, 'validclass': 0.6230999827384949, 'labeldist': 0.6230999827384949}
 pfl_avg_test_acc: {'uniform': 0.4316399931907654, 'validclass': 0.4770061016082764, 'labeldist': 0.8130079865455627}
 Best test accuracy:0.623. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:40 - Active clients:[33 29 49 38 45]:
 Training time:18.919 seconds
 server global model correct 5144
 Testing time:25.617 seconds
 avg_test_acc: {'uniform': 0.5144000053405762, 'validclass': 0.5144000053405762, 'labeldist': 0.5144000053405762}
 pfl_avg_test_acc: {'uniform': 0.34472000002861025, 'validclass': 0.4836750030517578, 'labeldist': 0.790579092502594}
Round:41 - Active clients:[49 18  9 14 32]:
 Training time:20.421 seconds
 server global model correct 5753
 Testing time:25.621 seconds
 avg_test_acc: {'uniform': 0.5752999782562256, 'validclass': 0.5752999782562256, 'labeldist': 0.5753000378608704}
 pfl_avg_test_acc: {'uniform': 0.372680002450943, 'validclass': 0.47538134455680847, 'labeldist': 0.8209633827209473}
Round:42 - Active clients:[13 39 30 45 17]:
 Training time:12.036 seconds
 server global model correct 5931
 Testing time:25.525 seconds
 avg_test_acc: {'uniform': 0.5931000113487244, 'validclass': 0.5931000113487244, 'labeldist': 0.5931000113487244}
 pfl_avg_test_acc: {'uniform': 0.39129999876022337, 'validclass': 0.469691663980484, 'labeldist': 0.8286778211593628}
Round:43 - Active clients:[19 36 28 14 20]:
 Training time:18.853 seconds
 server global model correct 6099
 Testing time:25.607 seconds
 avg_test_acc: {'uniform': 0.6098999977111816, 'validclass': 0.6098999977111816, 'labeldist': 0.6098999977111816}
 pfl_avg_test_acc: {'uniform': 0.40378000140190123, 'validclass': 0.5090377032756805, 'labeldist': 0.8482357263565063}
Round:44 - Active clients:[37  6 47 36  5]:
 Training time:24.538 seconds
 server global model correct 5891
 Testing time:25.574 seconds
 avg_test_acc: {'uniform': 0.5891000032424927, 'validclass': 0.5891000032424927, 'labeldist': 0.5891000032424927}
 pfl_avg_test_acc: {'uniform': 0.41540000438690183, 'validclass': 0.5561707139015197, 'labeldist': 0.831292736530304}
Round:45 - Active clients:[47  7  2  9  5]:
 Training time:19.808 seconds
 server global model correct 6559
 Testing time:26.124 seconds
 avg_test_acc: {'uniform': 0.6559000015258789, 'validclass': 0.6559000015258789, 'labeldist': 0.6559000015258789}
 pfl_avg_test_acc: {'uniform': 0.41977999806404115, 'validclass': 0.4785472214221954, 'labeldist': 0.8251566290855408}
 Best test accuracy:0.656. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:46 - Active clients:[ 9 14  3 35 10]:
 Training time:25.095 seconds
 server global model correct 6133
 Testing time:25.587 seconds
 avg_test_acc: {'uniform': 0.6133000254631042, 'validclass': 0.6133000254631042, 'labeldist': 0.6132999658584595}
 pfl_avg_test_acc: {'uniform': 0.37529999315738677, 'validclass': 0.5162047505378723, 'labeldist': 0.8121730566024781}
Round:47 - Active clients:[40 42 32 13 39]:
 Training time:21.056 seconds
 server global model correct 5458
 Testing time:25.570 seconds
 avg_test_acc: {'uniform': 0.545799970626831, 'validclass': 0.545799970626831, 'labeldist': 0.545799970626831}
 pfl_avg_test_acc: {'uniform': 0.41895999312400817, 'validclass': 0.5229877829551697, 'labeldist': 0.8467179775238037}
Round:48 - Active clients:[ 8  3 45  1 47]:
 Training time:20.425 seconds
 server global model correct 5679
 Testing time:25.558 seconds
 avg_test_acc: {'uniform': 0.5679000020027161, 'validclass': 0.5679000020027161, 'labeldist': 0.5679000020027161}
 pfl_avg_test_acc: {'uniform': 0.4111400008201599, 'validclass': 0.5041323900222778, 'labeldist': 0.831010890007019}
Round:49 - Active clients:[25 31 39 16 14]:
 Training time:16.842 seconds
 server global model correct 5830
 Testing time:25.587 seconds
 avg_test_acc: {'uniform': 0.5830000042915344, 'validclass': 0.5830000042915344, 'labeldist': 0.5830000042915344}
 pfl_avg_test_acc: {'uniform': 0.43632000088691714, 'validclass': 0.5999588966369629, 'labeldist': 0.8568454265594483}
Round:50 - Active clients:[34 36  1 38  8]:
 Training time:26.333 seconds
 server global model correct 5165
 Testing time:25.600 seconds
 avg_test_acc: {'uniform': 0.5164999961853027, 'validclass': 0.5164999961853027, 'labeldist': 0.5165000557899475}
 pfl_avg_test_acc: {'uniform': 0.29855999648571013, 'validclass': 0.5031057178974152, 'labeldist': 0.8763099670410156}
Round:51 - Active clients:[ 4 48 47 15  0]:
 Training time:23.112 seconds
 server global model correct 5935
 Testing time:25.564 seconds
 avg_test_acc: {'uniform': 0.593500018119812, 'validclass': 0.593500018119812, 'labeldist': 0.593500018119812}
 pfl_avg_test_acc: {'uniform': 0.4109800040721893, 'validclass': 0.5860183358192443, 'labeldist': 0.8591298699378968}
Round:52 - Active clients:[19  3 26 40  8]:
 Training time:20.358 seconds
 server global model correct 6154
 Testing time:25.580 seconds
 avg_test_acc: {'uniform': 0.6154000163078308, 'validclass': 0.6154000163078308, 'labeldist': 0.6154000163078308}
 pfl_avg_test_acc: {'uniform': 0.4284999966621399, 'validclass': 0.5484061121940613, 'labeldist': 0.8481235265731811}
Round:53 - Active clients:[ 1  2 28 21  8]:
 Training time:25.147 seconds
 server global model correct 6165
 Testing time:25.579 seconds
 avg_test_acc: {'uniform': 0.6165000200271606, 'validclass': 0.6165000200271606, 'labeldist': 0.6165000200271606}
 pfl_avg_test_acc: {'uniform': 0.37874000072479247, 'validclass': 0.5074805557727814, 'labeldist': 0.8938165426254272}
Round:54 - Active clients:[10 49 24 39 38]:
 Training time:22.476 seconds
 server global model correct 5632
 Testing time:25.723 seconds
 avg_test_acc: {'uniform': 0.5631999969482422, 'validclass': 0.5631999969482422, 'labeldist': 0.5631999969482422}
 pfl_avg_test_acc: {'uniform': 0.3966399967670441, 'validclass': 0.5743446052074432, 'labeldist': 0.8026220917701721}
Round:55 - Active clients:[ 3 22 28 15  6]:
 Training time:24.183 seconds
 server global model correct 6295
 Testing time:25.586 seconds
 avg_test_acc: {'uniform': 0.6294999718666077, 'validclass': 0.6294999718666077, 'labeldist': 0.6294999718666077}
 pfl_avg_test_acc: {'uniform': 0.4610999941825867, 'validclass': 0.5414385020732879, 'labeldist': 0.859783661365509}
Round:56 - Active clients:[45 40 38  7 20]:
 Training time:15.927 seconds
 server global model correct 6663
 Testing time:25.639 seconds
 avg_test_acc: {'uniform': 0.6662999987602234, 'validclass': 0.6662999987602234, 'labeldist': 0.6662999987602234}
 pfl_avg_test_acc: {'uniform': 0.4375799983739853, 'validclass': 0.5200916647911071, 'labeldist': 0.7956100702285767}
 Best test accuracy:0.666. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:57 - Active clients:[29 20 16  9 39]:
 Training time:16.376 seconds
 server global model correct 6967
 Testing time:25.696 seconds
 avg_test_acc: {'uniform': 0.6966999769210815, 'validclass': 0.6966999769210815, 'labeldist': 0.6967000961303711}
 pfl_avg_test_acc: {'uniform': 0.5061199963092804, 'validclass': 0.548294460773468, 'labeldist': 0.8358468413352966}
 Best test accuracy:0.697. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:58 - Active clients:[48 18  5 47 16]:
 Training time:24.460 seconds
 server global model correct 6573
 Testing time:25.617 seconds
 avg_test_acc: {'uniform': 0.6572999954223633, 'validclass': 0.6572999954223633, 'labeldist': 0.6573000550270081}
 pfl_avg_test_acc: {'uniform': 0.5028800010681153, 'validclass': 0.56017284989357, 'labeldist': 0.8082319498062134}
Round:59 - Active clients:[32 21 48 47  1]:
 Training time:24.745 seconds
 server global model correct 6747
 Testing time:25.559 seconds
 avg_test_acc: {'uniform': 0.6747000217437744, 'validclass': 0.6747000217437744, 'labeldist': 0.6746999621391296}
 pfl_avg_test_acc: {'uniform': 0.44568000435829164, 'validclass': 0.5067191243171691, 'labeldist': 0.8161439776420594}
Round:60 - Active clients:[38 20  4 28 40]:
 Training time:21.784 seconds
 server global model correct 6954
 Testing time:25.577 seconds
 avg_test_acc: {'uniform': 0.6953999996185303, 'validclass': 0.6953999996185303, 'labeldist': 0.695400059223175}
 pfl_avg_test_acc: {'uniform': 0.45406000018119813, 'validclass': 0.5566877007484436, 'labeldist': 0.8508179187774658}
Round:61 - Active clients:[ 7 22 41 29 48]:
 Training time:17.749 seconds
 server global model correct 6393
 Testing time:25.559 seconds
 avg_test_acc: {'uniform': 0.6392999887466431, 'validclass': 0.6392999887466431, 'labeldist': 0.6392999887466431}
 pfl_avg_test_acc: {'uniform': 0.4284399926662445, 'validclass': 0.509248799085617, 'labeldist': 0.7901468515396118}
Round:62 - Active clients:[39 15  4 48 31]:
 Training time:19.636 seconds
 server global model correct 6632
 Testing time:27.140 seconds
 avg_test_acc: {'uniform': 0.6632000207901001, 'validclass': 0.6632000207901001, 'labeldist': 0.6632000207901001}
 pfl_avg_test_acc: {'uniform': 0.49277999997138977, 'validclass': 0.5534111201763153, 'labeldist': 0.8568914413452149}
Round:63 - Active clients:[ 8 36 47 16 31]:
 Training time:22.883 seconds
 server global model correct 6870
 Testing time:27.251 seconds
 avg_test_acc: {'uniform': 0.6869999766349792, 'validclass': 0.6869999766349792, 'labeldist': 0.687000036239624}
 pfl_avg_test_acc: {'uniform': 0.49007999897003174, 'validclass': 0.5717384099960328, 'labeldist': 0.8695275902748107}
Round:64 - Active clients:[ 9  1 33 37 13]:
 Training time:23.949 seconds
 server global model correct 6380
 Testing time:26.113 seconds
 avg_test_acc: {'uniform': 0.6380000114440918, 'validclass': 0.6380000114440918, 'labeldist': 0.6380000114440918}
 pfl_avg_test_acc: {'uniform': 0.41584000587463377, 'validclass': 0.5982273817062378, 'labeldist': 0.8689755797386169}
Round:65 - Active clients:[41 17 20 45 23]:
 Training time:16.563 seconds
 server global model correct 7207
 Testing time:25.857 seconds
 avg_test_acc: {'uniform': 0.7207000255584717, 'validclass': 0.7207000255584717, 'labeldist': 0.7207000255584717}
 pfl_avg_test_acc: {'uniform': 0.42932000756263733, 'validclass': 0.49827142953872683, 'labeldist': 0.8465755820274353}
 Best test accuracy:0.721. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:66 - Active clients:[ 4 47 25  5  1]:
 Training time:20.947 seconds
 server global model correct 6518
 Testing time:26.399 seconds
 avg_test_acc: {'uniform': 0.6517999768257141, 'validclass': 0.6517999768257141, 'labeldist': 0.6517999768257141}
 pfl_avg_test_acc: {'uniform': 0.4470600068569183, 'validclass': 0.6251992821693421, 'labeldist': 0.8542751431465149}
Round:67 - Active clients:[ 6  1 20 15 11]:
 Training time:25.986 seconds
 server global model correct 6760
 Testing time:26.179 seconds
 avg_test_acc: {'uniform': 0.6759999990463257, 'validclass': 0.6759999990463257, 'labeldist': 0.6759999990463257}
 pfl_avg_test_acc: {'uniform': 0.470580005645752, 'validclass': 0.5722428560256958, 'labeldist': 0.8756940603256226}
Round:68 - Active clients:[18 41 30  3 37]:
 Training time:21.990 seconds
 server global model correct 6857
 Testing time:25.649 seconds
 avg_test_acc: {'uniform': 0.685699999332428, 'validclass': 0.685699999332428, 'labeldist': 0.685699999332428}
 pfl_avg_test_acc: {'uniform': 0.45598000288009644, 'validclass': 0.6518785774707794, 'labeldist': 0.8629323482513428}
Round:69 - Active clients:[ 4 34 10 19  8]:
 Training time:25.969 seconds
 server global model correct 6385
 Testing time:25.596 seconds
 avg_test_acc: {'uniform': 0.6384999752044678, 'validclass': 0.6384999752044678, 'labeldist': 0.638499915599823}
 pfl_avg_test_acc: {'uniform': 0.3970200061798096, 'validclass': 0.6399333238601684, 'labeldist': 0.8577733993530273}
Round:70 - Active clients:[19 47 40 30 38]:
 Training time:21.820 seconds
 server global model correct 7104
 Testing time:25.567 seconds
 avg_test_acc: {'uniform': 0.7103999853134155, 'validclass': 0.7103999853134155, 'labeldist': 0.7104001045227051}
 pfl_avg_test_acc: {'uniform': 0.460999995470047, 'validclass': 0.5336100041866303, 'labeldist': 0.8297482490539551}
Round:71 - Active clients:[32 39  4 35 20]:
 Training time:22.070 seconds
 server global model correct 6879
 Testing time:25.844 seconds
 avg_test_acc: {'uniform': 0.6879000067710876, 'validclass': 0.6879000067710876, 'labeldist': 0.6878999471664429}
 pfl_avg_test_acc: {'uniform': 0.4869000017642975, 'validclass': 0.5842071413993836, 'labeldist': 0.8435052156448364}
Round:72 - Active clients:[48 22  4 11 49]:
 Training time:21.917 seconds
 server global model correct 5992
 Testing time:25.570 seconds
 avg_test_acc: {'uniform': 0.5992000102996826, 'validclass': 0.5992000102996826, 'labeldist': 0.5992000102996826}
 pfl_avg_test_acc: {'uniform': 0.4409400045871735, 'validclass': 0.5573738098144532, 'labeldist': 0.8315651178359985}
Round:73 - Active clients:[28 20 49 34 32]:
 Training time:30.100 seconds
 server global model correct 5274
 Testing time:26.384 seconds
 avg_test_acc: {'uniform': 0.527400016784668, 'validclass': 0.527400016784668, 'labeldist': 0.5273999571800232}
 pfl_avg_test_acc: {'uniform': 0.41524000763893126, 'validclass': 0.5600670576095581, 'labeldist': 0.8818885326385498}
Round:74 - Active clients:[22 16 26  8 32]:
 Training time:21.313 seconds
 server global model correct 6637
 Testing time:25.612 seconds
 avg_test_acc: {'uniform': 0.6636999845504761, 'validclass': 0.6636999845504761, 'labeldist': 0.6636999845504761}
 pfl_avg_test_acc: {'uniform': 0.44692000150680544, 'validclass': 0.5486266732215881, 'labeldist': 0.8608013153076172}
Round:75 - Active clients:[ 4  2 15 22  5]:
 Training time:21.202 seconds
 server global model correct 6772
 Testing time:26.149 seconds
 avg_test_acc: {'uniform': 0.6772000193595886, 'validclass': 0.6772000193595886, 'labeldist': 0.6772000193595886}
 pfl_avg_test_acc: {'uniform': 0.48720000982284545, 'validclass': 0.5507938802242279, 'labeldist': 0.877208125591278}
Round:76 - Active clients:[41 45 49  9 47]:
 Training time:22.323 seconds
 server global model correct 6217
 Testing time:25.850 seconds
 avg_test_acc: {'uniform': 0.6216999888420105, 'validclass': 0.6216999888420105, 'labeldist': 0.6216999888420105}
 pfl_avg_test_acc: {'uniform': 0.43133999705314635, 'validclass': 0.5054385662078857, 'labeldist': 0.8602871298789978}
Round:77 - Active clients:[16 40 13 45 38]:
 Training time:19.771 seconds
 server global model correct 6951
 Testing time:25.797 seconds
 avg_test_acc: {'uniform': 0.6951000094413757, 'validclass': 0.6951000094413757, 'labeldist': 0.6951000094413757}
 pfl_avg_test_acc: {'uniform': 0.4675200045108795, 'validclass': 0.5340849995613098, 'labeldist': 0.8419806241989136}
Round:78 - Active clients:[19 33 37 26 10]:
 Training time:24.876 seconds
 server global model correct 5755
 Testing time:26.924 seconds
 avg_test_acc: {'uniform': 0.5755000114440918, 'validclass': 0.5755000114440918, 'labeldist': 0.5755000710487366}
 pfl_avg_test_acc: {'uniform': 0.4036400020122528, 'validclass': 0.6973023891448975, 'labeldist': 0.8538238763809204}
Round:79 - Active clients:[39 44 21 42 48]:
 Training time:20.534 seconds
 server global model correct 6907
 Testing time:26.102 seconds
 avg_test_acc: {'uniform': 0.6906999945640564, 'validclass': 0.6906999945640564, 'labeldist': 0.6906999945640564}
 pfl_avg_test_acc: {'uniform': 0.44768000245094297, 'validclass': 0.5750405550003052, 'labeldist': 0.8628515124320983}
Round:80 - Active clients:[44 36 33 29 26]:
 Training time:18.816 seconds
 server global model correct 6381
 Testing time:25.558 seconds
 avg_test_acc: {'uniform': 0.6381000280380249, 'validclass': 0.6381000280380249, 'labeldist': 0.6380999684333801}
 pfl_avg_test_acc: {'uniform': 0.4082199990749359, 'validclass': 0.57264404296875, 'labeldist': 0.8619138479232789}
Round:81 - Active clients:[43 23  7 38 25]:
 Training time:18.830 seconds
 server global model correct 5895
 Testing time:25.500 seconds
 avg_test_acc: {'uniform': 0.5895000100135803, 'validclass': 0.5895000100135803, 'labeldist': 0.5895000100135803}
 pfl_avg_test_acc: {'uniform': 0.4243399977684021, 'validclass': 0.6387449979782105, 'labeldist': 0.8621238350868226}
Round:82 - Active clients:[43 18 45 23 10]:
 Training time:22.703 seconds
 server global model correct 7194
 Testing time:25.552 seconds
 avg_test_acc: {'uniform': 0.7193999886512756, 'validclass': 0.7193999886512756, 'labeldist': 0.7194000482559204}
 pfl_avg_test_acc: {'uniform': 0.4706399977207184, 'validclass': 0.6448337316513062, 'labeldist': 0.8653976559638977}
Round:83 - Active clients:[12 42 10 25 24]:
 Training time:24.036 seconds
 server global model correct 5946
 Testing time:25.571 seconds
 avg_test_acc: {'uniform': 0.5946000218391418, 'validclass': 0.5946000218391418, 'labeldist': 0.5945999622344971}
 pfl_avg_test_acc: {'uniform': 0.4139400064945221, 'validclass': 0.7237722277641296, 'labeldist': 0.8858848094940186}
Round:84 - Active clients:[35 30 37  7  6]:
 Training time:24.985 seconds
 server global model correct 7014
 Testing time:25.588 seconds
 avg_test_acc: {'uniform': 0.7013999819755554, 'validclass': 0.7013999819755554, 'labeldist': 0.7014000415802002}
 pfl_avg_test_acc: {'uniform': 0.43121999502182007, 'validclass': 0.6243559420108795, 'labeldist': 0.8900020003318787}
Round:85 - Active clients:[40 31  5  1  8]:
 Training time:22.654 seconds
 server global model correct 6887
 Testing time:25.491 seconds
 avg_test_acc: {'uniform': 0.6887000203132629, 'validclass': 0.6887000203132629, 'labeldist': 0.6887000203132629}
 pfl_avg_test_acc: {'uniform': 0.5123199999332428, 'validclass': 0.5961069822311401, 'labeldist': 0.8934631466865539}
Round:86 - Active clients:[ 7 48 25 10  8]:
 Training time:22.110 seconds
 server global model correct 5677
 Testing time:25.592 seconds
 avg_test_acc: {'uniform': 0.5677000284194946, 'validclass': 0.5677000284194946, 'labeldist': 0.5676999688148499}
 pfl_avg_test_acc: {'uniform': 0.41459999680519105, 'validclass': 0.7036333322525025, 'labeldist': 0.8681603074073792}
Round:87 - Active clients:[22 18 16  3  1]:
 Training time:19.938 seconds
 server global model correct 7403
 Testing time:25.840 seconds
 avg_test_acc: {'uniform': 0.7402999997138977, 'validclass': 0.7402999997138977, 'labeldist': 0.7403000593185425}
 pfl_avg_test_acc: {'uniform': 0.553059995174408, 'validclass': 0.6335415840148926, 'labeldist': 0.8443463444709778}
 Best test accuracy:0.740. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:88 - Active clients:[38  2 49 17 36]:
 Training time:21.475 seconds
 server global model correct 7007
 Testing time:25.900 seconds
 avg_test_acc: {'uniform': 0.7006999850273132, 'validclass': 0.7006999850273132, 'labeldist': 0.7006999254226685}
 pfl_avg_test_acc: {'uniform': 0.43532000184059144, 'validclass': 0.5647442936897278, 'labeldist': 0.85082528591156}
Round:89 - Active clients:[ 3 38 28 36 35]:
 Training time:26.794 seconds
 server global model correct 6827
 Testing time:25.601 seconds
 avg_test_acc: {'uniform': 0.682699978351593, 'validclass': 0.682699978351593, 'labeldist': 0.6827000379562378}
 pfl_avg_test_acc: {'uniform': 0.5127599954605102, 'validclass': 0.6461879491806031, 'labeldist': 0.8727034568786621}
Round:90 - Active clients:[23 26 49 46  5]:
 Training time:23.353 seconds
 server global model correct 6709
 Testing time:26.166 seconds
 avg_test_acc: {'uniform': 0.6708999872207642, 'validclass': 0.6708999872207642, 'labeldist': 0.6709000468254089}
 pfl_avg_test_acc: {'uniform': 0.4574000120162964, 'validclass': 0.5507031798362731, 'labeldist': 0.8932253122329712}
Round:91 - Active clients:[ 7 13  0 16 34]:
 Training time:22.638 seconds
 server global model correct 6533
 Testing time:26.180 seconds
 avg_test_acc: {'uniform': 0.6532999873161316, 'validclass': 0.6532999873161316, 'labeldist': 0.6533000469207764}
 pfl_avg_test_acc: {'uniform': 0.4486599862575531, 'validclass': 0.6891666650772095, 'labeldist': 0.9077216744422912}
Round:92 - Active clients:[25 48 46  8 16]:
 Training time:24.304 seconds
 server global model correct 6535
 Testing time:25.876 seconds
 avg_test_acc: {'uniform': 0.6535000205039978, 'validclass': 0.6535000205039978, 'labeldist': 0.6535000205039978}
 pfl_avg_test_acc: {'uniform': 0.45934000611305237, 'validclass': 0.639923346042633, 'labeldist': 0.8656717300415039}
Round:93 - Active clients:[42  3 41 36 40]:
 Training time:21.389 seconds
 server global model correct 6307
 Testing time:25.612 seconds
 avg_test_acc: {'uniform': 0.6306999921798706, 'validclass': 0.6306999921798706, 'labeldist': 0.6306999921798706}
 pfl_avg_test_acc: {'uniform': 0.4921999990940094, 'validclass': 0.6278955698013305, 'labeldist': 0.9132806777954101}
Round:94 - Active clients:[ 5 17  9 27 25]:
 Training time:19.518 seconds
 server global model correct 6753
 Testing time:25.892 seconds
 avg_test_acc: {'uniform': 0.6753000020980835, 'validclass': 0.6753000020980835, 'labeldist': 0.6753000020980835}
 pfl_avg_test_acc: {'uniform': 0.43734000325202943, 'validclass': 0.5965088903903961, 'labeldist': 0.8692782402038575}
Round:95 - Active clients:[28  9 40 25 10]:
 Training time:25.132 seconds
 server global model correct 6615
 Testing time:25.576 seconds
 avg_test_acc: {'uniform': 0.6614999771118164, 'validclass': 0.6614999771118164, 'labeldist': 0.6614999771118164}
 pfl_avg_test_acc: {'uniform': 0.4427599966526031, 'validclass': 0.6926657199859619, 'labeldist': 0.9034026026725769}
Round:96 - Active clients:[18 30 16  0 22]:
 Training time:19.088 seconds
 server global model correct 7239
 Testing time:25.863 seconds
 avg_test_acc: {'uniform': 0.7239000201225281, 'validclass': 0.7239000201225281, 'labeldist': 0.7238999605178833}
 pfl_avg_test_acc: {'uniform': 0.49572000503540037, 'validclass': 0.6915146946907044, 'labeldist': 0.8897120833396912}
Round:97 - Active clients:[ 2 30  0 15 42]:
 Training time:22.915 seconds
 server global model correct 5750
 Testing time:25.865 seconds
 avg_test_acc: {'uniform': 0.574999988079071, 'validclass': 0.574999988079071, 'labeldist': 0.574999988079071}
 pfl_avg_test_acc: {'uniform': 0.43170000314712526, 'validclass': 0.6689055562019348, 'labeldist': 0.9432498097419739}
Round:98 - Active clients:[31 39  5 12  0]:
 Training time:19.730 seconds
 server global model correct 7040
 Testing time:25.603 seconds
 avg_test_acc: {'uniform': 0.7039999961853027, 'validclass': 0.7039999961853027, 'labeldist': 0.7040000557899475}
 pfl_avg_test_acc: {'uniform': 0.5250199973583222, 'validclass': 0.699245548248291, 'labeldist': 0.897235381603241}
Round:99 - Active clients:[16 32 13 11 28]:
 Training time:23.704 seconds
 server global model correct 7320
 Testing time:25.897 seconds
 avg_test_acc: {'uniform': 0.7319999933242798, 'validclass': 0.7319999933242798, 'labeldist': 0.7319999933242798}
 pfl_avg_test_acc: {'uniform': 0.5495600044727326, 'validclass': 0.6331142902374267, 'labeldist': 0.8683586478233337}
Round:100 - Active clients:[ 6 36 37 28 43]:
 Training time:25.652 seconds
 server global model correct 7607
 Testing time:25.605 seconds
 avg_test_acc: {'uniform': 0.760699987411499, 'validclass': 0.760699987411499, 'labeldist': 0.760699987411499}
 pfl_avg_test_acc: {'uniform': 0.4759599924087524, 'validclass': 0.6750678539276123, 'labeldist': 0.9043063044548034}
 Best test accuracy:0.761. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:101 - Active clients:[37 14 21 32 22]:
 Training time:19.502 seconds
 server global model correct 7288
 Testing time:25.914 seconds
 avg_test_acc: {'uniform': 0.7287999987602234, 'validclass': 0.7287999987602234, 'labeldist': 0.7288000583648682}
 pfl_avg_test_acc: {'uniform': 0.45266000628471376, 'validclass': 0.5972888827323913, 'labeldist': 0.8711260557174683}
Round:102 - Active clients:[37 23 26 20 29]:
 Training time:20.561 seconds
 server global model correct 6620
 Testing time:25.553 seconds
 avg_test_acc: {'uniform': 0.6620000004768372, 'validclass': 0.6620000004768372, 'labeldist': 0.6620000004768372}
 pfl_avg_test_acc: {'uniform': 0.45140000581741335, 'validclass': 0.6221583366394043, 'labeldist': 0.8797921180725098}
Round:103 - Active clients:[43  4 48 44  2]:
 Training time:23.114 seconds
 server global model correct 7002
 Testing time:25.551 seconds
 avg_test_acc: {'uniform': 0.7002000212669373, 'validclass': 0.7002000212669373, 'labeldist': 0.7001999616622925}
 pfl_avg_test_acc: {'uniform': 0.5059599995613098, 'validclass': 0.6238049864768982, 'labeldist': 0.8566250324249267}
Round:104 - Active clients:[20 26  7 29 10]:
 Training time:18.112 seconds
 server global model correct 6880
 Testing time:25.597 seconds
 avg_test_acc: {'uniform': 0.6880000233650208, 'validclass': 0.6880000233650208, 'labeldist': 0.687999963760376}
 pfl_avg_test_acc: {'uniform': 0.4716599941253662, 'validclass': 0.639769434928894, 'labeldist': 0.8609509468078613}
Round:105 - Active clients:[11 41 13  4 35]:
 Training time:26.905 seconds
 server global model correct 7024
 Testing time:25.534 seconds
 avg_test_acc: {'uniform': 0.7024000287055969, 'validclass': 0.7024000287055969, 'labeldist': 0.7023999691009521}
 pfl_avg_test_acc: {'uniform': 0.46914000511169435, 'validclass': 0.599439287185669, 'labeldist': 0.8822568416595459}
Round:106 - Active clients:[28 15 32 49 23]:
 Training time:24.707 seconds
 server global model correct 7461
 Testing time:25.985 seconds
 avg_test_acc: {'uniform': 0.7461000084877014, 'validclass': 0.7461000084877014, 'labeldist': 0.7460999488830566}
 pfl_avg_test_acc: {'uniform': 0.4771600067615509, 'validclass': 0.5499011993408203, 'labeldist': 0.8942216634750366}
Round:107 - Active clients:[29 35  0 36  1]:
 Training time:24.492 seconds
 server global model correct 6999
 Testing time:25.370 seconds
 avg_test_acc: {'uniform': 0.6998999714851379, 'validclass': 0.6998999714851379, 'labeldist': 0.6999000906944275}
 pfl_avg_test_acc: {'uniform': 0.444379997253418, 'validclass': 0.6837238192558288, 'labeldist': 0.8933198928833008}
Round:108 - Active clients:[49 33  5 13 43]:
 Training time:22.643 seconds
 server global model correct 7557
 Testing time:25.677 seconds
 avg_test_acc: {'uniform': 0.7556999921798706, 'validclass': 0.7556999921798706, 'labeldist': 0.7556999325752258}
 pfl_avg_test_acc: {'uniform': 0.5079200029373169, 'validclass': 0.59686359167099, 'labeldist': 0.8939216613769532}
Round:109 - Active clients:[23 28 18 43 35]:
 Training time:28.055 seconds
 server global model correct 7492
 Testing time:25.666 seconds
 avg_test_acc: {'uniform': 0.7491999864578247, 'validclass': 0.7491999864578247, 'labeldist': 0.7492000460624695}
 pfl_avg_test_acc: {'uniform': 0.5211999952793122, 'validclass': 0.6353591442108154, 'labeldist': 0.901774525642395}
Round:110 - Active clients:[19 41 14 12 31]:
 Training time:20.309 seconds
 server global model correct 7086
 Testing time:25.715 seconds
 avg_test_acc: {'uniform': 0.7085999846458435, 'validclass': 0.7085999846458435, 'labeldist': 0.7086000442504883}
 pfl_avg_test_acc: {'uniform': 0.5369199872016907, 'validclass': 0.6457067489624023, 'labeldist': 0.8895591497421265}
Round:111 - Active clients:[33 30 31 34 16]:
 Training time:23.397 seconds
 server global model correct 6997
 Testing time:25.422 seconds
 avg_test_acc: {'uniform': 0.6996999979019165, 'validclass': 0.6996999979019165, 'labeldist': 0.6996999382972717}
 pfl_avg_test_acc: {'uniform': 0.5000999927520752, 'validclass': 0.6458777785301208, 'labeldist': 0.9160067915916443}
Round:112 - Active clients:[15 23 12  9 38]:
 Training time:21.752 seconds
 server global model correct 6921
 Testing time:25.482 seconds
 avg_test_acc: {'uniform': 0.6920999884605408, 'validclass': 0.6920999884605408, 'labeldist': 0.6920999884605408}
 pfl_avg_test_acc: {'uniform': 0.49995999932289126, 'validclass': 0.5789011120796204, 'labeldist': 0.8934221744537354}
Round:113 - Active clients:[ 6 29 17 45 39]:
 Training time:13.757 seconds
 server global model correct 7439
 Testing time:25.411 seconds
 avg_test_acc: {'uniform': 0.7439000010490417, 'validclass': 0.7439000010490417, 'labeldist': 0.7439000606536865}
 pfl_avg_test_acc: {'uniform': 0.5178999960422516, 'validclass': 0.5877416670322418, 'labeldist': 0.8333645224571228}
Round:114 - Active clients:[23 31  5 34 15]:
 Training time:25.310 seconds
 server global model correct 7058
 Testing time:25.413 seconds
 avg_test_acc: {'uniform': 0.7057999968528748, 'validclass': 0.7057999968528748, 'labeldist': 0.7057999968528748}
 pfl_avg_test_acc: {'uniform': 0.5054199934005738, 'validclass': 0.596661102771759, 'labeldist': 0.9279783010482788}
Round:115 - Active clients:[ 4 10 38  3 36]:
 Training time:20.845 seconds
 server global model correct 6663
 Testing time:25.445 seconds
 avg_test_acc: {'uniform': 0.6662999987602234, 'validclass': 0.6662999987602234, 'labeldist': 0.6662999987602234}
 pfl_avg_test_acc: {'uniform': 0.48543999791145326, 'validclass': 0.6822503209114075, 'labeldist': 0.8632357954978943}
Round:116 - Active clients:[48 15 32 34 38]:
 Training time:28.505 seconds
 server global model correct 6898
 Testing time:25.641 seconds
 avg_test_acc: {'uniform': 0.6898000240325928, 'validclass': 0.6898000240325928, 'labeldist': 0.6898000240325928}
 pfl_avg_test_acc: {'uniform': 0.46919999122619627, 'validclass': 0.5903111040592194, 'labeldist': 0.8632251977920532}
Round:117 - Active clients:[ 3 10  6  0 30]:
 Training time:24.216 seconds
 server global model correct 7053
 Testing time:25.413 seconds
 avg_test_acc: {'uniform': 0.705299973487854, 'validclass': 0.705299973487854, 'labeldist': 0.705299973487854}
 pfl_avg_test_acc: {'uniform': 0.4733999967575073, 'validclass': 0.7433583378791809, 'labeldist': 0.9109763741493225}
Round:118 - Active clients:[14 26 19 20 38]:
 Training time:18.978 seconds
 server global model correct 7055
 Testing time:25.461 seconds
 avg_test_acc: {'uniform': 0.7055000066757202, 'validclass': 0.7055000066757202, 'labeldist': 0.7055000066757202}
 pfl_avg_test_acc: {'uniform': 0.47365999817848203, 'validclass': 0.6174388885498047, 'labeldist': 0.8700466632843018}
Round:119 - Active clients:[ 9  1 47 35 13]:
 Training time:27.388 seconds
 server global model correct 7530
 Testing time:25.383 seconds
 avg_test_acc: {'uniform': 0.753000020980835, 'validclass': 0.753000020980835, 'labeldist': 0.753000020980835}
 pfl_avg_test_acc: {'uniform': 0.5379600107669831, 'validclass': 0.6149947643280029, 'labeldist': 0.8930541396141052}
Round:120 - Active clients:[ 9 37 45 11  3]:
 Training time:19.539 seconds
 server global model correct 7008
 Testing time:25.448 seconds
 avg_test_acc: {'uniform': 0.7008000016212463, 'validclass': 0.7008000016212463, 'labeldist': 0.7008000016212463}
 pfl_avg_test_acc: {'uniform': 0.4924600005149841, 'validclass': 0.6595650792121888, 'labeldist': 0.8726393938064575}
Round:121 - Active clients:[47 33 39 37 20]:
 Training time:23.076 seconds
 server global model correct 7133
 Testing time:25.793 seconds
 avg_test_acc: {'uniform': 0.7132999897003174, 'validclass': 0.7132999897003174, 'labeldist': 0.7132999897003174}
 pfl_avg_test_acc: {'uniform': 0.5534400105476379, 'validclass': 0.6960020542144776, 'labeldist': 0.861613130569458}
Round:122 - Active clients:[24  1 37 30  7]:
 Training time:16.402 seconds
 server global model correct 7008
 Testing time:25.452 seconds
 avg_test_acc: {'uniform': 0.7008000016212463, 'validclass': 0.7008000016212463, 'labeldist': 0.7008000016212463}
 pfl_avg_test_acc: {'uniform': 0.49060000777244567, 'validclass': 0.6698734164237976, 'labeldist': 0.8907992362976074}
Round:123 - Active clients:[10 13 30 46 18]:
 Training time:25.844 seconds
 server global model correct 7353
 Testing time:25.476 seconds
 avg_test_acc: {'uniform': 0.7353000044822693, 'validclass': 0.7353000044822693, 'labeldist': 0.7353000044822693}
 pfl_avg_test_acc: {'uniform': 0.49336000084877013, 'validclass': 0.6583607196807861, 'labeldist': 0.8891883254051208}
Round:124 - Active clients:[15 38 35  6 26]:
 Training time:29.391 seconds
 server global model correct 7444
 Testing time:25.766 seconds
 avg_test_acc: {'uniform': 0.7444000244140625, 'validclass': 0.7444000244140625, 'labeldist': 0.7444000244140625}
 pfl_avg_test_acc: {'uniform': 0.45742000341415406, 'validclass': 0.5945734977722168, 'labeldist': 0.9015734076499939}
Round:125 - Active clients:[18  5 49 35 24]:
 Training time:25.590 seconds
 server global model correct 7461
 Testing time:25.422 seconds
 avg_test_acc: {'uniform': 0.7461000084877014, 'validclass': 0.7461000084877014, 'labeldist': 0.7461000084877014}
 pfl_avg_test_acc: {'uniform': 0.5263399958610535, 'validclass': 0.620160311460495, 'labeldist': 0.8818607926368713}
Round:126 - Active clients:[23 25 15 41  2]:
 Training time:25.335 seconds
 server global model correct 6728
 Testing time:25.935 seconds
 avg_test_acc: {'uniform': 0.6728000044822693, 'validclass': 0.6728000044822693, 'labeldist': 0.6728000044822693}
 pfl_avg_test_acc: {'uniform': 0.46457999348640444, 'validclass': 0.6444238066673279, 'labeldist': 0.9221202373504639}
Round:127 - Active clients:[ 7 15  8 24 11]:
 Training time:17.607 seconds
 server global model correct 6785
 Testing time:25.460 seconds
 avg_test_acc: {'uniform': 0.6784999966621399, 'validclass': 0.6784999966621399, 'labeldist': 0.6784999966621399}
 pfl_avg_test_acc: {'uniform': 0.5000799894332886, 'validclass': 0.605903172492981, 'labeldist': 0.8938864469528198}
Round:128 - Active clients:[39  2 12 28 38]:
 Training time:24.874 seconds
 server global model correct 7627
 Testing time:25.416 seconds
 avg_test_acc: {'uniform': 0.7627000212669373, 'validclass': 0.7627000212669373, 'labeldist': 0.7627000212669373}
 pfl_avg_test_acc: {'uniform': 0.5686800003051757, 'validclass': 0.6814392805099487, 'labeldist': 0.8716848731040955}
 Best test accuracy:0.763. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:129 - Active clients:[28  1 46  4  7]:
 Training time:20.294 seconds
 server global model correct 7651
 Testing time:25.452 seconds
 avg_test_acc: {'uniform': 0.7651000022888184, 'validclass': 0.7651000022888184, 'labeldist': 0.7651000618934631}
 pfl_avg_test_acc: {'uniform': 0.5466599941253663, 'validclass': 0.6523761868476867, 'labeldist': 0.8936466813087464}
 Best test accuracy:0.765. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:130 - Active clients:[15  7 20 48  0]:
 Training time:19.356 seconds
 server global model correct 7126
 Testing time:25.719 seconds
 avg_test_acc: {'uniform': 0.7125999927520752, 'validclass': 0.7125999927520752, 'labeldist': 0.71260005235672}
 pfl_avg_test_acc: {'uniform': 0.4935200035572052, 'validclass': 0.6640833139419555, 'labeldist': 0.8966215968132019}
Round:131 - Active clients:[28 19 39 35 45]:
 Training time:22.310 seconds
 server global model correct 7534
 Testing time:25.552 seconds
 avg_test_acc: {'uniform': 0.7534000277519226, 'validclass': 0.7534000277519226, 'labeldist': 0.7533999681472778}
 pfl_avg_test_acc: {'uniform': 0.5346000075340271, 'validclass': 0.6352543711662293, 'labeldist': 0.8736991286277771}
Round:132 - Active clients:[40 11 15 13  5]:
 Training time:21.998 seconds
 server global model correct 7233
 Testing time:25.444 seconds
 avg_test_acc: {'uniform': 0.7232999801635742, 'validclass': 0.7232999801635742, 'labeldist': 0.7232999801635742}
 pfl_avg_test_acc: {'uniform': 0.565499997138977, 'validclass': 0.6068151593208313, 'labeldist': 0.9007145047187806}
Round:133 - Active clients:[30 37 46 32 29]:
 Training time:21.653 seconds
 server global model correct 6290
 Testing time:25.752 seconds
 avg_test_acc: {'uniform': 0.6290000081062317, 'validclass': 0.6290000081062317, 'labeldist': 0.6290000677108765}
 pfl_avg_test_acc: {'uniform': 0.4741600096225739, 'validclass': 0.638824999332428, 'labeldist': 0.8612855076789856}
Round:134 - Active clients:[45  2 26  6 42]:
 Training time:23.029 seconds
 server global model correct 7409
 Testing time:25.398 seconds
 avg_test_acc: {'uniform': 0.7408999800682068, 'validclass': 0.7408999800682068, 'labeldist': 0.7408999800682068}
 pfl_avg_test_acc: {'uniform': 0.4993600010871887, 'validclass': 0.6444283246994018, 'labeldist': 0.9207863569259643}
Round:135 - Active clients:[17  6  2 44  4]:
 Training time:20.206 seconds
 server global model correct 7481
 Testing time:25.357 seconds
 avg_test_acc: {'uniform': 0.7480999827384949, 'validclass': 0.7480999827384949, 'labeldist': 0.7480999827384949}
 pfl_avg_test_acc: {'uniform': 0.5201600134372711, 'validclass': 0.6363450169563294, 'labeldist': 0.8630558252334595}
Round:136 - Active clients:[45 16 23 30 19]:
 Training time:15.027 seconds
 server global model correct 6904
 Testing time:25.425 seconds
 avg_test_acc: {'uniform': 0.6904000043869019, 'validclass': 0.6904000043869019, 'labeldist': 0.6903999447822571}
 pfl_avg_test_acc: {'uniform': 0.544599997997284, 'validclass': 0.5953549921512604, 'labeldist': 0.8804109454154968}
Round:137 - Active clients:[47 46  4  0 49]:
 Training time:24.870 seconds
 server global model correct 6740
 Testing time:25.372 seconds
 avg_test_acc: {'uniform': 0.6740000247955322, 'validclass': 0.6740000247955322, 'labeldist': 0.674000084400177}
 pfl_avg_test_acc: {'uniform': 0.47693999409675597, 'validclass': 0.6682257175445556, 'labeldist': 0.8910802245140076}
Round:138 - Active clients:[12 16 24 31 36]:
 Training time:18.327 seconds
 server global model correct 7062
 Testing time:25.395 seconds
 avg_test_acc: {'uniform': 0.7062000036239624, 'validclass': 0.7062000036239624, 'labeldist': 0.7061999440193176}
 pfl_avg_test_acc: {'uniform': 0.5849400043487549, 'validclass': 0.6655850768089294, 'labeldist': 0.8988425374031067}
Round:139 - Active clients:[ 7 21 13 39 33]:
 Training time:15.136 seconds
 server global model correct 7510
 Testing time:25.702 seconds
 avg_test_acc: {'uniform': 0.7509999871253967, 'validclass': 0.7509999871253967, 'labeldist': 0.7510000467300415}
 pfl_avg_test_acc: {'uniform': 0.5461999893188476, 'validclass': 0.6260051667690277, 'labeldist': 0.9007002592086792}
Round:140 - Active clients:[27  9  6 24 33]:
 Training time:25.047 seconds
 server global model correct 7696
 Testing time:25.419 seconds
 avg_test_acc: {'uniform': 0.769599974155426, 'validclass': 0.769599974155426, 'labeldist': 0.7696000337600708}
 pfl_avg_test_acc: {'uniform': 0.5506999969482422, 'validclass': 0.6309444308280945, 'labeldist': 0.8996433138847351}
 Best test accuracy:0.770. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:141 - Active clients:[23 36  8 22 24]:
 Training time:18.529 seconds
 server global model correct 7486
 Testing time:25.384 seconds
 avg_test_acc: {'uniform': 0.7486000061035156, 'validclass': 0.7486000061035156, 'labeldist': 0.7486000657081604}
 pfl_avg_test_acc: {'uniform': 0.5346200048923493, 'validclass': 0.6230111241340637, 'labeldist': 0.9065999150276184}
Round:142 - Active clients:[ 7 10 36 44  3]:
 Training time:18.994 seconds
 server global model correct 7458
 Testing time:25.418 seconds
 avg_test_acc: {'uniform': 0.7458000183105469, 'validclass': 0.7458000183105469, 'labeldist': 0.7457999587059021}
 pfl_avg_test_acc: {'uniform': 0.5420399963855743, 'validclass': 0.7209196925163269, 'labeldist': 0.87760990858078}
Round:143 - Active clients:[23 49 24 35  3]:
 Training time:25.553 seconds
 server global model correct 7729
 Testing time:25.379 seconds
 avg_test_acc: {'uniform': 0.7728999853134155, 'validclass': 0.7728999853134155, 'labeldist': 0.7729000449180603}
 pfl_avg_test_acc: {'uniform': 0.5702400088310242, 'validclass': 0.6385872960090637, 'labeldist': 0.8958738803863525}
 Best test accuracy:0.773. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:144 - Active clients:[48 41 32  7 19]:
 Training time:19.522 seconds
 server global model correct 7708
 Testing time:25.717 seconds
 avg_test_acc: {'uniform': 0.770799994468689, 'validclass': 0.770799994468689, 'labeldist': 0.770799994468689}
 pfl_avg_test_acc: {'uniform': 0.5550599932670593, 'validclass': 0.6330095171928406, 'labeldist': 0.8535911083221436}
Round:145 - Active clients:[14 35 27  7 38]:
 Training time:24.321 seconds
 server global model correct 7646
 Testing time:25.752 seconds
 avg_test_acc: {'uniform': 0.7645999789237976, 'validclass': 0.7645999789237976, 'labeldist': 0.7646000981330872}
 pfl_avg_test_acc: {'uniform': 0.5375999987125397, 'validclass': 0.6321941971778869, 'labeldist': 0.8760351538658142}
Round:146 - Active clients:[36  7 16 35 24]:
 Training time:19.352 seconds
 server global model correct 7630
 Testing time:25.552 seconds
 avg_test_acc: {'uniform': 0.7630000114440918, 'validclass': 0.7630000114440918, 'labeldist': 0.7630000114440918}
 pfl_avg_test_acc: {'uniform': 0.5890000104904175, 'validclass': 0.6767187237739563, 'labeldist': 0.8952838182449341}
Round:147 - Active clients:[44 47 26 33 39]:
 Training time:21.823 seconds
 server global model correct 7049
 Testing time:25.802 seconds
 avg_test_acc: {'uniform': 0.7049000263214111, 'validclass': 0.7049000263214111, 'labeldist': 0.7049000263214111}
 pfl_avg_test_acc: {'uniform': 0.5291800022125244, 'validclass': 0.6517238140106201, 'labeldist': 0.8669928073883056}
Round:148 - Active clients:[29 13 23 21 28]:
 Training time:21.734 seconds
 server global model correct 7609
 Testing time:26.026 seconds
 avg_test_acc: {'uniform': 0.7609000205993652, 'validclass': 0.7609000205993652, 'labeldist': 0.7608999609947205}
 pfl_avg_test_acc: {'uniform': 0.5307799816131592, 'validclass': 0.5956170558929443, 'labeldist': 0.9161044239997864}
Round:149 - Active clients:[10 19 41 27 47]:
 Training time:29.328 seconds
 server global model correct 7583
 Testing time:25.802 seconds
 avg_test_acc: {'uniform': 0.7583000063896179, 'validclass': 0.7583000063896179, 'labeldist': 0.7583000063896179}
 pfl_avg_test_acc: {'uniform': 0.5342600047588348, 'validclass': 0.6766688108444214, 'labeldist': 0.8681132912635803}
Round:150 - Active clients:[ 8 31  5  2 16]:
 Training time:22.205 seconds
 server global model correct 7727
 Testing time:25.794 seconds
 avg_test_acc: {'uniform': 0.7727000117301941, 'validclass': 0.7727000117301941, 'labeldist': 0.7727000117301941}
 pfl_avg_test_acc: {'uniform': 0.6018200039863586, 'validclass': 0.6530144453048706, 'labeldist': 0.9063993930816651}
Round:151 - Active clients:[35 13 41 42  1]:
 Training time:28.499 seconds
 server global model correct 7118
 Testing time:25.527 seconds
 avg_test_acc: {'uniform': 0.7117999792098999, 'validclass': 0.7117999792098999, 'labeldist': 0.7117999792098999}
 pfl_avg_test_acc: {'uniform': 0.5230000078678131, 'validclass': 0.654345715045929, 'labeldist': 0.9235824704170227}
Round:152 - Active clients:[13 12  2 14 45]:
 Training time:19.589 seconds
 server global model correct 7113
 Testing time:25.504 seconds
 avg_test_acc: {'uniform': 0.7113000154495239, 'validclass': 0.7113000154495239, 'labeldist': 0.7113000750541687}
 pfl_avg_test_acc: {'uniform': 0.5565599977970124, 'validclass': 0.6363249897956849, 'labeldist': 0.9016845464706421}
Round:153 - Active clients:[44 12 42 17 13]:
 Training time:19.782 seconds
 server global model correct 7620
 Testing time:25.685 seconds
 avg_test_acc: {'uniform': 0.7620000243186951, 'validclass': 0.7620000243186951, 'labeldist': 0.7620000243186951}
 pfl_avg_test_acc: {'uniform': 0.5188000082969666, 'validclass': 0.6478399872779846, 'labeldist': 0.8783169746398926}
Round:154 - Active clients:[ 6  2 33  8 40]:
 Training time:26.804 seconds
 server global model correct 7769
 Testing time:25.511 seconds
 avg_test_acc: {'uniform': 0.7768999934196472, 'validclass': 0.7768999934196472, 'labeldist': 0.776900053024292}
 pfl_avg_test_acc: {'uniform': 0.5711199998855591, 'validclass': 0.6609840393066406, 'labeldist': 0.9119721412658691}
 Best test accuracy:0.777. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:155 - Active clients:[25  4  0 41 38]:
 Training time:22.153 seconds
 server global model correct 6943
 Testing time:25.558 seconds
 avg_test_acc: {'uniform': 0.6942999958992004, 'validclass': 0.6942999958992004, 'labeldist': 0.6942999958992004}
 pfl_avg_test_acc: {'uniform': 0.43029999136924746, 'validclass': 0.7564845323562622, 'labeldist': 0.9038696885108948}
Round:156 - Active clients:[42 21  7 16 15]:
 Training time:16.208 seconds
 server global model correct 7387
 Testing time:25.582 seconds
 avg_test_acc: {'uniform': 0.7386999726295471, 'validclass': 0.7386999726295471, 'labeldist': 0.7386999726295471}
 pfl_avg_test_acc: {'uniform': 0.5327599883079529, 'validclass': 0.6087755620479584, 'labeldist': 0.9250835299491882}
Round:157 - Active clients:[16 22 41  8 35]:
 Training time:25.999 seconds
 server global model correct 7526
 Testing time:25.621 seconds
 avg_test_acc: {'uniform': 0.7526000142097473, 'validclass': 0.7526000142097473, 'labeldist': 0.7526000738143921}
 pfl_avg_test_acc: {'uniform': 0.5499999940395355, 'validclass': 0.6470752358436584, 'labeldist': 0.9054261803627014}
Round:158 - Active clients:[31  0 39 11  3]:
 Training time:20.264 seconds
 server global model correct 7374
 Testing time:25.611 seconds
 avg_test_acc: {'uniform': 0.7373999953269958, 'validclass': 0.7373999953269958, 'labeldist': 0.7373999357223511}
 pfl_avg_test_acc: {'uniform': 0.5647000014781952, 'validclass': 0.7518825531005859, 'labeldist': 0.898310375213623}
Round:159 - Active clients:[29 44 21  1 45]:
 Training time:16.379 seconds
 server global model correct 7414
 Testing time:26.153 seconds
 avg_test_acc: {'uniform': 0.7414000034332275, 'validclass': 0.7414000034332275, 'labeldist': 0.7414000034332275}
 pfl_avg_test_acc: {'uniform': 0.5156400084495545, 'validclass': 0.6087512671947479, 'labeldist': 0.8781374931335449}
Round:160 - Active clients:[39 43 37 10 13]:
 Training time:24.264 seconds
 server global model correct 7641
 Testing time:25.542 seconds
 avg_test_acc: {'uniform': 0.7641000151634216, 'validclass': 0.7641000151634216, 'labeldist': 0.7640999555587769}
 pfl_avg_test_acc: {'uniform': 0.5418800115585327, 'validclass': 0.7516138792037964, 'labeldist': 0.8998418927192688}
Round:161 - Active clients:[17 49 28 27  4]:
 Training time:21.432 seconds
 server global model correct 7511
 Testing time:25.878 seconds
 avg_test_acc: {'uniform': 0.7511000037193298, 'validclass': 0.7511000037193298, 'labeldist': 0.7511000633239746}
 pfl_avg_test_acc: {'uniform': 0.5318400025367737, 'validclass': 0.6162245988845825, 'labeldist': 0.8847379803657531}
Round:162 - Active clients:[41 33 27  0  9]:
 Training time:25.709 seconds
 server global model correct 7409
 Testing time:26.079 seconds
 avg_test_acc: {'uniform': 0.7408999800682068, 'validclass': 0.7408999800682068, 'labeldist': 0.7409000396728516}
 pfl_avg_test_acc: {'uniform': 0.5232999920845032, 'validclass': 0.7171396732330322, 'labeldist': 0.9234452605247497}
Round:163 - Active clients:[ 1 34 49  4 26]:
 Training time:24.881 seconds
 server global model correct 6974
 Testing time:25.568 seconds
 avg_test_acc: {'uniform': 0.6973999738693237, 'validclass': 0.6973999738693237, 'labeldist': 0.6974000334739685}
 pfl_avg_test_acc: {'uniform': 0.49206000566482544, 'validclass': 0.6708999991416931, 'labeldist': 0.9238292336463928}
Round:164 - Active clients:[16 10 32 21 44]:
 Training time:22.792 seconds
 server global model correct 7298
 Testing time:25.551 seconds
 avg_test_acc: {'uniform': 0.7297999858856201, 'validclass': 0.7297999858856201, 'labeldist': 0.7298000454902649}
 pfl_avg_test_acc: {'uniform': 0.5244000077247619, 'validclass': 0.6506788909435273, 'labeldist': 0.8706041812896729}
Round:165 - Active clients:[39 37 18 15 46]:
 Training time:23.790 seconds
 server global model correct 7502
 Testing time:25.573 seconds
 avg_test_acc: {'uniform': 0.7501999735832214, 'validclass': 0.7501999735832214, 'labeldist': 0.7502000331878662}
 pfl_avg_test_acc: {'uniform': 0.5468799948692322, 'validclass': 0.7003646850585937, 'labeldist': 0.889648163318634}
Round:166 - Active clients:[ 8 16 13  7  2]:
 Training time:19.996 seconds
 server global model correct 7838
 Testing time:25.566 seconds
 avg_test_acc: {'uniform': 0.7838000059127808, 'validclass': 0.7838000059127808, 'labeldist': 0.7838000655174255}
 pfl_avg_test_acc: {'uniform': 0.6025600075721741, 'validclass': 0.6640633344650269, 'labeldist': 0.9090529561042786}
 Best test accuracy:0.784. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:167 - Active clients:[48  8 15 34 42]:
 Training time:28.395 seconds
 server global model correct 6940
 Testing time:25.585 seconds
 avg_test_acc: {'uniform': 0.6940000057220459, 'validclass': 0.6940000057220459, 'labeldist': 0.6939999461174011}
 pfl_avg_test_acc: {'uniform': 0.48802000284194946, 'validclass': 0.6493655562400817, 'labeldist': 0.9325623273849487}
Round:168 - Active clients:[32 19 17 10  3]:
 Training time:20.123 seconds
 server global model correct 7600
 Testing time:25.526 seconds
 avg_test_acc: {'uniform': 0.7599999904632568, 'validclass': 0.7599999904632568, 'labeldist': 0.7599999308586121}
 pfl_avg_test_acc: {'uniform': 0.5622600078582763, 'validclass': 0.7014666795730591, 'labeldist': 0.8412372469902039}
Round:169 - Active clients:[ 1 17 22 27 37]:
 Training time:21.840 seconds
 server global model correct 7526
 Testing time:25.516 seconds
 avg_test_acc: {'uniform': 0.7526000142097473, 'validclass': 0.7526000142097473, 'labeldist': 0.7525999546051025}
 pfl_avg_test_acc: {'uniform': 0.5851399958133697, 'validclass': 0.7105325341224671, 'labeldist': 0.8683575630187989}
Round:170 - Active clients:[ 0 33 22  5 31]:
 Training time:20.701 seconds
 server global model correct 7562
 Testing time:25.481 seconds
 avg_test_acc: {'uniform': 0.7562000155448914, 'validclass': 0.7562000155448914, 'labeldist': 0.7562000155448914}
 pfl_avg_test_acc: {'uniform': 0.5538799941539765, 'validclass': 0.7205120682716369, 'labeldist': 0.904234778881073}
Round:171 - Active clients:[35 15  6 17  0]:
 Training time:25.395 seconds
 server global model correct 7383
 Testing time:25.509 seconds
 avg_test_acc: {'uniform': 0.7383000254631042, 'validclass': 0.7383000254631042, 'labeldist': 0.738300085067749}
 pfl_avg_test_acc: {'uniform': 0.5148599922657013, 'validclass': 0.6911396741867065, 'labeldist': 0.914462149143219}
Round:172 - Active clients:[19 40  0 35 17]:
 Training time:22.681 seconds
 server global model correct 7325
 Testing time:25.497 seconds
 avg_test_acc: {'uniform': 0.7325000166893005, 'validclass': 0.7325000166893005, 'labeldist': 0.7325000762939453}
 pfl_avg_test_acc: {'uniform': 0.5401000022888184, 'validclass': 0.7068690657615662, 'labeldist': 0.8828350901603699}
Round:173 - Active clients:[ 6 30 31  9 12]:
 Training time:21.052 seconds
 server global model correct 7001
 Testing time:25.576 seconds
 avg_test_acc: {'uniform': 0.7001000046730042, 'validclass': 0.7001000046730042, 'labeldist': 0.7001000046730042}
 pfl_avg_test_acc: {'uniform': 0.5691199958324432, 'validclass': 0.6563583374023437, 'labeldist': 0.9292994022369385}
Round:174 - Active clients:[18 24 49  2 27]:
 Training time:26.344 seconds
 server global model correct 7809
 Testing time:25.501 seconds
 avg_test_acc: {'uniform': 0.7809000015258789, 'validclass': 0.7809000015258789, 'labeldist': 0.7808999419212341}
 pfl_avg_test_acc: {'uniform': 0.5820400059223175, 'validclass': 0.6666404724121093, 'labeldist': 0.8939087867736817}
Round:175 - Active clients:[48 30 45 31 36]:
 Training time:16.887 seconds
 server global model correct 7020
 Testing time:25.583 seconds
 avg_test_acc: {'uniform': 0.7020000219345093, 'validclass': 0.7020000219345093, 'labeldist': 0.7020000219345093}
 pfl_avg_test_acc: {'uniform': 0.5696400105953217, 'validclass': 0.6464924454689026, 'labeldist': 0.9130988359451294}
Round:176 - Active clients:[37 18 17 41  7]:
 Training time:16.988 seconds
 server global model correct 7221
 Testing time:25.532 seconds
 avg_test_acc: {'uniform': 0.722100019454956, 'validclass': 0.722100019454956, 'labeldist': 0.7220999598503113}
 pfl_avg_test_acc: {'uniform': 0.5429800033569336, 'validclass': 0.7039952397346496, 'labeldist': 0.8694642424583435}
Round:177 - Active clients:[10 16 43 47 32]:
 Training time:26.259 seconds
 server global model correct 7691
 Testing time:25.613 seconds
 avg_test_acc: {'uniform': 0.76910001039505, 'validclass': 0.76910001039505, 'labeldist': 0.76910001039505}
 pfl_avg_test_acc: {'uniform': 0.585699999332428, 'validclass': 0.6988450050354004, 'labeldist': 0.870564341545105}
Round:178 - Active clients:[45  0  7 49 31]:
 Training time:16.512 seconds
 server global model correct 7429
 Testing time:25.526 seconds
 avg_test_acc: {'uniform': 0.742900013923645, 'validclass': 0.742900013923645, 'labeldist': 0.7428999543190002}
 pfl_avg_test_acc: {'uniform': 0.5433599948883057, 'validclass': 0.7079388976097107, 'labeldist': 0.9149341225624085}
Round:179 - Active clients:[30 33 43  8 26]:
 Training time:20.400 seconds
 server global model correct 7461
 Testing time:25.539 seconds
 avg_test_acc: {'uniform': 0.7461000084877014, 'validclass': 0.7461000084877014, 'labeldist': 0.7461000084877014}
 pfl_avg_test_acc: {'uniform': 0.5342199981212616, 'validclass': 0.6729059457778931, 'labeldist': 0.9355720996856689}
Round:180 - Active clients:[40  4 31  0 17]:
 Training time:17.223 seconds
 server global model correct 7653
 Testing time:25.804 seconds
 avg_test_acc: {'uniform': 0.7652999758720398, 'validclass': 0.7652999758720398, 'labeldist': 0.7653000950813293}
 pfl_avg_test_acc: {'uniform': 0.5589400112628937, 'validclass': 0.7195366859436035, 'labeldist': 0.9040117859840393}
Round:181 - Active clients:[40 43 45 23 30]:
 Training time:17.582 seconds
 server global model correct 7511
 Testing time:25.540 seconds
 avg_test_acc: {'uniform': 0.7511000037193298, 'validclass': 0.7511000037193298, 'labeldist': 0.7511000037193298}
 pfl_avg_test_acc: {'uniform': 0.5924800038337708, 'validclass': 0.6455283403396607, 'labeldist': 0.9259438157081604}
Round:182 - Active clients:[14 28 40 17 13]:
 Training time:18.584 seconds
 server global model correct 7485
 Testing time:26.674 seconds
 avg_test_acc: {'uniform': 0.7484999895095825, 'validclass': 0.7484999895095825, 'labeldist': 0.7484999895095825}
 pfl_avg_test_acc: {'uniform': 0.5831999957561493, 'validclass': 0.6340035676956177, 'labeldist': 0.8985959649085998}
Round:183 - Active clients:[10  4 16 34  6]:
 Training time:29.432 seconds
 server global model correct 7534
 Testing time:25.974 seconds
 avg_test_acc: {'uniform': 0.7534000277519226, 'validclass': 0.7534000277519226, 'labeldist': 0.7534000277519226}
 pfl_avg_test_acc: {'uniform': 0.5226000010967254, 'validclass': 0.7352800011634827, 'labeldist': 0.9156347870826721}
Round:184 - Active clients:[38 32 20  2 37]:
 Training time:26.101 seconds
 server global model correct 7123
 Testing time:25.525 seconds
 avg_test_acc: {'uniform': 0.7123000025749207, 'validclass': 0.7123000025749207, 'labeldist': 0.7123000621795654}
 pfl_avg_test_acc: {'uniform': 0.5468400001525879, 'validclass': 0.6823338866233826, 'labeldist': 0.8633709669113159}
Round:185 - Active clients:[15  7 43 42 12]:
 Training time:19.103 seconds
 server global model correct 6896
 Testing time:25.513 seconds
 avg_test_acc: {'uniform': 0.6895999908447266, 'validclass': 0.6895999908447266, 'labeldist': 0.6895999908447266}
 pfl_avg_test_acc: {'uniform': 0.6081799983978271, 'validclass': 0.7066283345222473, 'labeldist': 0.9332900524139405}
Round:186 - Active clients:[32 24 35 48 41]:
 Training time:28.516 seconds
 server global model correct 7634
 Testing time:25.871 seconds
 avg_test_acc: {'uniform': 0.7634000182151794, 'validclass': 0.7634000182151794, 'labeldist': 0.7634000778198242}
 pfl_avg_test_acc: {'uniform': 0.5641799867153168, 'validclass': 0.6341127157211304, 'labeldist': 0.8785764813423157}
Round:187 - Active clients:[23  9 32  4 49]:
 Training time:19.756 seconds
 server global model correct 7091
 Testing time:25.514 seconds
 avg_test_acc: {'uniform': 0.7091000080108643, 'validclass': 0.7091000080108643, 'labeldist': 0.7090999484062195}
 pfl_avg_test_acc: {'uniform': 0.5453399837017059, 'validclass': 0.6137670397758483, 'labeldist': 0.9041897177696228}
Round:188 - Active clients:[19  6 44 40  4]:
 Training time:20.648 seconds
 server global model correct 7953
 Testing time:25.528 seconds
 avg_test_acc: {'uniform': 0.7953000068664551, 'validclass': 0.7953000068664551, 'labeldist': 0.7953000664710999}
 pfl_avg_test_acc: {'uniform': 0.5980999946594239, 'validclass': 0.6806249976158142, 'labeldist': 0.8829282760620117}
 Best test accuracy:0.795. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:189 - Active clients:[14 22 34 27 41]:
 Training time:27.747 seconds
 server global model correct 7608
 Testing time:25.729 seconds
 avg_test_acc: {'uniform': 0.7608000040054321, 'validclass': 0.7608000040054321, 'labeldist': 0.7608000636100769}
 pfl_avg_test_acc: {'uniform': 0.5335399985313416, 'validclass': 0.6704238057136536, 'labeldist': 0.9147729277610779}
Round:190 - Active clients:[ 1 28 44 38 11]:
 Training time:26.105 seconds
 server global model correct 7556
 Testing time:25.747 seconds
 avg_test_acc: {'uniform': 0.7555999755859375, 'validclass': 0.7555999755859375, 'labeldist': 0.7555999159812927}
 pfl_avg_test_acc: {'uniform': 0.5652000069618225, 'validclass': 0.6895200133323669, 'labeldist': 0.8680646657943726}
Round:191 - Active clients:[23 37 31 17 25]:
 Training time:19.912 seconds
 server global model correct 7121
 Testing time:26.035 seconds
 avg_test_acc: {'uniform': 0.7121000289916992, 'validclass': 0.7121000289916992, 'labeldist': 0.7121000289916992}
 pfl_avg_test_acc: {'uniform': 0.5238399982452393, 'validclass': 0.746655547618866, 'labeldist': 0.8995888233184814}
Round:192 - Active clients:[41 19 16 44 46]:
 Training time:23.260 seconds
 server global model correct 8016
 Testing time:25.777 seconds
 avg_test_acc: {'uniform': 0.8015999794006348, 'validclass': 0.8015999794006348, 'labeldist': 0.8015999794006348}
 pfl_avg_test_acc: {'uniform': 0.5792200088500976, 'validclass': 0.6523135662078857, 'labeldist': 0.8668903708457947}
 Best test accuracy:0.802. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_0.3_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:193 - Active clients:[24 18 48 19 29]:
 Training time:19.366 seconds
 server global model correct 7812
 Testing time:25.464 seconds
 avg_test_acc: {'uniform': 0.7811999917030334, 'validclass': 0.7811999917030334, 'labeldist': 0.7812000513076782}
 pfl_avg_test_acc: {'uniform': 0.6246600031852723, 'validclass': 0.6854968309402466, 'labeldist': 0.855601704120636}
Round:194 - Active clients:[ 7 32 39 14 24]:
 Training time:12.823 seconds
 server global model correct 7535
 Testing time:25.713 seconds
 avg_test_acc: {'uniform': 0.7534999847412109, 'validclass': 0.7534999847412109, 'labeldist': 0.7535000443458557}
 pfl_avg_test_acc: {'uniform': 0.618779993057251, 'validclass': 0.6779805541038513, 'labeldist': 0.8796104907989502}
Round:195 - Active clients:[29 44  1 22 33]:
 Training time:19.852 seconds
 server global model correct 7502
 Testing time:25.943 seconds
 avg_test_acc: {'uniform': 0.7501999735832214, 'validclass': 0.7501999735832214, 'labeldist': 0.7502000331878662}
 pfl_avg_test_acc: {'uniform': 0.5901000022888183, 'validclass': 0.6852617383003234, 'labeldist': 0.8587588787078857}
Round:196 - Active clients:[36 45  4 25 30]:
 Training time:14.529 seconds
 server global model correct 7495
 Testing time:25.380 seconds
 avg_test_acc: {'uniform': 0.7494999766349792, 'validclass': 0.7494999766349792, 'labeldist': 0.7494999766349792}
 pfl_avg_test_acc: {'uniform': 0.4976799964904785, 'validclass': 0.7010869026184082, 'labeldist': 0.9296812176704407}
Round:197 - Active clients:[ 0 44 16 27 33]:
 Training time:24.628 seconds
 server global model correct 7825
 Testing time:25.411 seconds
 avg_test_acc: {'uniform': 0.7825000286102295, 'validclass': 0.7825000286102295, 'labeldist': 0.7824999094009399}
 pfl_avg_test_acc: {'uniform': 0.5633800029754639, 'validclass': 0.7441501498222352, 'labeldist': 0.8991737127304077}
Round:198 - Active clients:[ 1 38 40 46 35]:
 Training time:29.217 seconds
 server global model correct 7840
 Testing time:25.373 seconds
 avg_test_acc: {'uniform': 0.7839999794960022, 'validclass': 0.7839999794960022, 'labeldist': 0.7839999794960022}
 pfl_avg_test_acc: {'uniform': 0.5762200117111206, 'validclass': 0.6490421414375305, 'labeldist': 0.8855565547943115}
Round:199 - Active clients:[29 33  1 37 31]:
 Training time:21.375 seconds
 server global model correct 7288
 Testing time:25.384 seconds
 avg_test_acc: {'uniform': 0.7287999987602234, 'validclass': 0.7287999987602234, 'labeldist': 0.7287999987602234}
 pfl_avg_test_acc: {'uniform': 0.5833599984645843, 'validclass': 0.7303845167160035, 'labeldist': 0.8893388390541077}
Round:200 - Active clients:[33  8 31 28 20]:
 Training time:23.448 seconds
 server global model correct 7615
 Testing time:25.654 seconds
 avg_test_acc: {'uniform': 0.7615000009536743, 'validclass': 0.7615000009536743, 'labeldist': 0.7614999413490295}
 pfl_avg_test_acc: {'uniform': 0.5878800034523011, 'validclass': 0.6756174564361572, 'labeldist': 0.9243047952651977}
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mricotta-tart-36[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/z4pm6hg6[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250314_212017-z4pm6hg6/logs[0m
wandb: Using wandb-core as the SDK backend.  Please refer to https://wandb.me/wandb-core for more information.
wandb: Appending key for api.wandb.ai to your netrc file: /media/data3/home/dungkt/.netrc
wandb: Currently logged in as: dung-kt230057d (sigm) to https://api.wandb.ai. Use `wandb login --relogin` to force relogin
wandb: Tracking run with wandb version 0.19.8
wandb: Run data is saved locally in /media/data3/home/dungkt/FedNH/wandb/run-20250315_204442-iexwcors
wandb: Run `wandb offline` to turn off syncing.
wandb: Syncing run comfy-glade-38
wandb: ‚≠êÔ∏è View project at https://wandb.ai/sigm/FedNH
wandb: üöÄ View run at https://wandb.ai/sigm/FedNH/runs/iexwcors
results are saved in:  ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
tumorModel_cifar10_dataNH
============================================================Run Summary============================================================
Dataset:
 dataset:Cifar10 | num_classes:10 | partition:noniid-label-distribution | beta:1.0
Server Info:
 strategy:FedNH | num_clients:50 | num_rounds: 200 | participate_ratio:0.1 | drop_ratio:0.0
Clients Info:
 model:tumorModel_cifar10_data | num_epochs:5 | batch_size:64 | optimizer:SGD | inint lr:0.01 | lr scheduler:diminishing | momentum: 0.9 | weight decay: 1e-05
 tumorModel_cifar10_data: size:3.732 MB | num params: 0.933 M
FedUHServer: the following layers will not be updated: ['prototype']
Strategy Related Hyper-parameters:
 server side
  FedNH_smoothing _ 0.9
  FedNH_server_adv_prototype_agg _ False
 client side
  FedNH_return_embedding _ False
  FedNH_head_init _ orthogonal
  FedNH_client_adv_prototype_agg _ False
  FedNH_fix_scaling _ False
Round:1 - Active clients:[27 35 40 38  2]:
 Training time:22.580 seconds
 server global model correct 2218
 Testing time:25.628 seconds
 avg_test_acc: {'uniform': 0.22179999947547913, 'validclass': 0.22179999947547913, 'labeldist': 0.22179998457431793}
 pfl_avg_test_acc: {'uniform': 0.19722000062465667, 'validclass': 0.22024666666984558, 'labeldist': 0.4356631934642792}
Round:2 - Active clients:[36 47 28  9 13]:
 Training time:22.136 seconds
 server global model correct 2296
 Testing time:25.076 seconds
 avg_test_acc: {'uniform': 0.2295999974012375, 'validclass': 0.2295999974012375, 'labeldist': 0.22960001230239868}
 pfl_avg_test_acc: {'uniform': 0.2034999966621399, 'validclass': 0.24394277930259706, 'labeldist': 0.5023861467838288}
 Best test accuracy:0.230. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:3 - Active clients:[12 39  9 47 31]:
 Training time:22.940 seconds
 server global model correct 2922
 Testing time:25.711 seconds
 avg_test_acc: {'uniform': 0.2921999990940094, 'validclass': 0.2921999990940094, 'labeldist': 0.292199969291687}
 pfl_avg_test_acc: {'uniform': 0.24678000211715698, 'validclass': 0.3209340453147888, 'labeldist': 0.6191488981246949}
 Best test accuracy:0.292. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:4 - Active clients:[ 6 48 11  4 12]:
 Training time:19.835 seconds
 server global model correct 3163
 Testing time:25.188 seconds
 avg_test_acc: {'uniform': 0.31630000472068787, 'validclass': 0.31630000472068787, 'labeldist': 0.31630000472068787}
 pfl_avg_test_acc: {'uniform': 0.27825999855995176, 'validclass': 0.3284888923168182, 'labeldist': 0.6008401989936829}
 Best test accuracy:0.316. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:5 - Active clients:[42 29  6 19 28]:
 Training time:18.501 seconds
 server global model correct 3330
 Testing time:25.111 seconds
 avg_test_acc: {'uniform': 0.3330000042915344, 'validclass': 0.3330000042915344, 'labeldist': 0.3330000042915344}
 pfl_avg_test_acc: {'uniform': 0.3148999959230423, 'validclass': 0.3751288831233978, 'labeldist': 0.575757521390915}
 Best test accuracy:0.333. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:6 - Active clients:[49 40 38 23  7]:
 Training time:25.693 seconds
 server global model correct 4037
 Testing time:25.383 seconds
 avg_test_acc: {'uniform': 0.40369999408721924, 'validclass': 0.40369999408721924, 'labeldist': 0.4037000238895416}
 pfl_avg_test_acc: {'uniform': 0.3258199989795685, 'validclass': 0.37588889598846437, 'labeldist': 0.6317711591720581}
 Best test accuracy:0.404. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:7 - Active clients:[13 15 22 42 30]:
 Training time:25.940 seconds
 server global model correct 4574
 Testing time:25.455 seconds
 avg_test_acc: {'uniform': 0.45739999413490295, 'validclass': 0.45739999413490295, 'labeldist': 0.45740002393722534}
 pfl_avg_test_acc: {'uniform': 0.3822799980640411, 'validclass': 0.40532444715499877, 'labeldist': 0.591338312625885}
 Best test accuracy:0.457. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:8 - Active clients:[44 49 36 23 48]:
 Training time:22.820 seconds
 server global model correct 4947
 Testing time:25.754 seconds
 avg_test_acc: {'uniform': 0.49470001459121704, 'validclass': 0.49470001459121704, 'labeldist': 0.49470001459121704}
 pfl_avg_test_acc: {'uniform': 0.39667999744415283, 'validclass': 0.44231778383255005, 'labeldist': 0.6570179343223572}
 Best test accuracy:0.495. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:9 - Active clients:[21 37  2 14 44]:
 Training time:23.590 seconds
 server global model correct 5451
 Testing time:25.399 seconds
 avg_test_acc: {'uniform': 0.5450999736785889, 'validclass': 0.5450999736785889, 'labeldist': 0.5451000332832336}
 pfl_avg_test_acc: {'uniform': 0.43844000101089475, 'validclass': 0.43844000101089475, 'labeldist': 0.6100760459899902}
 Best test accuracy:0.545. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:10 - Active clients:[37 23 44 42 47]:
 Training time:26.797 seconds
 server global model correct 5636
 Testing time:25.192 seconds
 avg_test_acc: {'uniform': 0.5636000037193298, 'validclass': 0.5636000037193298, 'labeldist': 0.5636000633239746}
 pfl_avg_test_acc: {'uniform': 0.4540600061416626, 'validclass': 0.4924533307552338, 'labeldist': 0.6688661813735962}
 Best test accuracy:0.564. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:11 - Active clients:[37 45 36 22  2]:
 Training time:24.579 seconds
 server global model correct 6097
 Testing time:25.988 seconds
 avg_test_acc: {'uniform': 0.6097000241279602, 'validclass': 0.6097000241279602, 'labeldist': 0.6097000241279602}
 pfl_avg_test_acc: {'uniform': 0.47585999965667725, 'validclass': 0.49636000394821167, 'labeldist': 0.6487679004669189}
 Best test accuracy:0.610. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:12 - Active clients:[28 46  7 41 36]:
 Training time:24.573 seconds
 server global model correct 5280
 Testing time:25.083 seconds
 avg_test_acc: {'uniform': 0.527999997138977, 'validclass': 0.527999997138977, 'labeldist': 0.5280000567436218}
 pfl_avg_test_acc: {'uniform': 0.41950000524520875, 'validclass': 0.5328872203826904, 'labeldist': 0.657111644744873}
Round:13 - Active clients:[43  4 20 46  0]:
 Training time:22.440 seconds
 server global model correct 5895
 Testing time:25.435 seconds
 avg_test_acc: {'uniform': 0.5895000100135803, 'validclass': 0.5895000100135803, 'labeldist': 0.5894999504089355}
 pfl_avg_test_acc: {'uniform': 0.47296000123023985, 'validclass': 0.5126644432544708, 'labeldist': 0.6082583785057067}
Round:14 - Active clients:[47 21 14 30 37]:
 Training time:24.959 seconds
 server global model correct 6325
 Testing time:25.958 seconds
 avg_test_acc: {'uniform': 0.6324999928474426, 'validclass': 0.6324999928474426, 'labeldist': 0.6324999928474426}
 pfl_avg_test_acc: {'uniform': 0.502020001411438, 'validclass': 0.5200000047683716, 'labeldist': 0.6546239614486694}
 Best test accuracy:0.632. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:15 - Active clients:[35 37 41 26 38]:
 Training time:23.223 seconds
 server global model correct 5317
 Testing time:25.463 seconds
 avg_test_acc: {'uniform': 0.5317000150680542, 'validclass': 0.5317000150680542, 'labeldist': 0.5317000150680542}
 pfl_avg_test_acc: {'uniform': 0.4232000052928925, 'validclass': 0.581456184387207, 'labeldist': 0.7340656518936157}
Round:16 - Active clients:[ 3 34 25 36 20]:
 Training time:22.071 seconds
 server global model correct 5829
 Testing time:25.292 seconds
 avg_test_acc: {'uniform': 0.5828999876976013, 'validclass': 0.5828999876976013, 'labeldist': 0.5829000473022461}
 pfl_avg_test_acc: {'uniform': 0.4721999943256378, 'validclass': 0.5210716664791107, 'labeldist': 0.6551673769950866}
Round:17 - Active clients:[44 16 21 42 19]:
 Training time:21.460 seconds
 server global model correct 5546
 Testing time:25.179 seconds
 avg_test_acc: {'uniform': 0.5546000003814697, 'validclass': 0.5546000003814697, 'labeldist': 0.5546000599861145}
 pfl_avg_test_acc: {'uniform': 0.4415599972009659, 'validclass': 0.49714223146438596, 'labeldist': 0.6760337471961975}
Round:18 - Active clients:[43 16 26 30 20]:
 Training time:21.034 seconds
 server global model correct 6232
 Testing time:25.492 seconds
 avg_test_acc: {'uniform': 0.623199999332428, 'validclass': 0.623199999332428, 'labeldist': 0.623199999332428}
 pfl_avg_test_acc: {'uniform': 0.4881399989128113, 'validclass': 0.5255263447761536, 'labeldist': 0.6795345902442932}
Round:19 - Active clients:[24 23 35 30 26]:
 Training time:23.780 seconds
 server global model correct 6683
 Testing time:25.195 seconds
 avg_test_acc: {'uniform': 0.6682999730110168, 'validclass': 0.6682999730110168, 'labeldist': 0.6682999730110168}
 pfl_avg_test_acc: {'uniform': 0.5076200067996979, 'validclass': 0.547244131565094, 'labeldist': 0.7519248485565185}
 Best test accuracy:0.668. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:20 - Active clients:[12 14  4  8 45]:
 Training time:21.601 seconds
 server global model correct 5995
 Testing time:25.468 seconds
 avg_test_acc: {'uniform': 0.5995000004768372, 'validclass': 0.5995000004768372, 'labeldist': 0.5995000600814819}
 pfl_avg_test_acc: {'uniform': 0.5182199895381927, 'validclass': 0.5723694324493408, 'labeldist': 0.6706397533416748}
Round:21 - Active clients:[ 7 44 43 25 14]:
 Training time:20.773 seconds
 server global model correct 6938
 Testing time:25.215 seconds
 avg_test_acc: {'uniform': 0.6937999725341797, 'validclass': 0.6937999725341797, 'labeldist': 0.6937999725341797}
 pfl_avg_test_acc: {'uniform': 0.5840800046920777, 'validclass': 0.5951555609703064, 'labeldist': 0.6883323550224304}
 Best test accuracy:0.694. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:22 - Active clients:[32 12 25 47 33]:
 Training time:20.075 seconds
 server global model correct 6398
 Testing time:25.490 seconds
 avg_test_acc: {'uniform': 0.6398000121116638, 'validclass': 0.6398000121116638, 'labeldist': 0.6398000121116638}
 pfl_avg_test_acc: {'uniform': 0.5274200081825257, 'validclass': 0.5683350026607513, 'labeldist': 0.7133118629455566}
Round:23 - Active clients:[14 18 17 32 13]:
 Training time:19.860 seconds
 server global model correct 6991
 Testing time:25.391 seconds
 avg_test_acc: {'uniform': 0.6991000175476074, 'validclass': 0.6991000175476074, 'labeldist': 0.6990999579429626}
 pfl_avg_test_acc: {'uniform': 0.5913800120353698, 'validclass': 0.6023022294044494, 'labeldist': 0.7141910314559936}
 Best test accuracy:0.699. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:24 - Active clients:[ 8  5 32 26 19]:
 Training time:22.311 seconds
 server global model correct 6206
 Testing time:25.170 seconds
 avg_test_acc: {'uniform': 0.6205999851226807, 'validclass': 0.6205999851226807, 'labeldist': 0.6206000447273254}
 pfl_avg_test_acc: {'uniform': 0.4923200011253357, 'validclass': 0.6106414318084716, 'labeldist': 0.7728824377059936}
Round:25 - Active clients:[36 46  7 41 17]:
 Training time:23.250 seconds
 server global model correct 6404
 Testing time:25.719 seconds
 avg_test_acc: {'uniform': 0.6403999924659729, 'validclass': 0.6403999924659729, 'labeldist': 0.6404000520706177}
 pfl_avg_test_acc: {'uniform': 0.506060004234314, 'validclass': 0.6317700028419495, 'labeldist': 0.7220271229743958}
Round:26 - Active clients:[ 2 43 10 14 44]:
 Training time:20.398 seconds
 server global model correct 7042
 Testing time:25.521 seconds
 avg_test_acc: {'uniform': 0.704200029373169, 'validclass': 0.704200029373169, 'labeldist': 0.7041999697685242}
 pfl_avg_test_acc: {'uniform': 0.6061600089073181, 'validclass': 0.6162044525146484, 'labeldist': 0.7082770466804504}
 Best test accuracy:0.704. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:27 - Active clients:[14 20 46 43  6]:
 Training time:18.072 seconds
 server global model correct 6967
 Testing time:26.001 seconds
 avg_test_acc: {'uniform': 0.6966999769210815, 'validclass': 0.6966999769210815, 'labeldist': 0.6967000365257263}
 pfl_avg_test_acc: {'uniform': 0.5836599946022034, 'validclass': 0.6085777640342712, 'labeldist': 0.7069911360740662}
Round:28 - Active clients:[11 16  9 31 27]:
 Training time:19.014 seconds
 server global model correct 6865
 Testing time:25.224 seconds
 avg_test_acc: {'uniform': 0.6865000128746033, 'validclass': 0.6865000128746033, 'labeldist': 0.6865000128746033}
 pfl_avg_test_acc: {'uniform': 0.5182200014591217, 'validclass': 0.5735671401023865, 'labeldist': 0.758467149734497}
Round:29 - Active clients:[35 26 45 48 22]:
 Training time:21.762 seconds
 server global model correct 6681
 Testing time:25.167 seconds
 avg_test_acc: {'uniform': 0.6680999994277954, 'validclass': 0.6680999994277954, 'labeldist': 0.6681000590324402}
 pfl_avg_test_acc: {'uniform': 0.5243199944496155, 'validclass': 0.5745192885398864, 'labeldist': 0.7897126793861389}
Round:30 - Active clients:[41 20 32 43 10]:
 Training time:20.386 seconds
 server global model correct 6341
 Testing time:25.128 seconds
 avg_test_acc: {'uniform': 0.6341000199317932, 'validclass': 0.6341000199317932, 'labeldist': 0.6341000199317932}
 pfl_avg_test_acc: {'uniform': 0.548279994726181, 'validclass': 0.6596433281898498, 'labeldist': 0.7665452480316162}
Round:31 - Active clients:[32  4  5 31  2]:
 Training time:20.849 seconds
 server global model correct 7256
 Testing time:25.149 seconds
 avg_test_acc: {'uniform': 0.725600004196167, 'validclass': 0.725600004196167, 'labeldist': 0.725600004196167}
 pfl_avg_test_acc: {'uniform': 0.6437199950218201, 'validclass': 0.6524888873100281, 'labeldist': 0.7399724721908569}
 Best test accuracy:0.726. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:32 - Active clients:[49 16 41 35 44]:
 Training time:19.437 seconds
 server global model correct 6585
 Testing time:25.458 seconds
 avg_test_acc: {'uniform': 0.6585000157356262, 'validclass': 0.6585000157356262, 'labeldist': 0.6585000157356262}
 pfl_avg_test_acc: {'uniform': 0.538440003991127, 'validclass': 0.6107400059700012, 'labeldist': 0.7511299014091491}
Round:33 - Active clients:[ 5 27 37 15 40]:
 Training time:24.668 seconds
 server global model correct 7366
 Testing time:25.238 seconds
 avg_test_acc: {'uniform': 0.7365999817848206, 'validclass': 0.7365999817848206, 'labeldist': 0.7366000413894653}
 pfl_avg_test_acc: {'uniform': 0.6364199995994568, 'validclass': 0.6482644438743591, 'labeldist': 0.7558491706848145}
 Best test accuracy:0.737. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:34 - Active clients:[16 39  1  3  0]:
 Training time:21.180 seconds
 server global model correct 6940
 Testing time:25.205 seconds
 avg_test_acc: {'uniform': 0.6940000057220459, 'validclass': 0.6940000057220459, 'labeldist': 0.6940000057220459}
 pfl_avg_test_acc: {'uniform': 0.5388799905776978, 'validclass': 0.6028710961341858, 'labeldist': 0.779289960861206}
Round:35 - Active clients:[39 26 22 31 29]:
 Training time:23.819 seconds
 server global model correct 6651
 Testing time:25.238 seconds
 avg_test_acc: {'uniform': 0.6650999784469604, 'validclass': 0.6650999784469604, 'labeldist': 0.6651000380516052}
 pfl_avg_test_acc: {'uniform': 0.5430800139904022, 'validclass': 0.6243841409683227, 'labeldist': 0.823679256439209}
Round:36 - Active clients:[29 11 18 32 12]:
 Training time:22.719 seconds
 server global model correct 7124
 Testing time:25.198 seconds
 avg_test_acc: {'uniform': 0.7124000191688538, 'validclass': 0.7124000191688538, 'labeldist': 0.7124000191688538}
 pfl_avg_test_acc: {'uniform': 0.556000018119812, 'validclass': 0.6037083387374877, 'labeldist': 0.7909897565841675}
Round:37 - Active clients:[49 37 13  0 41]:
 Training time:22.716 seconds
 server global model correct 7036
 Testing time:25.173 seconds
 avg_test_acc: {'uniform': 0.7035999894142151, 'validclass': 0.7035999894142151, 'labeldist': 0.7036000490188599}
 pfl_avg_test_acc: {'uniform': 0.5632600009441375, 'validclass': 0.6749477863311768, 'labeldist': 0.7875097751617431}
Round:38 - Active clients:[29 17  0 21 40]:
 Training time:21.993 seconds
 server global model correct 7485
 Testing time:25.249 seconds
 avg_test_acc: {'uniform': 0.7484999895095825, 'validclass': 0.7484999895095825, 'labeldist': 0.7484999895095825}
 pfl_avg_test_acc: {'uniform': 0.6151200056076049, 'validclass': 0.6344244480133057, 'labeldist': 0.7360905885696412}
 Best test accuracy:0.748. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:39 - Active clients:[ 2 23 47 16 29]:
 Training time:22.069 seconds
 server global model correct 7145
 Testing time:25.253 seconds
 avg_test_acc: {'uniform': 0.7145000100135803, 'validclass': 0.7145000100135803, 'labeldist': 0.7145000696182251}
 pfl_avg_test_acc: {'uniform': 0.593939995765686, 'validclass': 0.6337399959564209, 'labeldist': 0.7727804541587829}
Round:40 - Active clients:[33 29 49 38 45]:
 Training time:18.852 seconds
 server global model correct 7098
 Testing time:25.228 seconds
 avg_test_acc: {'uniform': 0.7098000049591064, 'validclass': 0.7098000049591064, 'labeldist': 0.7098000645637512}
 pfl_avg_test_acc: {'uniform': 0.5922399938106537, 'validclass': 0.65182443857193, 'labeldist': 0.7926504135131835}
Round:41 - Active clients:[49 18  9 14 32]:
 Training time:20.629 seconds
 server global model correct 7305
 Testing time:25.220 seconds
 avg_test_acc: {'uniform': 0.7304999828338623, 'validclass': 0.7304999828338623, 'labeldist': 0.7304999828338623}
 pfl_avg_test_acc: {'uniform': 0.6320800065994263, 'validclass': 0.6616000056266784, 'labeldist': 0.787451171875}
Round:42 - Active clients:[13 39 30 45 17]:
 Training time:20.510 seconds
 server global model correct 7419
 Testing time:25.513 seconds
 avg_test_acc: {'uniform': 0.7419000267982483, 'validclass': 0.7419000267982483, 'labeldist': 0.7419000267982483}
 pfl_avg_test_acc: {'uniform': 0.5944999873638153, 'validclass': 0.6533422112464905, 'labeldist': 0.7768891811370849}
Round:43 - Active clients:[19 36 28 14 20]:
 Training time:22.511 seconds
 server global model correct 7139
 Testing time:25.532 seconds
 avg_test_acc: {'uniform': 0.7139000296592712, 'validclass': 0.7139000296592712, 'labeldist': 0.7139000296592712}
 pfl_avg_test_acc: {'uniform': 0.5594600021839142, 'validclass': 0.6468672275543212, 'labeldist': 0.7799522399902343}
Round:44 - Active clients:[37  6 47 36  5]:
 Training time:21.533 seconds
 server global model correct 7530
 Testing time:25.259 seconds
 avg_test_acc: {'uniform': 0.753000020980835, 'validclass': 0.753000020980835, 'labeldist': 0.753000020980835}
 pfl_avg_test_acc: {'uniform': 0.6178199887275696, 'validclass': 0.6546049833297729, 'labeldist': 0.764516007900238}
 Best test accuracy:0.753. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:45 - Active clients:[47  7  2  9  5]:
 Training time:25.728 seconds
 server global model correct 7457
 Testing time:25.252 seconds
 avg_test_acc: {'uniform': 0.7457000017166138, 'validclass': 0.7457000017166138, 'labeldist': 0.7457000017166138}
 pfl_avg_test_acc: {'uniform': 0.5957800030708313, 'validclass': 0.6568107962608337, 'labeldist': 0.7563562750816345}
Round:46 - Active clients:[ 9 14  3 35 10]:
 Training time:21.079 seconds
 server global model correct 7614
 Testing time:25.337 seconds
 avg_test_acc: {'uniform': 0.7613999843597412, 'validclass': 0.7613999843597412, 'labeldist': 0.7613999843597412}
 pfl_avg_test_acc: {'uniform': 0.6322200179100037, 'validclass': 0.6754231929779053, 'labeldist': 0.7814467072486877}
 Best test accuracy:0.761. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:47 - Active clients:[40 42 32 13 39]:
 Training time:23.835 seconds
 server global model correct 7451
 Testing time:25.273 seconds
 avg_test_acc: {'uniform': 0.7451000213623047, 'validclass': 0.7451000213623047, 'labeldist': 0.7451000213623047}
 pfl_avg_test_acc: {'uniform': 0.5906400144100189, 'validclass': 0.6594555616378784, 'labeldist': 0.8181986451148987}
Round:48 - Active clients:[ 8  3 45  1 47]:
 Training time:21.339 seconds
 server global model correct 7403
 Testing time:25.265 seconds
 avg_test_acc: {'uniform': 0.7402999997138977, 'validclass': 0.7402999997138977, 'labeldist': 0.7403000593185425}
 pfl_avg_test_acc: {'uniform': 0.6166999936103821, 'validclass': 0.660402774810791, 'labeldist': 0.7856930494308472}
Round:49 - Active clients:[25 31 39 16 14]:
 Training time:18.220 seconds
 server global model correct 7429
 Testing time:25.191 seconds
 avg_test_acc: {'uniform': 0.742900013923645, 'validclass': 0.742900013923645, 'labeldist': 0.742900013923645}
 pfl_avg_test_acc: {'uniform': 0.6267399966716767, 'validclass': 0.6711133360862732, 'labeldist': 0.8036824822425842}
Round:50 - Active clients:[34 36  1 38  8]:
 Training time:22.930 seconds
 server global model correct 7139
 Testing time:25.231 seconds
 avg_test_acc: {'uniform': 0.7139000296592712, 'validclass': 0.7139000296592712, 'labeldist': 0.7139000296592712}
 pfl_avg_test_acc: {'uniform': 0.5921800017356873, 'validclass': 0.6921194553375244, 'labeldist': 0.7590445160865784}
Round:51 - Active clients:[ 4 48 47 15  0]:
 Training time:23.334 seconds
 server global model correct 7359
 Testing time:25.200 seconds
 avg_test_acc: {'uniform': 0.7358999848365784, 'validclass': 0.7358999848365784, 'labeldist': 0.7358999848365784}
 pfl_avg_test_acc: {'uniform': 0.6015200018882751, 'validclass': 0.6659777879714965, 'labeldist': 0.7765331983566284}
Round:52 - Active clients:[19  3 26 40  8]:
 Training time:24.472 seconds
 server global model correct 7233
 Testing time:25.206 seconds
 avg_test_acc: {'uniform': 0.7232999801635742, 'validclass': 0.7232999801635742, 'labeldist': 0.723300039768219}
 pfl_avg_test_acc: {'uniform': 0.5560200035572052, 'validclass': 0.6698071479797363, 'labeldist': 0.8187962770462036}
Round:53 - Active clients:[ 1  2 28 21  8]:
 Training time:20.876 seconds
 server global model correct 7685
 Testing time:25.264 seconds
 avg_test_acc: {'uniform': 0.7684999704360962, 'validclass': 0.7684999704360962, 'labeldist': 0.7685000896453857}
 pfl_avg_test_acc: {'uniform': 0.6291000127792359, 'validclass': 0.6531500101089478, 'labeldist': 0.7572336792945862}
 Best test accuracy:0.768. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:54 - Active clients:[10 49 24 39 38]:
 Training time:22.136 seconds
 server global model correct 7393
 Testing time:25.264 seconds
 avg_test_acc: {'uniform': 0.739300012588501, 'validclass': 0.739300012588501, 'labeldist': 0.739300012588501}
 pfl_avg_test_acc: {'uniform': 0.5898400068283081, 'validclass': 0.695686674118042, 'labeldist': 0.8033877491950989}
Round:55 - Active clients:[ 3 22 28 15  6]:
 Training time:19.972 seconds
 server global model correct 7558
 Testing time:25.230 seconds
 avg_test_acc: {'uniform': 0.7558000087738037, 'validclass': 0.7558000087738037, 'labeldist': 0.7558000087738037}
 pfl_avg_test_acc: {'uniform': 0.6367199897766114, 'validclass': 0.6493399858474731, 'labeldist': 0.7762989044189453}
Round:56 - Active clients:[45 40 38  7 20]:
 Training time:26.309 seconds
 server global model correct 7580
 Testing time:25.186 seconds
 avg_test_acc: {'uniform': 0.7580000162124634, 'validclass': 0.7580000162124634, 'labeldist': 0.7580000162124634}
 pfl_avg_test_acc: {'uniform': 0.6099200129508973, 'validclass': 0.6827244400978089, 'labeldist': 0.8092078924179077}
Round:57 - Active clients:[29 20 16  9 39]:
 Training time:22.813 seconds
 server global model correct 7117
 Testing time:25.219 seconds
 avg_test_acc: {'uniform': 0.7117000222206116, 'validclass': 0.7117000222206116, 'labeldist': 0.7117000222206116}
 pfl_avg_test_acc: {'uniform': 0.5798399984836579, 'validclass': 0.6803126811981202, 'labeldist': 0.8110308885574341}
Round:58 - Active clients:[48 18  5 47 16]:
 Training time:22.643 seconds
 server global model correct 7634
 Testing time:25.506 seconds
 avg_test_acc: {'uniform': 0.7634000182151794, 'validclass': 0.7634000182151794, 'labeldist': 0.7634000182151794}
 pfl_avg_test_acc: {'uniform': 0.6451600074768067, 'validclass': 0.6841800093650818, 'labeldist': 0.8097486972808838}
Round:59 - Active clients:[32 21 48 47  1]:
 Training time:21.465 seconds
 server global model correct 7741
 Testing time:25.179 seconds
 avg_test_acc: {'uniform': 0.7741000056266785, 'validclass': 0.7741000056266785, 'labeldist': 0.7740999460220337}
 pfl_avg_test_acc: {'uniform': 0.6587200045585633, 'validclass': 0.6953611135482788, 'labeldist': 0.8087397217750549}
 Best test accuracy:0.774. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:60 - Active clients:[38 20  4 28 40]:
 Training time:25.090 seconds
 server global model correct 7657
 Testing time:25.152 seconds
 avg_test_acc: {'uniform': 0.7656999826431274, 'validclass': 0.7656999826431274, 'labeldist': 0.7656999230384827}
 pfl_avg_test_acc: {'uniform': 0.6498399972915649, 'validclass': 0.7105755567550659, 'labeldist': 0.7829583406448364}
Round:61 - Active clients:[ 7 22 41 29 48]:
 Training time:27.003 seconds
 server global model correct 7368
 Testing time:25.233 seconds
 avg_test_acc: {'uniform': 0.7368000149726868, 'validclass': 0.7368000149726868, 'labeldist': 0.7368000149726868}
 pfl_avg_test_acc: {'uniform': 0.5704999923706054, 'validclass': 0.6991277694702148, 'labeldist': 0.8299710631370545}
Round:62 - Active clients:[39 15  4 48 31]:
 Training time:21.974 seconds
 server global model correct 7460
 Testing time:25.208 seconds
 avg_test_acc: {'uniform': 0.7459999918937683, 'validclass': 0.7459999918937683, 'labeldist': 0.7459999918937683}
 pfl_avg_test_acc: {'uniform': 0.6148999869823456, 'validclass': 0.6940344452857972, 'labeldist': 0.8311516523361206}
Round:63 - Active clients:[ 8 36 47 16 31]:
 Training time:20.573 seconds
 server global model correct 7391
 Testing time:25.203 seconds
 avg_test_acc: {'uniform': 0.7390999794006348, 'validclass': 0.7390999794006348, 'labeldist': 0.7391000390052795}
 pfl_avg_test_acc: {'uniform': 0.6432800054550171, 'validclass': 0.6962100028991699, 'labeldist': 0.7788055300712585}
Round:64 - Active clients:[ 9  1 33 37 13]:
 Training time:23.688 seconds
 server global model correct 7638
 Testing time:25.233 seconds
 avg_test_acc: {'uniform': 0.7638000249862671, 'validclass': 0.7638000249862671, 'labeldist': 0.7638000249862671}
 pfl_avg_test_acc: {'uniform': 0.6635999917984009, 'validclass': 0.7101457118988037, 'labeldist': 0.8274114727973938}
Round:65 - Active clients:[41 17 20 45 23]:
 Training time:21.111 seconds
 server global model correct 7259
 Testing time:25.159 seconds
 avg_test_acc: {'uniform': 0.7258999943733215, 'validclass': 0.7258999943733215, 'labeldist': 0.7258999347686768}
 pfl_avg_test_acc: {'uniform': 0.6041199922561645, 'validclass': 0.714947783946991, 'labeldist': 0.8336602449417114}
Round:66 - Active clients:[ 4 47 25  5  1]:
 Training time:22.249 seconds
 server global model correct 7799
 Testing time:25.181 seconds
 avg_test_acc: {'uniform': 0.7799000144004822, 'validclass': 0.7799000144004822, 'labeldist': 0.7799000144004822}
 pfl_avg_test_acc: {'uniform': 0.6991200089454651, 'validclass': 0.7385255575180054, 'labeldist': 0.7892520427703857}
 Best test accuracy:0.780. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:67 - Active clients:[ 6  1 20 15 11]:
 Training time:20.561 seconds
 server global model correct 7404
 Testing time:25.504 seconds
 avg_test_acc: {'uniform': 0.7404000163078308, 'validclass': 0.7404000163078308, 'labeldist': 0.7404000163078308}
 pfl_avg_test_acc: {'uniform': 0.5882600128650666, 'validclass': 0.6251016736030579, 'labeldist': 0.8189037680625916}
Round:68 - Active clients:[18 41 30  3 37]:
 Training time:26.184 seconds
 server global model correct 7782
 Testing time:25.198 seconds
 avg_test_acc: {'uniform': 0.7781999707221985, 'validclass': 0.7781999707221985, 'labeldist': 0.7782000303268433}
 pfl_avg_test_acc: {'uniform': 0.6290400087833404, 'validclass': 0.7178400039672852, 'labeldist': 0.8234384417533874}
Round:69 - Active clients:[ 4 34 10 19  8]:
 Training time:23.153 seconds
 server global model correct 7021
 Testing time:25.288 seconds
 avg_test_acc: {'uniform': 0.7020999789237976, 'validclass': 0.7020999789237976, 'labeldist': 0.7021000385284424}
 pfl_avg_test_acc: {'uniform': 0.5901799917221069, 'validclass': 0.7173166751861573, 'labeldist': 0.7918805837631225}
Round:70 - Active clients:[19 47 40 30 38]:
 Training time:27.132 seconds
 server global model correct 7378
 Testing time:25.233 seconds
 avg_test_acc: {'uniform': 0.7378000020980835, 'validclass': 0.7378000020980835, 'labeldist': 0.7378000617027283}
 pfl_avg_test_acc: {'uniform': 0.6025999903678894, 'validclass': 0.7375933289527893, 'labeldist': 0.816186785697937}
Round:71 - Active clients:[32 39  4 35 20]:
 Training time:21.848 seconds
 server global model correct 7667
 Testing time:25.323 seconds
 avg_test_acc: {'uniform': 0.766700029373169, 'validclass': 0.766700029373169, 'labeldist': 0.766700029373169}
 pfl_avg_test_acc: {'uniform': 0.6514000058174133, 'validclass': 0.7021422386169434, 'labeldist': 0.8115232586860657}
Round:72 - Active clients:[48 22  4 11 49]:
 Training time:23.426 seconds
 server global model correct 7817
 Testing time:25.157 seconds
 avg_test_acc: {'uniform': 0.7817000150680542, 'validclass': 0.7817000150680542, 'labeldist': 0.781700074672699}
 pfl_avg_test_acc: {'uniform': 0.6509000062942505, 'validclass': 0.6980883479118347, 'labeldist': 0.8358116626739502}
 Best test accuracy:0.782. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:73 - Active clients:[28 20 49 34 32]:
 Training time:20.296 seconds
 server global model correct 7818
 Testing time:25.209 seconds
 avg_test_acc: {'uniform': 0.7817999720573425, 'validclass': 0.7817999720573425, 'labeldist': 0.7817999720573425}
 pfl_avg_test_acc: {'uniform': 0.6871000051498413, 'validclass': 0.714133882522583, 'labeldist': 0.8081667184829712}
 Best test accuracy:0.782. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:74 - Active clients:[22 16 26  8 32]:
 Training time:22.564 seconds
 server global model correct 7726
 Testing time:25.989 seconds
 avg_test_acc: {'uniform': 0.772599995136261, 'validclass': 0.772599995136261, 'labeldist': 0.772599995136261}
 pfl_avg_test_acc: {'uniform': 0.6412999927997589, 'validclass': 0.6807464241981507, 'labeldist': 0.8237432360649108}
Round:75 - Active clients:[ 4  2 15 22  5]:
 Training time:24.652 seconds
 server global model correct 7959
 Testing time:25.205 seconds
 avg_test_acc: {'uniform': 0.7958999872207642, 'validclass': 0.7958999872207642, 'labeldist': 0.7958999872207642}
 pfl_avg_test_acc: {'uniform': 0.7093400001525879, 'validclass': 0.725457775592804, 'labeldist': 0.8162425994873047}
 Best test accuracy:0.796. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:76 - Active clients:[41 45 49  9 47]:
 Training time:20.513 seconds
 server global model correct 7480
 Testing time:25.230 seconds
 avg_test_acc: {'uniform': 0.7480000257492065, 'validclass': 0.7480000257492065, 'labeldist': 0.7480000257492065}
 pfl_avg_test_acc: {'uniform': 0.5756600081920624, 'validclass': 0.7197285771369935, 'labeldist': 0.8318910360336303}
Round:77 - Active clients:[16 40 13 45 38]:
 Training time:21.110 seconds
 server global model correct 7899
 Testing time:25.251 seconds
 avg_test_acc: {'uniform': 0.789900004863739, 'validclass': 0.789900004863739, 'labeldist': 0.789900004863739}
 pfl_avg_test_acc: {'uniform': 0.6528599977493286, 'validclass': 0.702786660194397, 'labeldist': 0.8228638529777527}
Round:78 - Active clients:[19 33 37 26 10]:
 Training time:23.619 seconds
 server global model correct 7642
 Testing time:25.220 seconds
 avg_test_acc: {'uniform': 0.76419997215271, 'validclass': 0.76419997215271, 'labeldist': 0.7642000317573547}
 pfl_avg_test_acc: {'uniform': 0.6200200021266937, 'validclass': 0.7204298496246337, 'labeldist': 0.8485174536705017}
Round:79 - Active clients:[39 44 21 42 48]:
 Training time:23.215 seconds
 server global model correct 7834
 Testing time:25.215 seconds
 avg_test_acc: {'uniform': 0.7833999991416931, 'validclass': 0.7833999991416931, 'labeldist': 0.7833999991416931}
 pfl_avg_test_acc: {'uniform': 0.6359799981117249, 'validclass': 0.7002899885177613, 'labeldist': 0.831728482246399}
Round:80 - Active clients:[44 36 33 29 26]:
 Training time:22.988 seconds
 server global model correct 7614
 Testing time:25.206 seconds
 avg_test_acc: {'uniform': 0.7613999843597412, 'validclass': 0.7613999843597412, 'labeldist': 0.761400043964386}
 pfl_avg_test_acc: {'uniform': 0.6590400099754333, 'validclass': 0.7008862733840943, 'labeldist': 0.8339377045631409}
Round:81 - Active clients:[43 23  7 38 25]:
 Training time:21.033 seconds
 server global model correct 7633
 Testing time:25.166 seconds
 avg_test_acc: {'uniform': 0.7633000016212463, 'validclass': 0.7633000016212463, 'labeldist': 0.7633000016212463}
 pfl_avg_test_acc: {'uniform': 0.6690600037574768, 'validclass': 0.7288088798522949, 'labeldist': 0.8013537645339965}
Round:82 - Active clients:[43 18 45 23 10]:
 Training time:19.565 seconds
 server global model correct 7870
 Testing time:25.173 seconds
 avg_test_acc: {'uniform': 0.7870000004768372, 'validclass': 0.7870000004768372, 'labeldist': 0.7869999408721924}
 pfl_avg_test_acc: {'uniform': 0.7040799975395202, 'validclass': 0.7168577671051025, 'labeldist': 0.8364355206489563}
Round:83 - Active clients:[12 42 10 25 24]:
 Training time:22.002 seconds
 server global model correct 7946
 Testing time:25.235 seconds
 avg_test_acc: {'uniform': 0.7946000099182129, 'validclass': 0.7946000099182129, 'labeldist': 0.7946000099182129}
 pfl_avg_test_acc: {'uniform': 0.6727800130844116, 'validclass': 0.7104661226272583, 'labeldist': 0.8190986037254333}
Round:84 - Active clients:[35 30 37  7  6]:
 Training time:22.600 seconds
 server global model correct 7908
 Testing time:25.218 seconds
 avg_test_acc: {'uniform': 0.7907999753952026, 'validclass': 0.7907999753952026, 'labeldist': 0.7907999753952026}
 pfl_avg_test_acc: {'uniform': 0.7102199912071228, 'validclass': 0.7185822129249573, 'labeldist': 0.8098333954811097}
Round:85 - Active clients:[40 31  5  1  8]:
 Training time:24.165 seconds
 server global model correct 8058
 Testing time:25.201 seconds
 avg_test_acc: {'uniform': 0.8058000206947327, 'validclass': 0.8058000206947327, 'labeldist': 0.8057999610900879}
 pfl_avg_test_acc: {'uniform': 0.7308800101280213, 'validclass': 0.7399205565452576, 'labeldist': 0.8440230131149292}
 Best test accuracy:0.806. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:86 - Active clients:[ 7 48 25 10  8]:
 Training time:23.399 seconds
 server global model correct 7807
 Testing time:25.180 seconds
 avg_test_acc: {'uniform': 0.7807000279426575, 'validclass': 0.7807000279426575, 'labeldist': 0.7807000279426575}
 pfl_avg_test_acc: {'uniform': 0.6946400046348572, 'validclass': 0.7376066684722901, 'labeldist': 0.8190474271774292}
Round:87 - Active clients:[22 18 16  3  1]:
 Training time:23.239 seconds
 server global model correct 8080
 Testing time:25.626 seconds
 avg_test_acc: {'uniform': 0.8080000281333923, 'validclass': 0.8080000281333923, 'labeldist': 0.8079999685287476}
 pfl_avg_test_acc: {'uniform': 0.7009199976921081, 'validclass': 0.7076599955558777, 'labeldist': 0.8382762312889099}
 Best test accuracy:0.808. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:88 - Active clients:[38  2 49 17 36]:
 Training time:18.859 seconds
 server global model correct 7753
 Testing time:25.326 seconds
 avg_test_acc: {'uniform': 0.7753000259399414, 'validclass': 0.7753000259399414, 'labeldist': 0.7753000259399414}
 pfl_avg_test_acc: {'uniform': 0.6686399817466736, 'validclass': 0.7260449886322021, 'labeldist': 0.8057001829147339}
Round:89 - Active clients:[ 3 38 28 36 35]:
 Training time:19.946 seconds
 server global model correct 7958
 Testing time:25.476 seconds
 avg_test_acc: {'uniform': 0.795799970626831, 'validclass': 0.795799970626831, 'labeldist': 0.795799970626831}
 pfl_avg_test_acc: {'uniform': 0.6729199886322021, 'validclass': 0.7219433188438416, 'labeldist': 0.7984127759933471}
Round:90 - Active clients:[23 26 49 46  5]:
 Training time:23.377 seconds
 server global model correct 7712
 Testing time:25.177 seconds
 avg_test_acc: {'uniform': 0.7712000012397766, 'validclass': 0.7712000012397766, 'labeldist': 0.7712000012397766}
 pfl_avg_test_acc: {'uniform': 0.673420000076294, 'validclass': 0.7204447627067566, 'labeldist': 0.8619899988174439}
Round:91 - Active clients:[ 7 13  0 16 34]:
 Training time:23.213 seconds
 server global model correct 7835
 Testing time:25.591 seconds
 avg_test_acc: {'uniform': 0.7835000157356262, 'validclass': 0.7835000157356262, 'labeldist': 0.7835000157356262}
 pfl_avg_test_acc: {'uniform': 0.687879991531372, 'validclass': 0.7225994348526001, 'labeldist': 0.7993400812149047}
Round:92 - Active clients:[25 48 46  8 16]:
 Training time:20.283 seconds
 server global model correct 7899
 Testing time:25.200 seconds
 avg_test_acc: {'uniform': 0.789900004863739, 'validclass': 0.789900004863739, 'labeldist': 0.789900004863739}
 pfl_avg_test_acc: {'uniform': 0.7118800044059753, 'validclass': 0.7448577761650086, 'labeldist': 0.8156188249588012}
Round:93 - Active clients:[42  3 41 36 40]:
 Training time:24.927 seconds
 server global model correct 7683
 Testing time:25.531 seconds
 avg_test_acc: {'uniform': 0.7682999968528748, 'validclass': 0.7682999968528748, 'labeldist': 0.7683000564575195}
 pfl_avg_test_acc: {'uniform': 0.6392400026321411, 'validclass': 0.7440788865089416, 'labeldist': 0.8407036066055298}
Round:94 - Active clients:[ 5 17  9 27 25]:
 Training time:18.639 seconds
 server global model correct 8047
 Testing time:25.199 seconds
 avg_test_acc: {'uniform': 0.8047000169754028, 'validclass': 0.8047000169754028, 'labeldist': 0.8047000169754028}
 pfl_avg_test_acc: {'uniform': 0.730019998550415, 'validclass': 0.7575714230537415, 'labeldist': 0.8009412527084351}
Round:95 - Active clients:[28  9 40 25 10]:
 Training time:22.347 seconds
 server global model correct 8105
 Testing time:25.171 seconds
 avg_test_acc: {'uniform': 0.8105000257492065, 'validclass': 0.8105000257492065, 'labeldist': 0.8105000853538513}
 pfl_avg_test_acc: {'uniform': 0.7209799885749817, 'validclass': 0.7517539620399475, 'labeldist': 0.8207171797752381}
 Best test accuracy:0.811. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:96 - Active clients:[18 30 16  0 22]:
 Training time:25.454 seconds
 server global model correct 8113
 Testing time:26.072 seconds
 avg_test_acc: {'uniform': 0.8112999796867371, 'validclass': 0.8112999796867371, 'labeldist': 0.8112999796867371}
 pfl_avg_test_acc: {'uniform': 0.7251399993896485, 'validclass': 0.7334800004959107, 'labeldist': 0.8211017370223999}
 Best test accuracy:0.811. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:97 - Active clients:[ 2 30  0 15 42]:
 Training time:23.688 seconds
 server global model correct 7887
 Testing time:25.668 seconds
 avg_test_acc: {'uniform': 0.7886999845504761, 'validclass': 0.7886999845504761, 'labeldist': 0.7887000441551208}
 pfl_avg_test_acc: {'uniform': 0.7108200073242188, 'validclass': 0.7408644437789917, 'labeldist': 0.8145502805709839}
Round:98 - Active clients:[31 39  5 12  0]:
 Training time:22.656 seconds
 server global model correct 7829
 Testing time:25.514 seconds
 avg_test_acc: {'uniform': 0.7828999757766724, 'validclass': 0.7828999757766724, 'labeldist': 0.7829000353813171}
 pfl_avg_test_acc: {'uniform': 0.6746000051498413, 'validclass': 0.7439633250236511, 'labeldist': 0.8517324209213257}
Round:99 - Active clients:[16 32 13 11 28]:
 Training time:19.449 seconds
 server global model correct 7961
 Testing time:25.213 seconds
 avg_test_acc: {'uniform': 0.7961000204086304, 'validclass': 0.7961000204086304, 'labeldist': 0.7961000204086304}
 pfl_avg_test_acc: {'uniform': 0.6870399951934815, 'validclass': 0.7138161063194275, 'labeldist': 0.8191873788833618}
Round:100 - Active clients:[ 6 36 37 28 43]:
 Training time:17.044 seconds
 server global model correct 8078
 Testing time:25.192 seconds
 avg_test_acc: {'uniform': 0.8077999949455261, 'validclass': 0.8077999949455261, 'labeldist': 0.8077999949455261}
 pfl_avg_test_acc: {'uniform': 0.7080800056457519, 'validclass': 0.716860008239746, 'labeldist': 0.7997039914131164}
Round:101 - Active clients:[37 14 21 32 22]:
 Training time:23.665 seconds
 server global model correct 8094
 Testing time:25.273 seconds
 avg_test_acc: {'uniform': 0.8094000220298767, 'validclass': 0.8094000220298767, 'labeldist': 0.8094000220298767}
 pfl_avg_test_acc: {'uniform': 0.7463199853897095, 'validclass': 0.7463199853897095, 'labeldist': 0.8329620361328125}
Round:102 - Active clients:[37 23 26 20 29]:
 Training time:26.263 seconds
 server global model correct 7505
 Testing time:25.219 seconds
 avg_test_acc: {'uniform': 0.7505000233650208, 'validclass': 0.7505000233650208, 'labeldist': 0.7505000233650208}
 pfl_avg_test_acc: {'uniform': 0.6624199867248535, 'validclass': 0.7106701612472535, 'labeldist': 0.8706181764602661}
Round:103 - Active clients:[43  4 48 44  2]:
 Training time:20.818 seconds
 server global model correct 8029
 Testing time:25.234 seconds
 avg_test_acc: {'uniform': 0.8029000163078308, 'validclass': 0.8029000163078308, 'labeldist': 0.802899956703186}
 pfl_avg_test_acc: {'uniform': 0.7162199974060058, 'validclass': 0.7361433386802674, 'labeldist': 0.8091684460639954}
Round:104 - Active clients:[20 26  7 29 10]:
 Training time:25.728 seconds
 server global model correct 7487
 Testing time:25.157 seconds
 avg_test_acc: {'uniform': 0.7487000226974487, 'validclass': 0.7487000226974487, 'labeldist': 0.7487000226974487}
 pfl_avg_test_acc: {'uniform': 0.6689200043678284, 'validclass': 0.7249619126319885, 'labeldist': 0.8551382780075073}
Round:105 - Active clients:[11 41 13  4 35]:
 Training time:21.856 seconds
 server global model correct 7461
 Testing time:25.186 seconds
 avg_test_acc: {'uniform': 0.7461000084877014, 'validclass': 0.7461000084877014, 'labeldist': 0.7460999488830566}
 pfl_avg_test_acc: {'uniform': 0.6166800022125244, 'validclass': 0.7364355564117432, 'labeldist': 0.8366037964820862}
Round:106 - Active clients:[28 15 32 49 23]:
 Training time:19.654 seconds
 server global model correct 7937
 Testing time:25.233 seconds
 avg_test_acc: {'uniform': 0.7936999797821045, 'validclass': 0.7936999797821045, 'labeldist': 0.793700098991394}
 pfl_avg_test_acc: {'uniform': 0.7286399960517883, 'validclass': 0.7445555567741394, 'labeldist': 0.841273021697998}
Round:107 - Active clients:[29 35  0 36  1]:
 Training time:21.727 seconds
 server global model correct 7816
 Testing time:25.156 seconds
 avg_test_acc: {'uniform': 0.7815999984741211, 'validclass': 0.7815999984741211, 'labeldist': 0.7815999984741211}
 pfl_avg_test_acc: {'uniform': 0.6955000042915345, 'validclass': 0.7344172239303589, 'labeldist': 0.8264456868171692}
Round:108 - Active clients:[49 33  5 13 43]:
 Training time:18.188 seconds
 server global model correct 8118
 Testing time:25.223 seconds
 avg_test_acc: {'uniform': 0.8118000030517578, 'validclass': 0.8118000030517578, 'labeldist': 0.8118000626564026}
 pfl_avg_test_acc: {'uniform': 0.7404200077056885, 'validclass': 0.7478088974952698, 'labeldist': 0.8332090377807617}
 Best test accuracy:0.812. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:109 - Active clients:[23 28 18 43 35]:
 Training time:18.790 seconds
 server global model correct 8122
 Testing time:25.233 seconds
 avg_test_acc: {'uniform': 0.8122000098228455, 'validclass': 0.8122000098228455, 'labeldist': 0.8122000098228455}
 pfl_avg_test_acc: {'uniform': 0.7258599877357483, 'validclass': 0.7299977660179138, 'labeldist': 0.82119060754776}
 Best test accuracy:0.812. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:110 - Active clients:[19 41 14 12 31]:
 Training time:21.500 seconds
 server global model correct 7464
 Testing time:25.158 seconds
 avg_test_acc: {'uniform': 0.746399998664856, 'validclass': 0.746399998664856, 'labeldist': 0.746399998664856}
 pfl_avg_test_acc: {'uniform': 0.5875999987125397, 'validclass': 0.7554450035095215, 'labeldist': 0.8742990732192993}
Round:111 - Active clients:[33 30 31 34 16]:
 Training time:20.679 seconds
 server global model correct 8033
 Testing time:25.146 seconds
 avg_test_acc: {'uniform': 0.8033000230789185, 'validclass': 0.8033000230789185, 'labeldist': 0.8032999634742737}
 pfl_avg_test_acc: {'uniform': 0.7235999822616577, 'validclass': 0.7408299922943116, 'labeldist': 0.8275074243545533}
Round:112 - Active clients:[15 23 12  9 38]:
 Training time:23.693 seconds
 server global model correct 7824
 Testing time:25.255 seconds
 avg_test_acc: {'uniform': 0.7824000120162964, 'validclass': 0.7824000120162964, 'labeldist': 0.7824000120162964}
 pfl_avg_test_acc: {'uniform': 0.6682399988174439, 'validclass': 0.7526817560195923, 'labeldist': 0.8534674167633056}
Round:113 - Active clients:[ 6 29 17 45 39]:
 Training time:16.288 seconds
 server global model correct 7995
 Testing time:25.115 seconds
 avg_test_acc: {'uniform': 0.7994999885559082, 'validclass': 0.7994999885559082, 'labeldist': 0.7994999289512634}
 pfl_avg_test_acc: {'uniform': 0.68510000705719, 'validclass': 0.7271533489227295, 'labeldist': 0.8436422705650329}
Round:114 - Active clients:[23 31  5 34 15]:
 Training time:23.304 seconds
 server global model correct 8158
 Testing time:25.143 seconds
 avg_test_acc: {'uniform': 0.8158000111579895, 'validclass': 0.8158000111579895, 'labeldist': 0.8158000111579895}
 pfl_avg_test_acc: {'uniform': 0.7201200008392334, 'validclass': 0.7468955516815186, 'labeldist': 0.8500606417655945}
 Best test accuracy:0.816. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:115 - Active clients:[ 4 10 38  3 36]:
 Training time:22.967 seconds
 server global model correct 7961
 Testing time:25.133 seconds
 avg_test_acc: {'uniform': 0.7961000204086304, 'validclass': 0.7961000204086304, 'labeldist': 0.7960999608039856}
 pfl_avg_test_acc: {'uniform': 0.7003200054168701, 'validclass': 0.7631483316421509, 'labeldist': 0.8245774745941162}
Round:116 - Active clients:[48 15 32 34 38]:
 Training time:22.008 seconds
 server global model correct 7938
 Testing time:25.157 seconds
 avg_test_acc: {'uniform': 0.7937999963760376, 'validclass': 0.7937999963760376, 'labeldist': 0.7938001155853271}
 pfl_avg_test_acc: {'uniform': 0.6903600096702576, 'validclass': 0.7656522274017334, 'labeldist': 0.8391355395317077}
Round:117 - Active clients:[ 3 10  6  0 30]:
 Training time:20.723 seconds
 server global model correct 8067
 Testing time:25.203 seconds
 avg_test_acc: {'uniform': 0.8066999912261963, 'validclass': 0.8066999912261963, 'labeldist': 0.8067000508308411}
 pfl_avg_test_acc: {'uniform': 0.7159000039100647, 'validclass': 0.7291599988937378, 'labeldist': 0.8249816536903382}
Round:118 - Active clients:[14 26 19 20 38]:
 Training time:23.443 seconds
 server global model correct 7598
 Testing time:25.118 seconds
 avg_test_acc: {'uniform': 0.7598000168800354, 'validclass': 0.7598000168800354, 'labeldist': 0.7598000168800354}
 pfl_avg_test_acc: {'uniform': 0.6033399939537049, 'validclass': 0.7373371362686157, 'labeldist': 0.864769983291626}
Round:119 - Active clients:[ 9  1 47 35 13]:
 Training time:22.195 seconds
 server global model correct 7987
 Testing time:25.101 seconds
 avg_test_acc: {'uniform': 0.7986999750137329, 'validclass': 0.7986999750137329, 'labeldist': 0.7987000942230225}
 pfl_avg_test_acc: {'uniform': 0.7032199978828431, 'validclass': 0.7566418290138245, 'labeldist': 0.8323797702789306}
Round:120 - Active clients:[ 9 37 45 11  3]:
 Training time:22.505 seconds
 server global model correct 7958
 Testing time:25.141 seconds
 avg_test_acc: {'uniform': 0.795799970626831, 'validclass': 0.795799970626831, 'labeldist': 0.7958000898361206}
 pfl_avg_test_acc: {'uniform': 0.6754600048065186, 'validclass': 0.7195357084274292, 'labeldist': 0.8528532147407532}
Round:121 - Active clients:[47 33 39 37 20]:
 Training time:25.402 seconds
 server global model correct 8040
 Testing time:25.473 seconds
 avg_test_acc: {'uniform': 0.8040000200271606, 'validclass': 0.8040000200271606, 'labeldist': 0.8039999604225159}
 pfl_avg_test_acc: {'uniform': 0.7042799949645996, 'validclass': 0.7605516791343689, 'labeldist': 0.8559115052223205}
Round:122 - Active clients:[24  1 37 30  7]:
 Training time:28.055 seconds
 server global model correct 8221
 Testing time:25.188 seconds
 avg_test_acc: {'uniform': 0.8220999836921692, 'validclass': 0.8220999836921692, 'labeldist': 0.822100043296814}
 pfl_avg_test_acc: {'uniform': 0.7469600081443787, 'validclass': 0.7570999979972839, 'labeldist': 0.8455843448638916}
 Best test accuracy:0.822. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:123 - Active clients:[10 13 30 46 18]:
 Training time:25.236 seconds
 server global model correct 8193
 Testing time:25.185 seconds
 avg_test_acc: {'uniform': 0.8192999958992004, 'validclass': 0.8192999958992004, 'labeldist': 0.8192999958992004}
 pfl_avg_test_acc: {'uniform': 0.7346400022506714, 'validclass': 0.7653599977493286, 'labeldist': 0.8385307669639588}
Round:124 - Active clients:[15 38 35  6 26]:
 Training time:18.000 seconds
 server global model correct 7996
 Testing time:25.415 seconds
 avg_test_acc: {'uniform': 0.7996000051498413, 'validclass': 0.7996000051498413, 'labeldist': 0.7996000647544861}
 pfl_avg_test_acc: {'uniform': 0.6722800016403199, 'validclass': 0.7390987277030945, 'labeldist': 0.8482182145118713}
Round:125 - Active clients:[18  5 49 35 24]:
 Training time:21.295 seconds
 server global model correct 8176
 Testing time:25.148 seconds
 avg_test_acc: {'uniform': 0.8176000118255615, 'validclass': 0.8176000118255615, 'labeldist': 0.8176000714302063}
 pfl_avg_test_acc: {'uniform': 0.7404800057411194, 'validclass': 0.7404800057411194, 'labeldist': 0.8504320025444031}
Round:126 - Active clients:[23 25 15 41  2]:
 Training time:21.647 seconds
 server global model correct 7858
 Testing time:25.191 seconds
 avg_test_acc: {'uniform': 0.7857999801635742, 'validclass': 0.7857999801635742, 'labeldist': 0.7857999801635742}
 pfl_avg_test_acc: {'uniform': 0.6672199904918671, 'validclass': 0.7621877551078796, 'labeldist': 0.8542552828788758}
Round:127 - Active clients:[ 7 15  8 24 11]:
 Training time:25.854 seconds
 server global model correct 8022
 Testing time:25.148 seconds
 avg_test_acc: {'uniform': 0.8022000193595886, 'validclass': 0.8022000193595886, 'labeldist': 0.8022000789642334}
 pfl_avg_test_acc: {'uniform': 0.6873999953269958, 'validclass': 0.7312010884284973, 'labeldist': 0.8415603399276733}
Round:128 - Active clients:[39  2 12 28 38]:
 Training time:21.524 seconds
 server global model correct 7611
 Testing time:25.781 seconds
 avg_test_acc: {'uniform': 0.7610999941825867, 'validclass': 0.7610999941825867, 'labeldist': 0.7611000537872314}
 pfl_avg_test_acc: {'uniform': 0.6541800022125244, 'validclass': 0.7500966787338257, 'labeldist': 0.8405505061149597}
Round:129 - Active clients:[28  1 46  4  7]:
 Training time:24.138 seconds
 server global model correct 8127
 Testing time:25.179 seconds
 avg_test_acc: {'uniform': 0.8126999735832214, 'validclass': 0.8126999735832214, 'labeldist': 0.812700092792511}
 pfl_avg_test_acc: {'uniform': 0.7448399901390076, 'validclass': 0.7750999927520752, 'labeldist': 0.8325750470161438}
Round:130 - Active clients:[15  7 20 48  0]:
 Training time:26.003 seconds
 server global model correct 7755
 Testing time:25.150 seconds
 avg_test_acc: {'uniform': 0.7754999995231628, 'validclass': 0.7754999995231628, 'labeldist': 0.7755000591278076}
 pfl_avg_test_acc: {'uniform': 0.703880000114441, 'validclass': 0.7491833448410035, 'labeldist': 0.8503601312637329}
Round:131 - Active clients:[28 19 39 35 45]:
 Training time:18.808 seconds
 server global model correct 7868
 Testing time:25.265 seconds
 avg_test_acc: {'uniform': 0.7868000268936157, 'validclass': 0.7868000268936157, 'labeldist': 0.786799967288971}
 pfl_avg_test_acc: {'uniform': 0.6494000017642975, 'validclass': 0.7529533386230469, 'labeldist': 0.8519907116889953}
Round:132 - Active clients:[40 11 15 13  5]:
 Training time:25.140 seconds
 server global model correct 8063
 Testing time:25.189 seconds
 avg_test_acc: {'uniform': 0.8062999844551086, 'validclass': 0.8062999844551086, 'labeldist': 0.8063000440597534}
 pfl_avg_test_acc: {'uniform': 0.7108399987220764, 'validclass': 0.7419038772583008, 'labeldist': 0.856797707080841}
Round:133 - Active clients:[30 37 46 32 29]:
 Training time:25.014 seconds
 server global model correct 8195
 Testing time:25.206 seconds
 avg_test_acc: {'uniform': 0.8195000290870667, 'validclass': 0.8195000290870667, 'labeldist': 0.8195000290870667}
 pfl_avg_test_acc: {'uniform': 0.7620799899101257, 'validclass': 0.7820533275604248, 'labeldist': 0.8423211336135864}
Round:134 - Active clients:[45  2 26  6 42]:
 Training time:17.403 seconds
 server global model correct 8144
 Testing time:25.147 seconds
 avg_test_acc: {'uniform': 0.8144000172615051, 'validclass': 0.8144000172615051, 'labeldist': 0.8144000172615051}
 pfl_avg_test_acc: {'uniform': 0.6934199929237366, 'validclass': 0.7246730089187622, 'labeldist': 0.85975741147995}
Round:135 - Active clients:[17  6  2 44  4]:
 Training time:18.241 seconds
 server global model correct 8167
 Testing time:25.174 seconds
 avg_test_acc: {'uniform': 0.8166999816894531, 'validclass': 0.8166999816894531, 'labeldist': 0.8166999220848083}
 pfl_avg_test_acc: {'uniform': 0.7455199956893921, 'validclass': 0.7502666592597962, 'labeldist': 0.8128530979156494}
Round:136 - Active clients:[45 16 23 30 19]:
 Training time:21.284 seconds
 server global model correct 8122
 Testing time:25.393 seconds
 avg_test_acc: {'uniform': 0.8122000098228455, 'validclass': 0.8122000098228455, 'labeldist': 0.8121999502182007}
 pfl_avg_test_acc: {'uniform': 0.6853800058364868, 'validclass': 0.7511777758598328, 'labeldist': 0.861262035369873}
Round:137 - Active clients:[47 46  4  0 49]:
 Training time:22.293 seconds
 server global model correct 8200
 Testing time:25.189 seconds
 avg_test_acc: {'uniform': 0.8199999928474426, 'validclass': 0.8199999928474426, 'labeldist': 0.8199999928474426}
 pfl_avg_test_acc: {'uniform': 0.7427600026130676, 'validclass': 0.7776644468307495, 'labeldist': 0.8245899319648743}
Round:138 - Active clients:[12 16 24 31 36]:
 Training time:20.511 seconds
 server global model correct 8238
 Testing time:25.171 seconds
 avg_test_acc: {'uniform': 0.8238000273704529, 'validclass': 0.8238000273704529, 'labeldist': 0.8237999677658081}
 pfl_avg_test_acc: {'uniform': 0.7243800044059754, 'validclass': 0.7469200015068054, 'labeldist': 0.8527550339698792}
 Best test accuracy:0.824. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:139 - Active clients:[ 7 21 13 39 33]:
 Training time:23.212 seconds
 server global model correct 7985
 Testing time:25.159 seconds
 avg_test_acc: {'uniform': 0.7985000014305115, 'validclass': 0.7985000014305115, 'labeldist': 0.7985000014305115}
 pfl_avg_test_acc: {'uniform': 0.711240005493164, 'validclass': 0.7569888949394226, 'labeldist': 0.8551395297050476}
Round:140 - Active clients:[27  9  6 24 33]:
 Training time:18.199 seconds
 server global model correct 8097
 Testing time:25.202 seconds
 avg_test_acc: {'uniform': 0.8097000122070312, 'validclass': 0.8097000122070312, 'labeldist': 0.8097000122070312}
 pfl_avg_test_acc: {'uniform': 0.7166799902915955, 'validclass': 0.7420942783355713, 'labeldist': 0.8417628407478333}
Round:141 - Active clients:[23 36  8 22 24]:
 Training time:25.780 seconds
 server global model correct 8239
 Testing time:25.397 seconds
 avg_test_acc: {'uniform': 0.8238999843597412, 'validclass': 0.8238999843597412, 'labeldist': 0.823900043964386}
 pfl_avg_test_acc: {'uniform': 0.7384199976921082, 'validclass': 0.757990550994873, 'labeldist': 0.8548696517944336}
 Best test accuracy:0.824. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:142 - Active clients:[ 7 10 36 44  3]:
 Training time:25.187 seconds
 server global model correct 8244
 Testing time:25.791 seconds
 avg_test_acc: {'uniform': 0.824400007724762, 'validclass': 0.824400007724762, 'labeldist': 0.824400007724762}
 pfl_avg_test_acc: {'uniform': 0.7403999924659729, 'validclass': 0.7589638948440551, 'labeldist': 0.8415415644645691}
 Best test accuracy:0.824. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:143 - Active clients:[23 49 24 35  3]:
 Training time:20.983 seconds
 server global model correct 8200
 Testing time:25.196 seconds
 avg_test_acc: {'uniform': 0.8199999928474426, 'validclass': 0.8199999928474426, 'labeldist': 0.8199999332427979}
 pfl_avg_test_acc: {'uniform': 0.7378600001335144, 'validclass': 0.7415511131286621, 'labeldist': 0.8574859857559204}
Round:144 - Active clients:[48 41 32  7 19]:
 Training time:23.890 seconds
 server global model correct 7670
 Testing time:25.502 seconds
 avg_test_acc: {'uniform': 0.7670000195503235, 'validclass': 0.7670000195503235, 'labeldist': 0.7670000195503235}
 pfl_avg_test_acc: {'uniform': 0.6130200147628784, 'validclass': 0.779574453830719, 'labeldist': 0.8804216027259827}
Round:145 - Active clients:[14 35 27  7 38]:
 Training time:21.239 seconds
 server global model correct 8126
 Testing time:25.764 seconds
 avg_test_acc: {'uniform': 0.8126000165939331, 'validclass': 0.8126000165939331, 'labeldist': 0.8126000165939331}
 pfl_avg_test_acc: {'uniform': 0.7277999997138977, 'validclass': 0.7695777773857116, 'labeldist': 0.8265667915344238}
Round:146 - Active clients:[36  7 16 35 24]:
 Training time:22.628 seconds
 server global model correct 8240
 Testing time:26.762 seconds
 avg_test_acc: {'uniform': 0.8240000009536743, 'validclass': 0.8240000009536743, 'labeldist': 0.8240000009536743}
 pfl_avg_test_acc: {'uniform': 0.7309000134468079, 'validclass': 0.7458666682243347, 'labeldist': 0.8385410666465759}
Round:147 - Active clients:[44 47 26 33 39]:
 Training time:25.377 seconds
 server global model correct 7793
 Testing time:25.134 seconds
 avg_test_acc: {'uniform': 0.7792999744415283, 'validclass': 0.7792999744415283, 'labeldist': 0.7792999744415283}
 pfl_avg_test_acc: {'uniform': 0.690719997882843, 'validclass': 0.7532190442085266, 'labeldist': 0.8629145622253418}
Round:148 - Active clients:[29 13 23 21 28]:
 Training time:21.709 seconds
 server global model correct 8242
 Testing time:25.455 seconds
 avg_test_acc: {'uniform': 0.8241999745368958, 'validclass': 0.8241999745368958, 'labeldist': 0.8242000341415405}
 pfl_avg_test_acc: {'uniform': 0.7476599931716919, 'validclass': 0.7623666644096374, 'labeldist': 0.8499692797660827}
Round:149 - Active clients:[10 19 41 27 47]:
 Training time:22.377 seconds
 server global model correct 7480
 Testing time:25.818 seconds
 avg_test_acc: {'uniform': 0.7480000257492065, 'validclass': 0.7480000257492065, 'labeldist': 0.7480000257492065}
 pfl_avg_test_acc: {'uniform': 0.6268600106239319, 'validclass': 0.7887216687202454, 'labeldist': 0.8588302373886109}
Round:150 - Active clients:[ 8 31  5  2 16]:
 Training time:20.277 seconds
 server global model correct 8268
 Testing time:25.554 seconds
 avg_test_acc: {'uniform': 0.8267999887466431, 'validclass': 0.8267999887466431, 'labeldist': 0.8268000483512878}
 pfl_avg_test_acc: {'uniform': 0.7635600090026855, 'validclass': 0.769599997997284, 'labeldist': 0.8486680388450623}
 Best test accuracy:0.827. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:151 - Active clients:[35 13 41 42  1]:
 Training time:23.183 seconds
 server global model correct 7921
 Testing time:25.456 seconds
 avg_test_acc: {'uniform': 0.7921000123023987, 'validclass': 0.7921000123023987, 'labeldist': 0.7920999526977539}
 pfl_avg_test_acc: {'uniform': 0.6832199931144715, 'validclass': 0.772891104221344, 'labeldist': 0.8629133701324463}
Round:152 - Active clients:[13 12  2 14 45]:
 Training time:20.049 seconds
 server global model correct 8210
 Testing time:25.229 seconds
 avg_test_acc: {'uniform': 0.8209999799728394, 'validclass': 0.8209999799728394, 'labeldist': 0.8209999203681946}
 pfl_avg_test_acc: {'uniform': 0.7311800122261047, 'validclass': 0.7523994445800781, 'labeldist': 0.8599226117134094}
Round:153 - Active clients:[44 12 42 17 13]:
 Training time:22.565 seconds
 server global model correct 8154
 Testing time:25.210 seconds
 avg_test_acc: {'uniform': 0.8154000043869019, 'validclass': 0.8154000043869019, 'labeldist': 0.8154000043869019}
 pfl_avg_test_acc: {'uniform': 0.7342000007629395, 'validclass': 0.7606116771697998, 'labeldist': 0.8462180972099305}
Round:154 - Active clients:[ 6  2 33  8 40]:
 Training time:20.261 seconds
 server global model correct 8291
 Testing time:25.432 seconds
 avg_test_acc: {'uniform': 0.8291000127792358, 'validclass': 0.8291000127792358, 'labeldist': 0.8290999531745911}
 pfl_avg_test_acc: {'uniform': 0.752840006351471, 'validclass': 0.7556800127029419, 'labeldist': 0.8456874966621399}
 Best test accuracy:0.829. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:155 - Active clients:[25  4  0 41 38]:
 Training time:22.055 seconds
 server global model correct 7786
 Testing time:25.356 seconds
 avg_test_acc: {'uniform': 0.7785999774932861, 'validclass': 0.7785999774932861, 'labeldist': 0.7786000370979309}
 pfl_avg_test_acc: {'uniform': 0.6863399982452393, 'validclass': 0.8082633376121521, 'labeldist': 0.8424132585525512}
Round:156 - Active clients:[42 21  7 16 15]:
 Training time:22.478 seconds
 server global model correct 8010
 Testing time:25.525 seconds
 avg_test_acc: {'uniform': 0.8009999990463257, 'validclass': 0.8009999990463257, 'labeldist': 0.8009999990463257}
 pfl_avg_test_acc: {'uniform': 0.7395400047302246, 'validclass': 0.7617400050163269, 'labeldist': 0.8457720637321472}
Round:157 - Active clients:[16 22 41  8 35]:
 Training time:22.042 seconds
 server global model correct 7980
 Testing time:25.217 seconds
 avg_test_acc: {'uniform': 0.7979999780654907, 'validclass': 0.7979999780654907, 'labeldist': 0.7979999780654907}
 pfl_avg_test_acc: {'uniform': 0.6969399929046631, 'validclass': 0.7788599848747253, 'labeldist': 0.8479952335357666}
Round:158 - Active clients:[31  0 39 11  3]:
 Training time:21.937 seconds
 server global model correct 8049
 Testing time:25.240 seconds
 avg_test_acc: {'uniform': 0.8048999905586243, 'validclass': 0.8048999905586243, 'labeldist': 0.8049001097679138}
 pfl_avg_test_acc: {'uniform': 0.6979199886322022, 'validclass': 0.7413605332374573, 'labeldist': 0.8684860944747925}
Round:159 - Active clients:[29 44 21  1 45]:
 Training time:21.189 seconds
 server global model correct 8276
 Testing time:25.193 seconds
 avg_test_acc: {'uniform': 0.8276000022888184, 'validclass': 0.8276000022888184, 'labeldist': 0.8276000618934631}
 pfl_avg_test_acc: {'uniform': 0.7531399846076965, 'validclass': 0.7616977691650391, 'labeldist': 0.8537266373634338}
Round:160 - Active clients:[39 43 37 10 13]:
 Training time:21.691 seconds
 server global model correct 8167
 Testing time:25.196 seconds
 avg_test_acc: {'uniform': 0.8166999816894531, 'validclass': 0.8166999816894531, 'labeldist': 0.8167001008987427}
 pfl_avg_test_acc: {'uniform': 0.7363600015640259, 'validclass': 0.7832066774368286, 'labeldist': 0.8558058261871337}
Round:161 - Active clients:[17 49 28 27  4]:
 Training time:16.897 seconds
 server global model correct 8257
 Testing time:25.178 seconds
 avg_test_acc: {'uniform': 0.8256999850273132, 'validclass': 0.8256999850273132, 'labeldist': 0.8256999254226685}
 pfl_avg_test_acc: {'uniform': 0.7784999966621399, 'validclass': 0.7808066725730896, 'labeldist': 0.82397301197052}
Round:162 - Active clients:[41 33 27  0  9]:
 Training time:21.038 seconds
 server global model correct 7880
 Testing time:25.134 seconds
 avg_test_acc: {'uniform': 0.7879999876022339, 'validclass': 0.7879999876022339, 'labeldist': 0.7880000472068787}
 pfl_avg_test_acc: {'uniform': 0.6919800043106079, 'validclass': 0.7935942769050598, 'labeldist': 0.8559717893600464}
Round:163 - Active clients:[ 1 34 49  4 26]:
 Training time:21.478 seconds
 server global model correct 7969
 Testing time:25.296 seconds
 avg_test_acc: {'uniform': 0.7968999743461609, 'validclass': 0.7968999743461609, 'labeldist': 0.7969000339508057}
 pfl_avg_test_acc: {'uniform': 0.7267800092697143, 'validclass': 0.7618674397468567, 'labeldist': 0.8643566846847535}
Round:164 - Active clients:[16 10 32 21 44]:
 Training time:20.292 seconds
 server global model correct 8155
 Testing time:25.154 seconds
 avg_test_acc: {'uniform': 0.815500020980835, 'validclass': 0.815500020980835, 'labeldist': 0.815500020980835}
 pfl_avg_test_acc: {'uniform': 0.763919997215271, 'validclass': 0.7700755596160889, 'labeldist': 0.8412387251853943}
Round:165 - Active clients:[39 37 18 15 46]:
 Training time:25.101 seconds
 server global model correct 8240
 Testing time:25.172 seconds
 avg_test_acc: {'uniform': 0.8240000009536743, 'validclass': 0.8240000009536743, 'labeldist': 0.8240000009536743}
 pfl_avg_test_acc: {'uniform': 0.73264000415802, 'validclass': 0.7850600004196167, 'labeldist': 0.8741151452064514}
Round:166 - Active clients:[ 8 16 13  7  2]:
 Training time:22.562 seconds
 server global model correct 8151
 Testing time:25.163 seconds
 avg_test_acc: {'uniform': 0.8151000142097473, 'validclass': 0.8151000142097473, 'labeldist': 0.8150999546051025}
 pfl_avg_test_acc: {'uniform': 0.7565399885177613, 'validclass': 0.7768055677413941, 'labeldist': 0.8440358519554139}
Round:167 - Active clients:[48  8 15 34 42]:
 Training time:23.420 seconds
 server global model correct 7997
 Testing time:25.182 seconds
 avg_test_acc: {'uniform': 0.7997000217437744, 'validclass': 0.7997000217437744, 'labeldist': 0.7997000217437744}
 pfl_avg_test_acc: {'uniform': 0.7359599947929383, 'validclass': 0.779669439792633, 'labeldist': 0.8512691617012024}
Round:168 - Active clients:[32 19 17 10  3]:
 Training time:19.615 seconds
 server global model correct 8210
 Testing time:25.138 seconds
 avg_test_acc: {'uniform': 0.8209999799728394, 'validclass': 0.8209999799728394, 'labeldist': 0.8209999203681946}
 pfl_avg_test_acc: {'uniform': 0.7105200111865997, 'validclass': 0.7806266665458679, 'labeldist': 0.8546240210533143}
Round:169 - Active clients:[ 1 17 22 27 37]:
 Training time:22.608 seconds
 server global model correct 8308
 Testing time:25.159 seconds
 avg_test_acc: {'uniform': 0.8307999968528748, 'validclass': 0.8307999968528748, 'labeldist': 0.8307999968528748}
 pfl_avg_test_acc: {'uniform': 0.7893199920654297, 'validclass': 0.7915911078453064, 'labeldist': 0.853304135799408}
 Best test accuracy:0.831. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:170 - Active clients:[ 0 33 22  5 31]:
 Training time:23.179 seconds
 server global model correct 8331
 Testing time:25.151 seconds
 avg_test_acc: {'uniform': 0.8331000208854675, 'validclass': 0.8331000208854675, 'labeldist': 0.8331000208854675}
 pfl_avg_test_acc: {'uniform': 0.7783399939537048, 'validclass': 0.7840688824653625, 'labeldist': 0.8646075963973999}
 Best test accuracy:0.833. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:171 - Active clients:[35 15  6 17  0]:
 Training time:16.535 seconds
 server global model correct 8078
 Testing time:25.475 seconds
 avg_test_acc: {'uniform': 0.8077999949455261, 'validclass': 0.8077999949455261, 'labeldist': 0.8077999949455261}
 pfl_avg_test_acc: {'uniform': 0.7468400001525879, 'validclass': 0.7589488983154297, 'labeldist': 0.8314728140830994}
Round:172 - Active clients:[19 40  0 35 17]:
 Training time:21.391 seconds
 server global model correct 8148
 Testing time:25.454 seconds
 avg_test_acc: {'uniform': 0.8148000240325928, 'validclass': 0.8148000240325928, 'labeldist': 0.8148000240325928}
 pfl_avg_test_acc: {'uniform': 0.7191000044345855, 'validclass': 0.786680006980896, 'labeldist': 0.8500390172004699}
Round:173 - Active clients:[ 6 30 31  9 12]:
 Training time:20.136 seconds
 server global model correct 8148
 Testing time:25.449 seconds
 avg_test_acc: {'uniform': 0.8148000240325928, 'validclass': 0.8148000240325928, 'labeldist': 0.814799964427948}
 pfl_avg_test_acc: {'uniform': 0.7257200002670288, 'validclass': 0.759993577003479, 'labeldist': 0.8637050509452819}
Round:174 - Active clients:[18 24 49  2 27]:
 Training time:20.720 seconds
 server global model correct 8302
 Testing time:25.188 seconds
 avg_test_acc: {'uniform': 0.8302000164985657, 'validclass': 0.8302000164985657, 'labeldist': 0.8302000761032104}
 pfl_avg_test_acc: {'uniform': 0.7759600043296814, 'validclass': 0.7759600043296814, 'labeldist': 0.8602146029472351}
Round:175 - Active clients:[48 30 45 31 36]:
 Training time:21.204 seconds
 server global model correct 8163
 Testing time:25.719 seconds
 avg_test_acc: {'uniform': 0.8162999749183655, 'validclass': 0.8162999749183655, 'labeldist': 0.8162999749183655}
 pfl_avg_test_acc: {'uniform': 0.7512400031089783, 'validclass': 0.7733700037002563, 'labeldist': 0.8718968391418457}
Round:176 - Active clients:[37 18 17 41  7]:
 Training time:24.874 seconds
 server global model correct 8189
 Testing time:25.335 seconds
 avg_test_acc: {'uniform': 0.8188999891281128, 'validclass': 0.8188999891281128, 'labeldist': 0.8189000487327576}
 pfl_avg_test_acc: {'uniform': 0.7177799999713897, 'validclass': 0.7990499973297119, 'labeldist': 0.8655174016952515}
Round:177 - Active clients:[10 16 43 47 32]:
 Training time:17.994 seconds
 server global model correct 8184
 Testing time:25.162 seconds
 avg_test_acc: {'uniform': 0.8184000253677368, 'validclass': 0.8184000253677368, 'labeldist': 0.8184000253677368}
 pfl_avg_test_acc: {'uniform': 0.7625999927520752, 'validclass': 0.7787227749824523, 'labeldist': 0.837374484539032}
Round:178 - Active clients:[45  0  7 49 31]:
 Training time:20.185 seconds
 server global model correct 8155
 Testing time:25.223 seconds
 avg_test_acc: {'uniform': 0.815500020980835, 'validclass': 0.815500020980835, 'labeldist': 0.815500020980835}
 pfl_avg_test_acc: {'uniform': 0.7499200105667114, 'validclass': 0.7583911061286926, 'labeldist': 0.8666959762573242}
Round:179 - Active clients:[30 33 43  8 26]:
 Training time:20.897 seconds
 server global model correct 8151
 Testing time:25.165 seconds
 avg_test_acc: {'uniform': 0.8151000142097473, 'validclass': 0.8151000142097473, 'labeldist': 0.8150999546051025}
 pfl_avg_test_acc: {'uniform': 0.7562800049781799, 'validclass': 0.7752607107162476, 'labeldist': 0.8521471142768859}
Round:180 - Active clients:[40  4 31  0 17]:
 Training time:21.850 seconds
 server global model correct 8375
 Testing time:25.194 seconds
 avg_test_acc: {'uniform': 0.8374999761581421, 'validclass': 0.8374999761581421, 'labeldist': 0.8375000357627869}
 pfl_avg_test_acc: {'uniform': 0.7833199977874756, 'validclass': 0.7883222222328186, 'labeldist': 0.8444841980934144}
 Best test accuracy:0.837. Best server model is updatded and saved at ./Cifar_FedNH/FedNH_Cifar10_tumorModel_cifar10_data_noniid-label-distribution_beta_1.0_num_clients_50_participate_ratio_0.1_global_seed_0_FedNH_smoothing_0.9_FedNH_client_adv_prototype_agg_False_no_norm_False_best_global_model.pkl!
Round:181 - Active clients:[40 43 45 23 30]:
 Training time:22.818 seconds
 server global model correct 8257
 Testing time:25.770 seconds
 avg_test_acc: {'uniform': 0.8256999850273132, 'validclass': 0.8256999850273132, 'labeldist': 0.8256999850273132}
 pfl_avg_test_acc: {'uniform': 0.7664399981498718, 'validclass': 0.7705911159515381, 'labeldist': 0.8622474908828736}
Round:182 - Active clients:[14 28 40 17 13]:
 Training time:21.681 seconds
 server global model correct 8325
 Testing time:25.180 seconds
 avg_test_acc: {'uniform': 0.8324999809265137, 'validclass': 0.8324999809265137, 'labeldist': 0.8324999809265137}
 pfl_avg_test_acc: {'uniform': 0.7781599998474121, 'validclass': 0.7861600041389465, 'labeldist': 0.8444592237472535}
Round:183 - Active clients:[10  4 16 34  6]:
 Training time:18.201 seconds
 server global model correct 8185
 Testing time:25.181 seconds
 avg_test_acc: {'uniform': 0.8184999823570251, 'validclass': 0.8184999823570251, 'labeldist': 0.8184999227523804}
 pfl_avg_test_acc: {'uniform': 0.7457800030708313, 'validclass': 0.7681077718734741, 'labeldist': 0.8343029856681824}
Round:184 - Active clients:[38 32 20  2 37]:
 Training time:23.868 seconds
 server global model correct 8272
 Testing time:25.196 seconds
 avg_test_acc: {'uniform': 0.8271999955177307, 'validclass': 0.8271999955177307, 'labeldist': 0.8271999955177307}
 pfl_avg_test_acc: {'uniform': 0.7587599873542785, 'validclass': 0.7931910991668701, 'labeldist': 0.8593328475952149}
Round:185 - Active clients:[15  7 43 42 12]:
 Training time:22.072 seconds
 server global model correct 8128
 Testing time:25.155 seconds
 avg_test_acc: {'uniform': 0.8127999901771545, 'validclass': 0.8127999901771545, 'labeldist': 0.8128000497817993}
 pfl_avg_test_acc: {'uniform': 0.7432199954986572, 'validclass': 0.7757411122322082, 'labeldist': 0.8558571696281433}
Round:186 - Active clients:[32 24 35 48 41]:
 Training time:21.442 seconds
 server global model correct 8257
 Testing time:25.116 seconds
 avg_test_acc: {'uniform': 0.8256999850273132, 'validclass': 0.8256999850273132, 'labeldist': 0.8256999254226685}
 pfl_avg_test_acc: {'uniform': 0.7029600024223328, 'validclass': 0.7831900119781494, 'labeldist': 0.874964714050293}
Round:187 - Active clients:[23  9 32  4 49]:
 Training time:21.334 seconds
 server global model correct 8225
 Testing time:25.463 seconds
 avg_test_acc: {'uniform': 0.8224999904632568, 'validclass': 0.8224999904632568, 'labeldist': 0.8224999904632568}
 pfl_avg_test_acc: {'uniform': 0.7596799850463867, 'validclass': 0.7880133390426636, 'labeldist': 0.8663729906082154}
Round:188 - Active clients:[19  6 44 40  4]:
 Training time:22.474 seconds
 server global model correct 8161
 Testing time:25.436 seconds
 avg_test_acc: {'uniform': 0.816100001335144, 'validclass': 0.816100001335144, 'labeldist': 0.8161001205444336}
 pfl_avg_test_acc: {'uniform': 0.7166599988937378, 'validclass': 0.7766866683959961, 'labeldist': 0.8648994088172912}
Round:189 - Active clients:[14 22 34 27 41]:
 Training time:23.177 seconds
 server global model correct 8172
 Testing time:25.197 seconds
 avg_test_acc: {'uniform': 0.8172000050544739, 'validclass': 0.8172000050544739, 'labeldist': 0.8172000646591187}
 pfl_avg_test_acc: {'uniform': 0.727239990234375, 'validclass': 0.8059399962425232, 'labeldist': 0.8582640886306763}
Round:190 - Active clients:[ 1 28 44 38 11]:
 Training time:22.676 seconds
 server global model correct 8229
 Testing time:25.148 seconds
 avg_test_acc: {'uniform': 0.8228999972343445, 'validclass': 0.8228999972343445, 'labeldist': 0.8228999972343445}
 pfl_avg_test_acc: {'uniform': 0.7384600043296814, 'validclass': 0.7745327830314637, 'labeldist': 0.8583040952682495}
Round:191 - Active clients:[23 37 31 17 25]:
 Training time:20.289 seconds
 server global model correct 8326
 Testing time:25.456 seconds
 avg_test_acc: {'uniform': 0.8325999975204468, 'validclass': 0.8325999975204468, 'labeldist': 0.8326000571250916}
 pfl_avg_test_acc: {'uniform': 0.7879400014877319, 'validclass': 0.7907088875770569, 'labeldist': 0.8626360297203064}
Round:192 - Active clients:[41 19 16 44 46]:
 Training time:22.856 seconds
 server global model correct 7835
 Testing time:25.152 seconds
 avg_test_acc: {'uniform': 0.7835000157356262, 'validclass': 0.7835000157356262, 'labeldist': 0.783500075340271}
 pfl_avg_test_acc: {'uniform': 0.6543000042438507, 'validclass': 0.7993711113929749, 'labeldist': 0.8720275640487671}
Round:193 - Active clients:[24 18 48 19 29]:
 Training time:24.021 seconds
 server global model correct 8283
 Testing time:25.167 seconds
 avg_test_acc: {'uniform': 0.8282999992370605, 'validclass': 0.8282999992370605, 'labeldist': 0.8283000588417053}
 pfl_avg_test_acc: {'uniform': 0.7141799807548523, 'validclass': 0.7758338809013366, 'labeldist': 0.8855195045471191}
Round:194 - Active clients:[ 7 32 39 14 24]:
 Training time:23.652 seconds
 server global model correct 8244
 Testing time:25.449 seconds
 avg_test_acc: {'uniform': 0.824400007724762, 'validclass': 0.824400007724762, 'labeldist': 0.824400007724762}
 pfl_avg_test_acc: {'uniform': 0.7495399951934815, 'validclass': 0.7796800017356873, 'labeldist': 0.8688868284225464}
Round:195 - Active clients:[29 44  1 22 33]:
 Training time:25.393 seconds
 server global model correct 8327
 Testing time:25.219 seconds
 avg_test_acc: {'uniform': 0.8327000141143799, 'validclass': 0.8327000141143799, 'labeldist': 0.8327000141143799}
 pfl_avg_test_acc: {'uniform': 0.7764600038528442, 'validclass': 0.7834622263908386, 'labeldist': 0.8706665754318237}
Round:196 - Active clients:[36 45  4 25 30]:
 Training time:20.800 seconds
 server global model correct 8352
 Testing time:25.484 seconds
 avg_test_acc: {'uniform': 0.8352000117301941, 'validclass': 0.8352000117301941, 'labeldist': 0.8352000117301941}
 pfl_avg_test_acc: {'uniform': 0.7853000164031982, 'validclass': 0.7912572383880615, 'labeldist': 0.8444916486740113}
Round:197 - Active clients:[ 0 44 16 27 33]:
 Training time:19.749 seconds
 server global model correct 8346
 Testing time:25.275 seconds
 avg_test_acc: {'uniform': 0.8345999717712402, 'validclass': 0.8345999717712402, 'labeldist': 0.834600031375885}
 pfl_avg_test_acc: {'uniform': 0.7862599968910218, 'validclass': 0.7885488867759705, 'labeldist': 0.8433041453361512}
Round:198 - Active clients:[ 1 38 40 46 35]:
 Training time:24.022 seconds
 server global model correct 8339
 Testing time:25.215 seconds
 avg_test_acc: {'uniform': 0.833899974822998, 'validclass': 0.833899974822998, 'labeldist': 0.8339000344276428}
 pfl_avg_test_acc: {'uniform': 0.7550000071525573, 'validclass': 0.7988466739654541, 'labeldist': 0.863158357143402}
Round:199 - Active clients:[29 33  1 37 31]:
 Training time:22.434 seconds
 server global model correct 8220
 Testing time:25.140 seconds
 avg_test_acc: {'uniform': 0.8220000267028809, 'validclass': 0.8220000267028809, 'labeldist': 0.8220000863075256}
 pfl_avg_test_acc: {'uniform': 0.7826200127601624, 'validclass': 0.7891777873039245, 'labeldist': 0.8809277415275574}
Round:200 - Active clients:[33  8 31 28 20]:
 Training time:21.150 seconds
 server global model correct 8274
 Testing time:25.236 seconds
 avg_test_acc: {'uniform': 0.8274000287055969, 'validclass': 0.8274000287055969, 'labeldist': 0.8273999691009521}
 pfl_avg_test_acc: {'uniform': 0.7811599850654602, 'validclass': 0.7897110939025879, 'labeldist': 0.8621832251548767}
[1;34mwandb[0m: 
[1;34mwandb[0m: üöÄ View run [33mcomfy-glade-38[0m at: [34mhttps://wandb.ai/sigm/FedNH/runs/iexwcors[0m
[1;34mwandb[0m: Find logs at: [1;35mwandb/run-20250315_204442-iexwcors/logs[0m
